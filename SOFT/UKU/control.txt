; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\EXE\control.o --asm_dir=.\ --list_dir=.\ --depend=.\EXE\control.d --feedback=.\EXE\UKU2071x_GALV_IBv2.fed --cpu=Cortex-M3 --apcs=interwork -O3 -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -D__MICROLIB -DUKU2071x -DEXT_BOARD_V_2 --omf_browse=.\EXE\control.crf control.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                  kb_init PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  4805              LDR      r0,|L1.24|
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  f06f013b          MVN      r1,#0x3b
000006  8800              LDRH     r0,[r0,#0]  ; TBAT
000008  ebc01000          RSB      r0,r0,r0,LSL #4
00000c  eb010080          ADD      r0,r1,r0,LSL #2
000010  4902              LDR      r1,|L1.28|
000012  8448              STRH     r0,[r1,#0x22]
;;;222    }
000014  4770              BX       lr
;;;223    
                          ENDP

000016  0000              DCW      0x0000
                  |L1.24|
                          DCD      TBAT
                  |L1.28|
                          DCD      ||area_number.25||

                          AREA ||area_number.2||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.2||, ||.text||
                  samokalibr_init PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  4902              LDR      r1,|L2.12|
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  f24060f9          MOV      r0,#0x6f9
000006  8408              STRH     r0,[r1,#0x20]
000008  4770              BX       lr
;;;222    }
;;;223    
                          ENDP

00000a  0000              DCW      0x0000
                  |L2.12|
                          DCD      ||area_number.25||

                          AREA ||area_number.3||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.3||, ||.text||
                  samokalibr_hndl PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  b510              PUSH     {r4,lr}
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  4c1a              LDR      r4,|L3.108|
000004  8c20              LDRH     r0,[r4,#0x20]  ; samokalibr_cnt
000006  1c40              ADDS     r0,r0,#1
000008  b200              SXTH     r0,r0
00000a  8420              STRH     r0,[r4,#0x20]
00000c  f5b06fe1          CMP      r0,#0x708
000010  db02              BLT      |L3.24|
000012  2000              MOVS     r0,#0
;;;222    }
000014  8420              STRH     r0,[r4,#0x20]
                  |L3.22|
000016  bd10              POP      {r4,pc}
                  |L3.24|
000018  f5b06fdf          CMP      r0,#0x6f8
00001c  d911              BLS      |L3.66|
00001e  230f              MOVS     r3,#0xf
000020  2201              MOVS     r2,#1
000022  2164              MOVS     r1,#0x64
000024  20d2              MOVS     r0,#0xd2
000026  f7fffffe          BL       mess_send
00002a  230f              MOVS     r3,#0xf
00002c  2200              MOVS     r2,#0
00002e  21d8              MOVS     r1,#0xd8
000030  20d7              MOVS     r0,#0xd7
000032  f7fffffe          BL       mess_send
000036  230f              MOVS     r3,#0xf
000038  2200              MOVS     r2,#0
00003a  21d8              MOVS     r1,#0xd8
00003c  20dc              MOVS     r0,#0xdc
00003e  f7fffffe          BL       mess_send
                  |L3.66|
000042  f9b40020          LDRSH    r0,[r4,#0x20]  ; samokalibr_cnt
000046  f5a061e0          SUB      r1,r0,#0x700
00004a  3907              SUBS     r1,#7
00004c  d1e3              BNE      |L3.22|
00004e  4808              LDR      r0,|L3.112|
000050  4a08              LDR      r2,|L3.116|
000052  8801              LDRH     r1,[r0,#0]  ; ad7705_buff_
000054  f9b22000          LDRSH    r2,[r2,#0]  ; Kiload0
000058  4291              CMP      r1,r2
00005a  d0dc              BEQ      |L3.22|
00005c  f9b01000          LDRSH    r1,[r0,#0]  ; ad7705_buff_
000060  e8bd4010          POP      {r4,lr}
000064  2014              MOVS     r0,#0x14
000066  f7ffbffe          B.W      lc640_write_int
;;;223    
                          ENDP

00006a  0000              DCW      0x0000
                  |L3.108|
                          DCD      ||area_number.25||
                  |L3.112|
                          DCD      ad7705_buff_
                  |L3.116|
                          DCD      Kiload0

                          AREA ||area_number.4||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.text||
                  unet_drv PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  4a0d              LDR      r2,|L4.56|
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  b430              PUSH     {r4,r5}
000004  490d              LDR      r1,|L4.60|
000006  f9b2400a          LDRSH    r4,[r2,#0xa]  ; adc_buff_
00000a  f64053ac          MOV      r3,#0xdac
00000e  f9b10000          LDRSH    r0,[r1,#0]
000012  429c              CMP      r4,r3
;;;222    }
000014  dc03              BGT      |L4.30|
000016  f9b22014          LDRSH    r2,[r2,#0x14]  ; adc_buff_
00001a  429a              CMP      r2,r3
00001c  dd03              BLE      |L4.38|
                  |L4.30|
00001e  2814              CMP      r0,#0x14
000020  da04              BGE      |L4.44|
000022  1c40              ADDS     r0,r0,#1
000024  e001              B        |L4.42|
                  |L4.38|
000026  b108              CBZ      r0,|L4.44|
000028  1e40              SUBS     r0,r0,#1
                  |L4.42|
00002a  8008              STRH     r0,[r1,#0]
                  |L4.44|
00002c  2214              MOVS     r2,#0x14
00002e  bc30              POP      {r4,r5}
000030  2100              MOVS     r1,#0
000032  4802              LDR      r0,|L4.60|
000034  f7ffbffe          B.W      gran
;;;223    
                          ENDP

                  |L4.56|
                          DCD      ||.bss||+0x800
                  |L4.60|
                          DCD      unet_drv_cnt

                          AREA ||area_number.5||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.text||
                  matemat PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  b5f0              PUSH     {r4-r7,lr}
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  48ff              LDR      r0,|L5.1024|
000004  49ff              LDR      r1,|L5.1028|
000006  f44f72fa          MOV      r2,#0x1f4
00000a  f9b00000          LDRSH    r0,[r0,#0]  ; adc_buff_
00000e  f9b11000          LDRSH    r1,[r1,#0]  ; Kuload
000012  4bfd              LDR      r3,|L5.1032|
;;;222    }
000014  4348              MULS     r0,r1,r0
000016  fb90f0f2          SDIV     r0,r0,r2
00001a  8018              STRH     r0,[r3,#0]
00001c  48f8              LDR      r0,|L5.1024|
00001e  f2413388          MOV      r3,#0x1388
000022  3020              ADDS     r0,r0,#0x20
000024  f9b00000          LDRSH    r0,[r0,#0]  ; adc_buff__
000028  4348              MULS     r0,r1,r0
00002a  fb90f0f2          SDIV     r0,r0,r2
00002e  49f7              LDR      r1,|L5.1036|
000030  4afa              LDR      r2,|L5.1052|
000032  8008              STRH     r0,[r1,#0]
000034  49f7              LDR      r1,|L5.1044|
000036  48f6              LDR      r0,|L5.1040|
000038  f9b14000          LDRSH    r4,[r1,#0]  ; Kiload0
00003c  49f6              LDR      r1,|L5.1048|
00003e  8800              LDRH     r0,[r0,#0]  ; ad7705_buff_
000040  f9b11000          LDRSH    r1,[r1,#0]  ; Kiload1
000044  1b00              SUBS     r0,r0,r4
000046  4348              MULS     r0,r1,r0
000048  fb90f0f3          SDIV     r0,r0,r3
00004c  8010              STRH     r0,[r2,#0]
00004e  1b00              SUBS     r0,r0,r4
000050  4348              MULS     r0,r1,r0
000052  fb90f0f3          SDIV     r0,r0,r3
000056  49f2              LDR      r1,|L5.1056|
000058  4bf4              LDR      r3,|L5.1068|
00005a  8008              STRH     r0,[r1,#0]
00005c  48f1              LDR      r0,|L5.1060|
00005e  8801              LDRH     r1,[r0,#0]  ; I_LOAD_MODE
000060  48f1              LDR      r0,|L5.1064|
000062  f9b04000          LDRSH    r4,[r0,#0]
000066  b981              CBNZ     r1,|L5.138|
000068  2100              MOVS     r1,#0
00006a  4608              MOV      r0,r1
00006c  e00a              B        |L5.132|
00006e  bf00              NOP      
                  |L5.112|
000070  ebc005c0          RSB      r5,r0,r0,LSL #3
000074  eb050545          ADD      r5,r5,r5,LSL #1
000078  eb030585          ADD      r5,r3,r5,LSL #2
00007c  1c40              ADDS     r0,r0,#1
00007e  6a2d              LDR      r5,[r5,#0x20]
000080  b2c0              UXTB     r0,r0
000082  4429              ADD      r1,r1,r5
                  |L5.132|
000084  42a0              CMP      r0,r4
000086  dbf3              BLT      |L5.112|
000088  8011              STRH     r1,[r2,#0]
                  |L5.138|
00008a  f9b20000          LDRSH    r0,[r2,#0]  ; load_I
00008e  2100              MOVS     r1,#0
000090  2800              CMP      r0,#0
000092  da00              BGE      |L5.150|
000094  8011              STRH     r1,[r2,#0]
                  |L5.150|
000096  2200              MOVS     r2,#0
                  |L5.152|
000098  ebc200c2          RSB      r0,r2,r2,LSL #3
00009c  eb000040          ADD      r0,r0,r0,LSL #1
0000a0  eb030080          ADD      r0,r3,r0,LSL #2
0000a4  78c5              LDRB     r5,[r0,#3]
0000a6  2d19              CMP      r5,#0x19
0000a8  d21b              BCS      |L5.226|
0000aa  7985              LDRB     r5,[r0,#6]
0000ac  79c6              LDRB     r6,[r0,#7]
0000ae  eb052606          ADD      r6,r5,r6,LSL #8
0000b2  6206              STR      r6,[r0,#0x20]
0000b4  7a06              LDRB     r6,[r0,#8]
0000b6  7a47              LDRB     r7,[r0,#9]
0000b8  eb062607          ADD      r6,r6,r7,LSL #8
0000bc  61c6              STR      r6,[r0,#0x1c]
0000be  7a86              LDRB     r6,[r0,#0xa]
0000c0  7ac7              LDRB     r7,[r0,#0xb]
0000c2  eb062607          ADD      r6,r6,r7,LSL #8
0000c6  6186              STR      r6,[r0,#0x18]
0000c8  7b06              LDRB     r6,[r0,#0xc]
0000ca  6246              STR      r6,[r0,#0x24]
0000cc  f880504e          STRB     r5,[r0,#0x4e]
0000d0  7b85              LDRB     r5,[r0,#0xe]
0000d2  f880503e          STRB     r5,[r0,#0x3e]
0000d6  7c05              LDRB     r5,[r0,#0x10]
0000d8  7c46              LDRB     r6,[r0,#0x11]
0000da  eb052506          ADD      r5,r5,r6,LSL #8
0000de  6485              STR      r5,[r0,#0x48]
0000e0  e006              B        |L5.240|
                  |L5.226|
0000e2  6181              STR      r1,[r0,#0x18]
0000e4  6201              STR      r1,[r0,#0x20]
0000e6  61c1              STR      r1,[r0,#0x1c]
0000e8  6241              STR      r1,[r0,#0x24]
0000ea  f880103e          STRB     r1,[r0,#0x3e]
0000ee  6481              STR      r1,[r0,#0x48]
                  |L5.240|
0000f0  1c52              ADDS     r2,r2,#1
0000f2  b2d2              UXTB     r2,r2
0000f4  2a20              CMP      r2,#0x20
0000f6  d3cf              BCC      |L5.152|
0000f8  48cd              LDR      r0,|L5.1072|
0000fa  49ce              LDR      r1,|L5.1076|
0000fc  8800              LDRH     r0,[r0,#0]  ; I_MAX
0000fe  4360              MULS     r0,r4,r0
000100  8008              STRH     r0,[r1,#0]
000102  48cd              LDR      r0,|L5.1080|
000104  49cd              LDR      r1,|L5.1084|
000106  8800              LDRH     r0,[r0,#0]  ; I_MIN
000108  4360              MULS     r0,r4,r0
00010a  8008              STRH     r0,[r1,#0]
00010c  bdf0              POP      {r4-r7,pc}
;;;223    
                          ENDP

                  adc_init PROC
;;;350    //-----------------------------------------------
;;;351    void adc_init(void)
00010e  48cc              LDR      r0,|L5.1088|
;;;352    {
;;;353    
;;;354    SET_REG(LPC_PINCON->PINSEL1,1,(25-16)*2,2);
000110  6841              LDR      r1,[r0,#4]
000112  f4212140          BIC      r1,r1,#0xc0000
000116  f4412180          ORR      r1,r1,#0x40000
00011a  6041              STR      r1,[r0,#4]
;;;355    SET_REG(LPC_PINCON->PINSEL1,1,(24-16)*2,2);
00011c  6841              LDR      r1,[r0,#4]
00011e  f4213140          BIC      r1,r1,#0x30000
000122  f4413180          ORR      r1,r1,#0x10000
000126  6041              STR      r1,[r0,#4]
;;;356    SET_REG(LPC_PINCON->PINSEL1,1,(23-16)*2,2);
000128  6841              LDR      r1,[r0,#4]
00012a  f4214140          BIC      r1,r1,#0xc000
00012e  f4414180          ORR      r1,r1,#0x4000
000132  6041              STR      r1,[r0,#4]
;;;357    
;;;358    
;;;359    SET_REG(LPC_PINCON->PINMODE1,2,(25-16)*2,2);
000134  6c41              LDR      r1,[r0,#0x44]
000136  f4212140          BIC      r1,r1,#0xc0000
00013a  f4412100          ORR      r1,r1,#0x80000
00013e  6441              STR      r1,[r0,#0x44]
;;;360    SET_REG(LPC_PINCON->PINMODE1,2,(24-16)*2,2);
000140  6c41              LDR      r1,[r0,#0x44]
000142  f4213140          BIC      r1,r1,#0x30000
000146  f4413100          ORR      r1,r1,#0x20000
00014a  6441              STR      r1,[r0,#0x44]
;;;361    SET_REG(LPC_PINCON->PINMODE1,2,(23-16)*2,2);
00014c  6c41              LDR      r1,[r0,#0x44]
00014e  f4214140          BIC      r1,r1,#0xc000
000152  f4414100          ORR      r1,r1,#0x8000
000156  6441              STR      r1,[r0,#0x44]
;;;362    
;;;363    SET_REG(LPC_ADC->ADCR,0,24,3);
000158  48ba              LDR      r0,|L5.1092|
00015a  6801              LDR      r1,[r0,#0]
00015c  f02161e0          BIC      r1,r1,#0x7000000
000160  6001              STR      r1,[r0,#0]
;;;364    
;;;365    SET_REG(LPC_ADC->ADCR,1,21,1);
000162  6801              LDR      r1,[r0,#0]
000164  f4411100          ORR      r1,r1,#0x200000
000168  6001              STR      r1,[r0,#0]
;;;366    SET_REG(LPC_ADC->ADCR,0,16,1);
00016a  6801              LDR      r1,[r0,#0]
00016c  f4213180          BIC      r1,r1,#0x10000
000170  6001              STR      r1,[r0,#0]
;;;367    SET_REG(LPC_ADC->ADCR,1,8,8);
000172  6801              LDR      r1,[r0,#0]
000174  f421417f          BIC      r1,r1,#0xff00
000178  f4417180          ORR      r1,r1,#0x100
00017c  6001              STR      r1,[r0,#0]
;;;368    
;;;369    //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;370    //SET_REG(LPC_GPIO0->FIOPIN,4,5,3);
;;;371    	
;;;372    	/*if(adc_ch<=7)*///SET_REG(LPC_ADC->ADCR,1<<5,0,8);
;;;373         /*else if(adc_ch==8) SET_REG(LPC_ADC->ADCR,1<<2,0,8);
;;;374         else SET_REG(LPC_ADC->ADCR,1<<4,0,8);*/
;;;375    
;;;376    LPC_ADC->ADINTEN     =  (1<< 8);      /* global enable interrupt            */
00017e  1581              ASRS     r1,r0,#22
000180  60c1              STR      r1,[r0,#0xc]
000182  48b1              LDR      r0,|L5.1096|
000184  0389              LSLS     r1,r1,#14
000186  6001              STR      r1,[r0,#0]
;;;377    
;;;378    NVIC_EnableIRQ(ADC_IRQn);             /* enable ADC Interrupt               */
;;;379    
;;;380    
;;;381    }
000188  4770              BX       lr
;;;382    
                          ENDP

                  adc_drv7 PROC
;;;383    //-----------------------------------------------
;;;384    void adc_drv7(void) //(Uсети - постоянка)
00018a  e92d41f0          PUSH     {r4-r8,lr}
;;;385    {
;;;386    //int temp_S;
;;;387    //char i;
;;;388    //signed short temp_SS;
;;;389    
;;;390    adc_self_ch_disp[0]=abs_pal(adc_self_ch_buff[1]-adc_self_ch_buff[0]);//adc_self_ch_buff[0]&0x0f80;
00018e  4caf              LDR      r4,|L5.1100|
000190  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000192  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000194  1a40              SUBS     r0,r0,r1
000196  b200              SXTH     r0,r0
000198  f7fffffe          BL       abs_pal
00019c  1da5              ADDS     r5,r4,#6
00019e  8028              STRH     r0,[r5,#0]
;;;391    adc_self_ch_disp[1]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[1]);//adc_self_ch_buff[1]&0x0f80;
0001a0  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0001a2  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
0001a4  1a40              SUBS     r0,r0,r1
0001a6  b200              SXTH     r0,r0
0001a8  f7fffffe          BL       abs_pal
0001ac  8068              STRH     r0,[r5,#2]
;;;392    adc_self_ch_disp[2]=abs_pal(adc_self_ch_buff[2]-adc_self_ch_buff[0]);//adc_self_ch_buff[2]&0x0f80;
0001ae  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0001b0  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
0001b2  1a40              SUBS     r0,r0,r1
0001b4  b200              SXTH     r0,r0
0001b6  f7fffffe          BL       abs_pal
;;;393    
;;;394    //adc_self_ch_disp[0]=adc_self_ch_buff[0]&0x0ff0;
;;;395    //adc_self_ch_disp[1]=adc_self_ch_buff[1]&0x0ff0;
;;;396    //adc_self_ch_disp[2]=adc_self_ch_buff[2]&0x0ff0;
;;;397    
;;;398    
;;;399    if(adc_self_ch_disp[2]<300)//==adc_self_ch_disp[2])
0001ba  f44f7296          MOV      r2,#0x12c
0001be  80a8              STRH     r0,[r5,#4]            ;392
;;;400    	{
;;;401    	adc_result=adc_self_ch_buff[2];
0001c0  f1a4012c          SUB      r1,r4,#0x2c
0001c4  4290              CMP      r0,r2                 ;399
0001c6  da01              BGE      |L5.460|
0001c8  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
0001ca  e00a              B        |L5.482|
                  |L5.460|
;;;402    	} 
;;;403    else if(adc_self_ch_disp[1]<300)//==adc_self_ch_disp[2])
0001cc  f9b50002          LDRSH    r0,[r5,#2]  ; adc_self_ch_disp
0001d0  4290              CMP      r0,r2
0001d2  da01              BGE      |L5.472|
;;;404    	{
;;;405    	adc_result=adc_self_ch_buff[1];
0001d4  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
0001d6  e004              B        |L5.482|
                  |L5.472|
;;;406    	}
;;;407    else if(adc_self_ch_disp[0]<300)//==adc_self_ch_disp[1])
0001d8  f9b50000          LDRSH    r0,[r5,#0]  ; adc_self_ch_disp
0001dc  4290              CMP      r0,r2
0001de  da01              BGE      |L5.484|
;;;408    	{
;;;409    	adc_result=adc_self_ch_buff[0];
0001e0  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
                  |L5.482|
0001e2  82c8              STRH     r0,[r1,#0x16]
                  |L5.484|
;;;410    	}
;;;411        //adc_result=92;
;;;412    
;;;413    if(adc_ch_net)
0001e4  784c              LDRB     r4,[r1,#1]  ; adc_ch_net
0001e6  2300              MOVS     r3,#0
0001e8  b31c              CBZ      r4,|L5.562|
;;;414    	{
;;;415    
;;;416    	main_power_buffer[0]+=(long)(adc_result);
0001ea  4885              LDR      r0,|L5.1024|
0001ec  f9b12016          LDRSH    r2,[r1,#0x16]  ; adc_result
0001f0  3040              ADDS     r0,r0,#0x40
0001f2  6805              LDR      r5,[r0,#0]  ; main_power_buffer
0001f4  4415              ADD      r5,r5,r2
;;;417    	main_power_buffer[1]+=(long)(adc_result);
0001f6  6005              STR      r5,[r0,#0]  ; main_power_buffer
0001f8  6845              LDR      r5,[r0,#4]  ; main_power_buffer
0001fa  4415              ADD      r5,r5,r2
;;;418    	main_power_buffer[2]+=(long)(adc_result);
0001fc  6045              STR      r5,[r0,#4]  ; main_power_buffer
0001fe  6885              LDR      r5,[r0,#8]  ; main_power_buffer
000200  4415              ADD      r5,r5,r2
;;;419    	main_power_buffer[3]+=(long)(adc_result);
000202  6085              STR      r5,[r0,#8]  ; main_power_buffer
000204  68c5              LDR      r5,[r0,#0xc]  ; main_power_buffer
000206  442a              ADD      r2,r2,r5
;;;420    
;;;421    	adc_net_buff_cnt++;
000208  60c2              STR      r2,[r0,#0xc]  ; main_power_buffer
00020a  8bca              LDRH     r2,[r1,#0x1e]  ; adc_net_buff_cnt
00020c  1c52              ADDS     r2,r2,#1
00020e  b212              SXTH     r2,r2
000210  83ca              STRH     r2,[r1,#0x1e]
;;;422    	if(adc_net_buff_cnt>=0x1000)
000212  f5b25f80          CMP      r2,#0x1000
000216  db00              BLT      |L5.538|
;;;423    		{
;;;424    		adc_net_buff_cnt=0;
000218  83cb              STRH     r3,[r1,#0x1e]
                  |L5.538|
;;;425    		}
;;;426    	if((adc_net_buff_cnt&0x03ff)==0)
00021a  f9b1201e          LDRSH    r2,[r1,#0x1e]  ; adc_net_buff_cnt
00021e  0595              LSLS     r5,r2,#22
000220  d135              BNE      |L5.654|
;;;427    		{
;;;428    		#ifdef UKU_220
;;;429    		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>11);
;;;430    		#else
;;;431    		net_buff_=(short)((main_power_buffer[adc_net_buff_cnt>>10])>>8);
000222  1292              ASRS     r2,r2,#10
000224  f8505022          LDR      r5,[r0,r2,LSL #2]
000228  122d              ASRS     r5,r5,#8
00022a  828d              STRH     r5,[r1,#0x14]
;;;432    		#endif
;;;433    		main_power_buffer[adc_net_buff_cnt>>10]=0;
00022c  f8403022          STR      r3,[r0,r2,LSL #2]
000230  e02d              B        |L5.654|
                  |L5.562|
;;;434    		}
;;;435    
;;;436    
;;;437    	} 
;;;438    else if(!adc_ch_net)
;;;439    	{
;;;440    	adc_buff[adc_ch][adc_ch_cnt]=(long)adc_result;
000232  4f87              LDR      r7,|L5.1104|
000234  7888              LDRB     r0,[r1,#2]  ; adc_ch
000236  f891c003          LDRB     r12,[r1,#3]  ; adc_ch_cnt
00023a  eb0712c0          ADD      r2,r7,r0,LSL #7
00023e  f9b1e016          LDRSH    lr,[r1,#0x16]  ; adc_result
000242  f842e02c          STR      lr,[r2,r12,LSL #2]
;;;441    	
;;;442    	if((adc_ch_cnt&0x03)==0)
000246  ea5f728c          LSLS     r2,r12,#30
00024a  d112              BNE      |L5.626|
;;;443    		{
;;;444    		long temp_L;
;;;445    		char i;
;;;446    		temp_L=0;
00024c  2500              MOVS     r5,#0
;;;447    		for(i=0;i<32;i++)
00024e  462a              MOV      r2,r5
;;;448    			{
;;;449    			temp_L+=adc_buff[adc_ch][i];
000250  eb0716c0          ADD      r6,r7,r0,LSL #7
                  |L5.596|
000254  f8567022          LDR      r7,[r6,r2,LSL #2]
000258  1c52              ADDS     r2,r2,#1              ;447
00025a  b2d2              UXTB     r2,r2                 ;447
00025c  443d              ADD      r5,r5,r7
00025e  2a20              CMP      r2,#0x20              ;447
000260  d3f8              BCC      |L5.596|
;;;450    			}
;;;451    		adc_buff_[adc_ch]= (short)(temp_L>>5);
000262  116a              ASRS     r2,r5,#5
000264  4d66              LDR      r5,|L5.1024|
000266  f8252010          STRH     r2,[r5,r0,LSL #1]
;;;452    		adc_buff__[adc_ch]= adc_buff[adc_ch][adc_ch_cnt];
00026a  f1050220          ADD      r2,r5,#0x20
00026e  f822e010          STRH     lr,[r2,r0,LSL #1]
                  |L5.626|
;;;453    		//adc_buff_[3]=346;
;;;454    		}
;;;455    	if(++adc_ch>=16) 
000272  1c40              ADDS     r0,r0,#1
000274  b2c0              UXTB     r0,r0
000276  7088              STRB     r0,[r1,#2]
000278  2810              CMP      r0,#0x10
00027a  d308              BCC      |L5.654|
;;;456    		{
;;;457    		adc_ch=0;
;;;458    		adc_ch_cnt++;
00027c  f10c0c01          ADD      r12,r12,#1
000280  f00c00ff          AND      r0,r12,#0xff
000284  708b              STRB     r3,[r1,#2]            ;457
000286  70c8              STRB     r0,[r1,#3]
;;;459    		if(adc_ch_cnt>=32)adc_ch_cnt=0;
000288  2820              CMP      r0,#0x20
00028a  d300              BCC      |L5.654|
00028c  70cb              STRB     r3,[r1,#3]
                  |L5.654|
;;;460    		}
;;;461    	}
;;;462    
;;;463      
;;;464    
;;;465    adc_self_ch_cnt=0;
;;;466    
;;;467    adc_ch_net++;
00028e  1c64              ADDS     r4,r4,#1
000290  700b              STRB     r3,[r1,#0]            ;465
;;;468    adc_ch_net&=1;
000292  f0140001          ANDS     r0,r4,#1
;;;469    
;;;470    //SET_REG(LPC_GPIO0->FIODIR,7,5,3);
;;;471    //SET_REG(LPC_GPIO0->FIOPIN,adc_ch,5,3);
;;;472    
;;;473    if(adc_ch_net)
;;;474    	{
;;;475    	//LPC_GPIO2->FIODIR|=(1<<7);
;;;476    	//LPC_GPIO2->FIOPIN|=(1<<7);
;;;477    	SET_REG(LPC_ADC->ADCR,1<<2,0,8);
000296  4a6b              LDR      r2,|L5.1092|
000298  7048              STRB     r0,[r1,#1]            ;468
00029a  d005              BEQ      |L5.680|
00029c  6810              LDR      r0,[r2,#0]
00029e  f02000ff          BIC      r0,r0,#0xff
0002a2  1d00              ADDS     r0,r0,#4
0002a4  6010              STR      r0,[r2,#0]
0002a6  e034              B        |L5.786|
                  |L5.680|
;;;478    	}
;;;479    else
;;;480    	{
;;;481    	//LPC_GPIO2->FIODIR|=(1<<7);
;;;482    	//LPC_GPIO2->FIOPIN&=~(1<<7);
;;;483    	if(!(adc_ch&(1<<3)))SET_REG(LPC_ADC->ADCR,1<<0,0,8);
0002a8  7889              LDRB     r1,[r1,#2]  ; adc_ch
0002aa  0708              LSLS     r0,r1,#28
0002ac  2800              CMP      r0,#0
;;;484    	else 			SET_REG(LPC_ADC->ADCR,1<<1,0,8);
0002ae  6810              LDR      r0,[r2,#0]
0002b0  f02000ff          BIC      r0,r0,#0xff
0002b4  db02              BLT      |L5.700|
0002b6  f1000001          ADD      r0,r0,#1              ;483
0002ba  e001              B        |L5.704|
                  |L5.700|
0002bc  f1000002          ADD      r0,r0,#2
                  |L5.704|
0002c0  6010              STR      r0,[r2,#0]
;;;485    
;;;486    
;;;487    	SET_REG(LPC_GPIO0->FIODIR,1,28,1);
0002c2  4864              LDR      r0,|L5.1108|
0002c4  6803              LDR      r3,[r0,#0]
0002c6  f0435380          ORR      r3,r3,#0x10000000
0002ca  6003              STR      r3,[r0,#0]
;;;488    	SET_REG(LPC_GPIO1->FIODIR,1,30,1);
0002cc  6a03              LDR      r3,[r0,#0x20]
0002ce  f0434380          ORR      r3,r3,#0x40000000
0002d2  6203              STR      r3,[r0,#0x20]
;;;489    	SET_REG(LPC_GPIO3->FIODIR,1,26,1);
0002d4  6e03              LDR      r3,[r0,#0x60]
0002d6  f0436380          ORR      r3,r3,#0x4000000
0002da  6603              STR      r3,[r0,#0x60]
;;;490    
;;;491    	if(!(adc_ch&(1<<0)))SET_REG(LPC_GPIO0->FIOPIN,0,28,1);
0002dc  07cb              LSLS     r3,r1,#31
;;;492    	else 			SET_REG(LPC_GPIO0->FIOPIN,1,28,1);
0002de  6943              LDR      r3,[r0,#0x14]
0002e0  d008              BEQ      |L5.756|
0002e2  f0435380          ORR      r3,r3,#0x10000000
                  |L5.742|
0002e6  6143              STR      r3,[r0,#0x14]
;;;493    
;;;494    	if(!(adc_ch&(1<<1)))SET_REG(LPC_GPIO1->FIOPIN,0,30,1);
0002e8  078b              LSLS     r3,r1,#30
;;;495    	else 			SET_REG(LPC_GPIO1->FIOPIN,1,30,1);
0002ea  6b43              LDR      r3,[r0,#0x34]
0002ec  d405              BMI      |L5.762|
0002ee  f0234380          BIC      r3,r3,#0x40000000     ;494
0002f2  e004              B        |L5.766|
                  |L5.756|
0002f4  f0235380          BIC      r3,r3,#0x10000000     ;491
0002f8  e7f5              B        |L5.742|
                  |L5.762|
0002fa  f0434380          ORR      r3,r3,#0x40000000
                  |L5.766|
0002fe  6343              STR      r3,[r0,#0x34]
;;;496    
;;;497    	if(!(adc_ch&(1<<2)))SET_REG(LPC_GPIO3->FIOPIN,0,26,1);
000300  0749              LSLS     r1,r1,#29
;;;498    	else 			SET_REG(LPC_GPIO3->FIOPIN,1,26,1);
000302  6f41              LDR      r1,[r0,#0x74]
000304  d402              BMI      |L5.780|
000306  f0216180          BIC      r1,r1,#0x4000000      ;497
00030a  e001              B        |L5.784|
                  |L5.780|
00030c  f0416180          ORR      r1,r1,#0x4000000
                  |L5.784|
000310  6741              STR      r1,[r0,#0x74]         ;497
                  |L5.786|
;;;499    	}
;;;500    	
;;;501    
;;;502    
;;;503    
;;;504    LPC_ADC->ADCR |=  (1<<24);
000312  6810              LDR      r0,[r2,#0]
000314  f0407080          ORR      r0,r0,#0x1000000
000318  6010              STR      r0,[r2,#0]
                  |L5.794|
;;;505    
;;;506    }
00031a  e8bd81f0          POP      {r4-r8,pc}
;;;507    
                          ENDP

                  avg_hndl PROC
;;;508    //-----------------------------------------------
;;;509    void avg_hndl(void)
00031e  e92d4ff0          PUSH     {r4-r11,lr}
;;;510    { 
;;;511    char i;
;;;512    
;;;513    
;;;514    
;;;515    #define AVGCNTMAX	5
;;;516    if(avg_main_cnt)
000322  494d              LDR      r1,|L5.1112|
000324  f9b10000          LDRSH    r0,[r1,#0]  ; avg_main_cnt
000328  b118              CBZ      r0,|L5.818|
;;;517    	{
;;;518    	avg_main_cnt--;
00032a  f1a00001          SUB      r0,r0,#1
00032e  8008              STRH     r0,[r1,#0]
;;;519    	goto avg_hndl_end;
000330  e0ef              B        |L5.1298|
                  |L5.818|
;;;520    	}                 
;;;521    
;;;522    avg_main_cnt=10;
000332  200a              MOVS     r0,#0xa
000334  8008              STRH     r0,[r1,#0]
;;;523    
;;;524    avg_num=0;
000336  4949              LDR      r1,|L5.1116|
000338  2300              MOVS     r3,#0
;;;525    num_of_dumm_src=100;
00033a  f8dfb124          LDR      r11,|L5.1120|
;;;526    num_of_max_src=100;
00033e  f8df8124          LDR      r8,|L5.1124|
000342  700b              STRB     r3,[r1,#0]            ;524
000344  2064              MOVS     r0,#0x64              ;525
000346  f88b0000          STRB     r0,[r11,#0]           ;525
00034a  f8880000          STRB     r0,[r8,#0]
;;;527    
;;;528    for(i=0;i<NUMIST;i++)
00034e  4836              LDR      r0,|L5.1064|
000350  461a              MOV      r2,r3
000352  f9b04000          LDRSH    r4,[r0,#0]
;;;529    	{
;;;530    	if(/*(bps[i]._state==bsWRK)&&*/(bps[i]._cnt<20))avg_num++;
000356  4835              LDR      r0,|L5.1068|
000358  e00e              B        |L5.888|
00035a  bf00              NOP      
                  |L5.860|
00035c  ebc205c2          RSB      r5,r2,r2,LSL #3
000360  eb050545          ADD      r5,r5,r5,LSL #1
000364  eb000585          ADD      r5,r0,r5,LSL #2
000368  78ed              LDRB     r5,[r5,#3]
00036a  2d14              CMP      r5,#0x14
00036c  d202              BCS      |L5.884|
00036e  780d              LDRB     r5,[r1,#0]  ; avg_num
000370  1c6d              ADDS     r5,r5,#1
000372  700d              STRB     r5,[r1,#0]
                  |L5.884|
000374  1c52              ADDS     r2,r2,#1              ;528
000376  b2d2              UXTB     r2,r2                 ;528
                  |L5.888|
000378  42a2              CMP      r2,r4                 ;528
00037a  dbef              BLT      |L5.860|
;;;531    	}
;;;532    
;;;533    /*if((K[NUMI]>=1)&&(bps_state[0]==ssWRK))	avg_num++;
;;;534    if((K[NUMI]>=2)&&(bps_state[1]==ssWRK))	avg_num++;
;;;535    if((K[NUMI]>=3)&&(bps_state[2]==ssWRK))	avg_num++;*/
;;;536    
;;;537    	
;;;538    if(avg_num<2)
00037c  7809              LDRB     r1,[r1,#0]  ; avg_num
00037e  468a              MOV      r10,r1
000380  2902              CMP      r1,#2
000382  d379              BCC      |L5.1144|
;;;539    	{
;;;540    	goto avg_hndl_end;
;;;541    	
;;;542    	}
;;;543    	
;;;544    else if(bU_VALID_VALID)
000384  4931              LDR      r1,|L5.1100|
000386  392c              SUBS     r1,r1,#0x2c
000388  7a89              LDRB     r1,[r1,#0xa]  ; bU_VALID_VALID
00038a  2900              CMP      r1,#0
00038c  d074              BEQ      |L5.1144|
;;;545    	{
;;;546    	i_avg_min=5000;
00038e  4a36              LDR      r2,|L5.1128|
000390  f2413188          MOV      r1,#0x1388
;;;547    	i_avg_max=0;
000394  f8dfc0d4          LDR      r12,|L5.1132|
000398  6011              STR      r1,[r2,#0]  ; i_avg_min
;;;548    	i_avg_summ=0;
00039a  4d35              LDR      r5,|L5.1136|
00039c  f8cc3000          STR      r3,[r12,#0]  ; i_avg_max
;;;549    	for(i=0;i<NUMIST;i++)
0003a0  2100              MOVS     r1,#0
0003a2  602b              STR      r3,[r5,#0]  ; i_avg_summ
0003a4  e020              B        |L5.1000|
;;;550    		{
;;;551    		if(bps[i]._state==bsWRK)
0003a6  bf00              NOP      
                  |L5.936|
0003a8  ebc106c1          RSB      r6,r1,r1,LSL #3
0003ac  eb060646          ADD      r6,r6,r6,LSL #1
0003b0  eb000686          ADD      r6,r0,r6,LSL #2
0003b4  78b7              LDRB     r7,[r6,#2]
0003b6  2f01              CMP      r7,#1
0003b8  d114              BNE      |L5.996|
;;;552    			{
;;;553    			if(bps[i]._Ii>i_avg_max)
0003ba  6a36              LDR      r6,[r6,#0x20]
0003bc  f8dc7000          LDR      r7,[r12,#0]  ; i_avg_max
0003c0  46b1              MOV      r9,r6
0003c2  42be              CMP      r6,r7
0003c4  dd03              BLE      |L5.974|
;;;554    				{
;;;555    				i_avg_max=bps[i]._Ii;
;;;556    				num_of_max_src=i;
0003c6  f8cc9000          STR      r9,[r12,#0]  ; i_avg_max
0003ca  f8881000          STRB     r1,[r8,#0]
                  |L5.974|
;;;557    				}
;;;558    			if(bps[i]._Ii<i_avg_min)
0003ce  6817              LDR      r7,[r2,#0]  ; i_avg_min
0003d0  45b9              CMP      r9,r7
0003d2  da03              BGE      |L5.988|
;;;559    				{
;;;560    				i_avg_min=bps[i]._Ii;
;;;561    				num_of_dumm_src=i;
0003d4  f8c29000          STR      r9,[r2,#0]  ; i_avg_min
0003d8  f88b1000          STRB     r1,[r11,#0]
                  |L5.988|
;;;562    				}
;;;563    			
;;;564    			i_avg_summ+=bps[i]._Ii;
0003dc  682f              LDR      r7,[r5,#0]  ; i_avg_summ
0003de  eb090607          ADD      r6,r9,r7
0003e2  602e              STR      r6,[r5,#0]  ; i_avg_summ
                  |L5.996|
0003e4  1c49              ADDS     r1,r1,#1              ;549
0003e6  b2c9              UXTB     r1,r1                 ;549
                  |L5.1000|
0003e8  42a1              CMP      r1,r4                 ;549
0003ea  dbdd              BLT      |L5.936|
;;;565    			}
;;;566    		}
;;;567    	i_avg=i_avg_summ/avg_num;	
0003ec  682e              LDR      r6,[r5,#0]  ; i_avg_summ
0003ee  fb96f5fa          SDIV     r5,r6,r10
0003f2  4e20              LDR      r6,|L5.1140|
;;;568    	
;;;569    	if(i_avg_min==0)i_avg_min=1;
0003f4  6035              STR      r5,[r6,#0]  ; i_avg
0003f6  6816              LDR      r6,[r2,#0]  ; i_avg_min
0003f8  2501              MOVS     r5,#1                 ;551
0003fa  b906              CBNZ     r6,|L5.1022|
0003fc  6015              STR      r5,[r2,#0]  ; i_avg_min
                  |L5.1022|
;;;570    
;;;571    	
;;;572    
;;;573    	avg=i_avg_max;
0003fe  e03c              B        |L5.1146|
                  |L5.1024|
                          DCD      ||.bss||+0x800
                  |L5.1028|
                          DCD      Kuload
                  |L5.1032|
                          DCD      load_U
                  |L5.1036|
                          DCD      load_U_
                  |L5.1040|
                          DCD      ad7705_buff_
                  |L5.1044|
                          DCD      Kiload0
                  |L5.1048|
                          DCD      Kiload1
                  |L5.1052|
                          DCD      load_I
                  |L5.1056|
                          DCD      load_I_
                  |L5.1060|
                          DCD      I_LOAD_MODE
                  |L5.1064|
                          DCD      NUMIST
                  |L5.1068|
                          DCD      bps
                  |L5.1072|
                          DCD      I_MAX
                  |L5.1076|
                          DCD      I_MAX_IPS
                  |L5.1080|
                          DCD      I_MIN
                  |L5.1084|
                          DCD      I_MIN_IPS
                  |L5.1088|
                          DCD      0x4002c000
                  |L5.1092|
                          DCD      0x40034000
                  |L5.1096|
                          DCD      0xe000e100
                  |L5.1100|
                          DCD      ||area_number.25||+0x2c
                  |L5.1104|
                          DCD      ||.bss||
                  |L5.1108|
                          DCD      0x2009c000
                  |L5.1112|
                          DCD      avg_main_cnt
                  |L5.1116|
                          DCD      avg_num
                  |L5.1120|
                          DCD      num_of_dumm_src
                  |L5.1124|
                          DCD      num_of_max_src
                  |L5.1128|
                          DCD      i_avg_min
                  |L5.1132|
                          DCD      i_avg_max
                  |L5.1136|
                          DCD      i_avg_summ
                  |L5.1140|
                          DCD      i_avg
                  |L5.1144|
000478  e035              B        |L5.1254|
                  |L5.1146|
00047a  f8dc6000          LDR      r6,[r12,#0]  ; i_avg_max
;;;574    	avg*=100;
00047e  2764              MOVS     r7,#0x64
;;;575    	avg/=i_avg_min;
000480  6812              LDR      r2,[r2,#0]  ; i_avg_min
000482  437e              MULS     r6,r7,r6              ;574
000484  fb96f2f2          SDIV     r2,r6,r2
000488  f8dfc3f8          LDR      r12,|L5.2180|
;;;576    	
;;;577    	if(avg>160) bAVG=1;
00048c  4efe              LDR      r6,|L5.2184|
00048e  2aa0              CMP      r2,#0xa0
000490  f8cc2000          STR      r2,[r12,#0]  ; avg
000494  dd00              BLE      |L5.1176|
000496  7035              STRB     r5,[r6,#0]
                  |L5.1176|
;;;578    	if(avg<120) bAVG=0;
000498  2a78              CMP      r2,#0x78
00049a  da01              BGE      |L5.1184|
00049c  7033              STRB     r3,[r6,#0]
00049e  e038              B        |L5.1298|
                  |L5.1184|
;;;579    
;;;580    	if(bAVG==1)
0004a0  7832              LDRB     r2,[r6,#0]  ; bAVG
0004a2  2a01              CMP      r2,#1
0004a4  d135              BNE      |L5.1298|
;;;581    		{
;;;582    		//for(i=0;i<NUMIST;i++)
;;;583    			//{
;;;584    		//	if(bps[i]._state==bsWRK)
;;;585    				//{
;;;586    				//if(bps[i]._Ii>i_avg)bps[i]._xu_--;
;;;587    				/*if(bps[i]._Ii<i_avg)*/
;;;588    				if(bAVG_CNT==0)
0004a6  4af9              LDR      r2,|L5.2188|
0004a8  7816              LDRB     r6,[r2,#0]  ; bAVG_CNT
0004aa  b1ee              CBZ      r6,|L5.1256|
;;;589    					{
;;;590    					bAVG_CNT=1;
;;;591    					if(num_of_dumm_src<NUMIST) bps[num_of_dumm_src]._xu_++;
;;;592    					}
;;;593    				else
;;;594    					{
;;;595    					bAVG_CNT=0;
0004ac  7013              STRB     r3,[r2,#0]
;;;596    					if(num_of_max_src<NUMIST) bps[num_of_max_src]._xu_--;
0004ae  f8982000          LDRB     r2,[r8,#0]  ; num_of_max_src
0004b2  42a2              CMP      r2,r4
0004b4  da09              BGE      |L5.1226|
0004b6  ebc202c2          RSB      r2,r2,r2,LSL #3
0004ba  eb020242          ADD      r2,r2,r2,LSL #1
0004be  eb000282          ADD      r2,r0,r2,LSL #2
0004c2  f8323f50          LDRH     r3,[r2,#0x50]!
0004c6  1e5b              SUBS     r3,r3,#1
                  |L5.1224|
0004c8  8013              STRH     r3,[r2,#0]
                  |L5.1226|
;;;597    					}
;;;598    			
;;;599    				if(bps[i]._xu_<-50)bps[i]._xu_=-50;
0004ca  ebc101c1          RSB      r1,r1,r1,LSL #3
0004ce  eb010141          ADD      r1,r1,r1,LSL #1
0004d2  eb000081          ADD      r0,r0,r1,LSL #2
0004d6  f06f0231          MVN      r2,#0x31
0004da  f9b01050          LDRSH    r1,[r0,#0x50]
0004de  4291              CMP      r1,r2
0004e0  da11              BGE      |L5.1286|
0004e2  f8a02050          STRH     r2,[r0,#0x50]
                  |L5.1254|
0004e6  e014              B        |L5.1298|
                  |L5.1256|
0004e8  7015              STRB     r5,[r2,#0]            ;590
0004ea  f89b2000          LDRB     r2,[r11,#0]           ;591  ; num_of_dumm_src
0004ee  42a2              CMP      r2,r4                 ;591
0004f0  daeb              BGE      |L5.1226|
0004f2  ebc202c2          RSB      r2,r2,r2,LSL #3       ;591
0004f6  eb020242          ADD      r2,r2,r2,LSL #1       ;591
0004fa  eb000282          ADD      r2,r0,r2,LSL #2       ;591
0004fe  f8323f50          LDRH     r3,[r2,#0x50]!        ;591
000502  1c5b              ADDS     r3,r3,#1              ;591
000504  e7e0              B        |L5.1224|
                  |L5.1286|
;;;600    				if(bps[i]._xu_>50)bps[i]._xu_=50;	
000506  2932              CMP      r1,#0x32
000508  dd03              BLE      |L5.1298|
00050a  f04f0132          MOV      r1,#0x32
00050e  f8a01050          STRH     r1,[r0,#0x50]
                  |L5.1298|
;;;601    			//	}
;;;602    			//}		
;;;603    		}			
;;;604    	}   	 
;;;605    
;;;606    
;;;607    avg_hndl_end:
;;;608    __nop();  
000512  bf00              NOP      
;;;609    }
000514  e8bd8ff0          POP      {r4-r11,pc}
;;;610    
                          ENDP

                  restart_off PROC
;;;1126   //-----------------------------------------------
;;;1127   void restart_off(void)
000518  b510              PUSH     {r4,lr}
;;;1128   {
;;;1129   lc640_write_long(EE_TIME_PROC_GS_RESTART,0);
00051a  2100              MOVS     r1,#0
00051c  20d0              MOVS     r0,#0xd0
00051e  f7fffffe          BL       lc640_write_long
;;;1130   lc640_write_long(EE_TIME_PROC_PS_RESTART,0);
000522  2100              MOVS     r1,#0
000524  e8bd4010          POP      {r4,lr}
000528  20d4              MOVS     r0,#0xd4
00052a  f7ffbffe          B.W      lc640_write_long
;;;1131   }
;;;1132   
                          ENDP

                  ach_off_hndl PROC
;;;882    //драйвер функции выключения по амперчасам
;;;883    void ach_off_hndl(void)
00052e  b570              PUSH     {r4-r6,lr}
;;;884    {
;;;885    
;;;886    if((work_stat!=wsOFF)&&(ACH_OFF_EN))
000530  4cd7              LDR      r4,|L5.2192|
;;;887    	{
;;;888    	milliAmperSecunda+=((long)load_I);
000532  48d8              LDR      r0,|L5.2196|
000534  2500              MOVS     r5,#0                 ;886
000536  7821              LDRB     r1,[r4,#0]            ;886  ; work_stat
000538  b351              CBZ      r1,|L5.1424|
00053a  49d7              LDR      r1,|L5.2200|
00053c  8809              LDRH     r1,[r1,#0]            ;886  ; ACH_OFF_EN
00053e  b339              CBZ      r1,|L5.1424|
000540  4ad6              LDR      r2,|L5.2204|
000542  6801              LDR      r1,[r0,#0]  ; milliAmperSecunda
000544  f9b22000          LDRSH    r2,[r2,#0]  ; load_I
000548  4411              ADD      r1,r1,r2
;;;889    	if(milliAmperSecunda>=3600L)
00054a  6001              STR      r1,[r0,#0]  ; milliAmperSecunda
00054c  f5b16f61          CMP      r1,#0xe10
000550  db1f              BLT      |L5.1426|
;;;890    		{
;;;891    		milliAmperSecunda-=3600L;
;;;892    		AMPERCHAS+=1;
000552  4ed3              LDR      r6,|L5.2208|
000554  f5a16161          SUB      r1,r1,#0xe10          ;891
000558  6001              STR      r1,[r0,#0]  ; milliAmperSecunda
00055a  6831              LDR      r1,[r6,#0]  ; AMPERCHAS
;;;893    		lc640_write_long(EE_AMPERCHAS,AMPERCHAS);
00055c  f44f709e          MOV      r0,#0x13c
000560  1c49              ADDS     r1,r1,#1              ;892
000562  6031              STR      r1,[r6,#0]  ; AMPERCHAS
000564  f7fffffe          BL       lc640_write_long
;;;894    
;;;895    		if(AMPERCHAS>=ACH_OFF_LEVEL)
000568  49ce              LDR      r1,|L5.2212|
00056a  6830              LDR      r0,[r6,#0]  ; AMPERCHAS
00056c  f9b11000          LDRSH    r1,[r1,#0]  ; ACH_OFF_LEVEL
000570  4288              CMP      r0,r1
000572  db0e              BLT      |L5.1426|
;;;896    			{
;;;897    			work_stat=wsOFF;
000574  7025              STRB     r5,[r4,#0]
;;;898    			restart_off();
000576  f7fffffe          BL       restart_off
;;;899    			tree_up(iProcIsComplete,1,0,0);
00057a  2300              MOVS     r3,#0
00057c  461a              MOV      r2,r3
00057e  2101              MOVS     r1,#1
000580  2078              MOVS     r0,#0x78
000582  f7fffffe          BL       tree_up
;;;900    			ret(0);
000586  e8bd4070          POP      {r4-r6,lr}
00058a  2000              MOVS     r0,#0
00058c  f7ffbffe          B.W      ||ret||
                  |L5.1424|
;;;901    			}
;;;902    		}
;;;903    	}
;;;904    else 
;;;905    	{
;;;906    	milliAmperSecunda=0;
000590  6005              STR      r5,[r0,#0]  ; milliAmperSecunda
                  |L5.1426|
;;;907    	}
;;;908    
;;;909    }
000592  bd70              POP      {r4-r6,pc}
;;;910     	
                          ENDP

                  curr_off_hndl PROC
;;;912    //драйвер функции выключения по снижению тока
;;;913    void curr_off_hndl(void)
000594  b570              PUSH     {r4-r6,lr}
;;;914    {
;;;915    
;;;916    if((work_stat!=wsOFF)&&(CURR_OFF_EN))
000596  4cbe              LDR      r4,|L5.2192|
;;;917    	{
;;;918    	if(curr_off_start_cnt<CUR_OFF_T_OFF)curr_off_start_cnt++;
;;;919    	else
;;;920    		{
;;;921    		signed int temp_I=0;
;;;922    		if(work_stat==wsGS)
;;;923    			{
;;;924    			temp_I=(signed int)I_ug_temp;
;;;925    			}
;;;926    		else if(work_stat==wsPS)
;;;927    			{
;;;928    			temp_I=(signed int)I_maxp;
;;;929    			}
;;;930    		temp_I*=(signed int)CUR_OFF_LEVEL_RELATIV;
;;;931    		temp_I/=100;
;;;932    		curr_off_temp=(short)temp_I;
;;;933    		if(load_I<curr_off_temp)
;;;934    			{
;;;935    			curr_off_stop_cnt++;
000598  4ac3              LDR      r2,|L5.2216|
00059a  48c4              LDR      r0,|L5.2220|
00059c  7825              LDRB     r5,[r4,#0]            ;916  ; work_stat
00059e  2100              MOVS     r1,#0                 ;916
0005a0  b3f5              CBZ      r5,|L5.1568|
0005a2  4bc3              LDR      r3,|L5.2224|
0005a4  881b              LDRH     r3,[r3,#0]            ;916  ; CURR_OFF_EN
0005a6  b3db              CBZ      r3,|L5.1568|
0005a8  4ec2              LDR      r6,|L5.2228|
0005aa  f9b03000          LDRSH    r3,[r0,#0]            ;918  ; curr_off_start_cnt
0005ae  f9b66000          LDRSH    r6,[r6,#0]            ;918  ; CUR_OFF_T_OFF
0005b2  42b3              CMP      r3,r6                 ;918
0005b4  da02              BGE      |L5.1468|
0005b6  1c5b              ADDS     r3,r3,#1              ;918
0005b8  8003              STRH     r3,[r0,#0]            ;918
                  |L5.1466|
;;;936    			if(curr_off_stop_cnt>=CUR_OFF_T_ON)
;;;937    				{
;;;938    				work_stat=wsOFF;
;;;939    				restart_off();
;;;940    				tree_up(iProcIsComplete,2,0,0);
;;;941    				ret(0);
;;;942    				}
;;;943    			}
;;;944    		else curr_off_stop_cnt=0;
;;;945    		}
;;;946    	}
;;;947    else 
;;;948    	{
;;;949    	curr_off_start_cnt=0;
;;;950    	curr_off_stop_cnt=0;
;;;951    	}
;;;952    }	
0005ba  bd70              POP      {r4-r6,pc}
                  |L5.1468|
0005bc  2000              MOVS     r0,#0                 ;921
0005be  2d01              CMP      r5,#1                 ;922
0005c0  d002              BEQ      |L5.1480|
0005c2  2d02              CMP      r5,#2                 ;926
0005c4  d002              BEQ      |L5.1484|
0005c6  e004              B        |L5.1490|
                  |L5.1480|
0005c8  48bb              LDR      r0,|L5.2232|
0005ca  e000              B        |L5.1486|
                  |L5.1484|
0005cc  48bb              LDR      r0,|L5.2236|
                  |L5.1486|
0005ce  f9b00000          LDRSH    r0,[r0,#0]            ;928  ; I_maxp
                  |L5.1490|
0005d2  4bbb              LDR      r3,|L5.2240|
0005d4  f9b33000          LDRSH    r3,[r3,#0]            ;930  ; CUR_OFF_LEVEL_RELATIV
0005d8  4358              MULS     r0,r3,r0              ;930
0005da  2364              MOVS     r3,#0x64              ;931
0005dc  fb90f0f3          SDIV     r0,r0,r3              ;931
0005e0  4bb8              LDR      r3,|L5.2244|
0005e2  b200              SXTH     r0,r0                 ;932
0005e4  8018              STRH     r0,[r3,#0]            ;932
0005e6  4bad              LDR      r3,|L5.2204|
0005e8  f9b33000          LDRSH    r3,[r3,#0]            ;933  ; load_I
0005ec  4283              CMP      r3,r0                 ;933
0005ee  da16              BGE      |L5.1566|
0005f0  8810              LDRH     r0,[r2,#0]            ;935  ; curr_off_stop_cnt
0005f2  1c40              ADDS     r0,r0,#1              ;935
0005f4  b200              SXTH     r0,r0                 ;935
0005f6  8010              STRH     r0,[r2,#0]            ;935
0005f8  4ab3              LDR      r2,|L5.2248|
0005fa  f9b22000          LDRSH    r2,[r2,#0]            ;936  ; CUR_OFF_T_ON
0005fe  4290              CMP      r0,r2                 ;936
000600  dbdb              BLT      |L5.1466|
000602  7021              STRB     r1,[r4,#0]            ;938
000604  f7fffffe          BL       restart_off
000608  2300              MOVS     r3,#0                 ;940
00060a  461a              MOV      r2,r3                 ;940
00060c  2102              MOVS     r1,#2                 ;940
00060e  2078              MOVS     r0,#0x78              ;940
000610  f7fffffe          BL       tree_up
000614  e8bd4070          POP      {r4-r6,lr}            ;941
000618  2000              MOVS     r0,#0                 ;941
00061a  f7ffbffe          B.W      ||ret||
                  |L5.1566|
00061e  e000              B        |L5.1570|
                  |L5.1568|
000620  e001              B        |L5.1574|
                  |L5.1570|
000622  8011              STRH     r1,[r2,#0]            ;944
000624  bd70              POP      {r4-r6,pc}
                  |L5.1574|
000626  8001              STRH     r1,[r0,#0]            ;949
000628  e7f9              B        |L5.1566|
;;;953    
                          ENDP

                  time_hndl PROC
;;;954    //-----------------------------------------------
;;;955    void time_hndl(void) /*ГЦ раз в секунду*/
00062a  e92d5ff0          PUSH     {r4-r12,lr}
;;;956    {
;;;957    if((REV_IS_ON)&&(AVT_REV_IS_ON))
;;;958    	{
;;;959    
;;;960    	}
;;;961    
;;;962    
;;;963    
;;;964    
;;;965    if(work_stat==wsGS)
00062e  f8df8260          LDR      r8,|L5.2192|
;;;966    	{
;;;967    	time_proc++;
;;;968    	if(((time_proc%600L)==0)&&(restart_enable==reON))
;;;969    		{
;;;970    		lc640_write_long(EE_TIME_PROC_GS_RESTART,time_proc);
;;;971    		}
;;;972    	if(time_proc_remain)
;;;973    		{
;;;974    		time_proc_remain--;
;;;975    		}
;;;976    	if((!time_proc_remain)&&(!T_PROC_GS_MODE))
;;;977    		{
;;;978    		work_stat=wsOFF;
;;;979    		restart_off();
;;;980    		tree_up(iProcIsComplete,0,0,0);
;;;981    		ret(0);
;;;982    		}
;;;983    	if((REV_IS_ON)&&(AVT_REV_IS_ON)){
000632  f8dfb298          LDR      r11,|L5.2252|
;;;984    		time_proc_phase++;
;;;985    		
;;;986    		if(proc_phase==ppFF) {
;;;987    			REV_STAT=rsFF;
000636  4da6              LDR      r5,|L5.2256|
000638  f8980000          LDRB     r0,[r8,#0]            ;965  ; work_stat
;;;988    			if(time_proc_phase>=AVT_REV_TIME_FF) {
;;;989    				proc_phase=ppFF_P_REW;	
;;;990    				time_proc_phase=0;
;;;991    			}
;;;992    		} else if(proc_phase==ppFF_P_REW) {
;;;993    			if(time_proc_phase==0)REV_STAT=rsFF;
;;;994    			else REV_STAT=rsREW;
;;;995    			if(time_proc_phase>=AVT_REV_TIME_PAUSE) {
00063c  4fa5              LDR      r7,|L5.2260|
00063e  f8df9298          LDR      r9,|L5.2264|
000642  2601              MOVS     r6,#1                 ;965
000644  2400              MOVS     r4,#0                 ;972
000646  f44f7a16          MOV      r10,#0x258            ;968
00064a  2801              CMP      r0,#1                 ;965
00064c  d162              BNE      |L5.1812|
00064e  48a3              LDR      r0,|L5.2268|
000650  6801              LDR      r1,[r0,#0]            ;967  ; time_proc
000652  1c49              ADDS     r1,r1,#1              ;967
000654  fb91f2fa          SDIV     r2,r1,r10             ;968
000658  6001              STR      r1,[r0,#0]            ;968  ; time_proc
00065a  fb0a1012          MLS      r0,r10,r2,r1          ;968
00065e  b930              CBNZ     r0,|L5.1646|
000660  489f              LDR      r0,|L5.2272|
000662  7800              LDRB     r0,[r0,#0]            ;968  ; restart_enable
000664  2801              CMP      r0,#1                 ;968
000666  d102              BNE      |L5.1646|
000668  20d0              MOVS     r0,#0xd0              ;970
00066a  f7fffffe          BL       lc640_write_long
                  |L5.1646|
00066e  f8d91000          LDR      r1,[r9,#0]            ;972  ; time_proc_remain
000672  4648              MOV      r0,r9                 ;972
000674  b109              CBZ      r1,|L5.1658|
000676  1e49              SUBS     r1,r1,#1              ;974
000678  6001              STR      r1,[r0,#0]            ;974  ; time_proc_remain
                  |L5.1658|
00067a  4608              MOV      r0,r1                 ;976
00067c  4999              LDR      r1,|L5.2276|
00067e  f9b11000          LDRSH    r1,[r1,#0]            ;976  ; T_PROC_GS_MODE
000682  4308              ORRS     r0,r0,r1              ;976
000684  d10c              BNE      |L5.1696|
000686  f8884000          STRB     r4,[r8,#0]            ;978
00068a  f7fffffe          BL       restart_off
00068e  2300              MOVS     r3,#0                 ;980
000690  461a              MOV      r2,r3                 ;980
000692  4619              MOV      r1,r3                 ;980
000694  2078              MOVS     r0,#0x78              ;980
000696  f7fffffe          BL       tree_up
00069a  2000              MOVS     r0,#0                 ;981
00069c  f7fffffe          BL       ||ret||
                  |L5.1696|
0006a0  4891              LDR      r0,|L5.2280|
0006a2  8800              LDRH     r0,[r0,#0]            ;983  ; REV_IS_ON
0006a4  b3b0              CBZ      r0,|L5.1812|
0006a6  f8bb0000          LDRH     r0,[r11,#0]           ;983  ; AVT_REV_IS_ON
0006aa  b398              CBZ      r0,|L5.1812|
0006ac  4b8f              LDR      r3,|L5.2284|
0006ae  8818              LDRH     r0,[r3,#0]            ;984  ; time_proc_phase
0006b0  1c40              ADDS     r0,r0,#1              ;984
0006b2  b201              SXTH     r1,r0                 ;984
0006b4  488e              LDR      r0,|L5.2288|
0006b6  8019              STRH     r1,[r3,#0]            ;984
0006b8  7802              LDRB     r2,[r0,#0]            ;986  ; proc_phase
0006ba  b132              CBZ      r2,|L5.1738|
0006bc  2a01              CMP      r2,#1                 ;992
0006be  d00c              BEQ      |L5.1754|
;;;996    				proc_phase=ppREW;	
;;;997    				time_proc_phase=0;
;;;998    			}
;;;999    		} else if(proc_phase==ppREW) {
0006c0  2a02              CMP      r2,#2
0006c2  d015              BEQ      |L5.1776|
;;;1000   			REV_STAT=rsREW;
;;;1001   			if(time_proc_phase>=AVT_REV_TIME_REW) {
;;;1002   				proc_phase=ppREW_P_FF;	
;;;1003   				time_proc_phase=0;
;;;1004   			}
;;;1005   		} else if(proc_phase==ppREW_P_FF) {
0006c4  2a03              CMP      r2,#3
0006c6  d01c              BEQ      |L5.1794|
0006c8  e024              B        |L5.1812|
                  |L5.1738|
0006ca  4a8a              LDR      r2,|L5.2292|
0006cc  702e              STRB     r6,[r5,#0]            ;987
0006ce  f9b22000          LDRSH    r2,[r2,#0]            ;988  ; AVT_REV_TIME_FF
0006d2  4291              CMP      r1,r2                 ;988
0006d4  db1e              BLT      |L5.1812|
0006d6  7006              STRB     r6,[r0,#0]            ;989
0006d8  e01b              B        |L5.1810|
                  |L5.1754|
0006da  b139              CBZ      r1,|L5.1772|
0006dc  f8854000          STRB.W   r4,[r5,#0]            ;994
                  |L5.1760|
0006e0  f9b72000          LDRSH    r2,[r7,#0]            ;995  ; AVT_REV_TIME_PAUSE
0006e4  4291              CMP      r1,r2                 ;995
0006e6  db15              BLT      |L5.1812|
0006e8  2102              MOVS     r1,#2                 ;996
0006ea  e008              B        |L5.1790|
                  |L5.1772|
0006ec  702e              STRB     r6,[r5,#0]            ;993
0006ee  e7f7              B        |L5.1760|
                  |L5.1776|
0006f0  4a81              LDR      r2,|L5.2296|
0006f2  702c              STRB     r4,[r5,#0]            ;1000
0006f4  f9b22000          LDRSH    r2,[r2,#0]            ;1001  ; AVT_REV_TIME_REW
0006f8  4291              CMP      r1,r2                 ;1001
0006fa  db0b              BLT      |L5.1812|
0006fc  2103              MOVS     r1,#3                 ;1002
                  |L5.1790|
0006fe  7001              STRB     r1,[r0,#0]            ;996
000700  e007              B        |L5.1810|
                  |L5.1794|
;;;1006   			if(time_proc_phase==0)REV_STAT=rsREW;
000702  b1a9              CBZ      r1,|L5.1840|
;;;1007   			else REV_STAT=rsFF;
000704  f8856000          STRB.W   r6,[r5,#0]
                  |L5.1800|
;;;1008   			if(time_proc_phase>=AVT_REV_TIME_PAUSE) {
000708  f9b72000          LDRSH    r2,[r7,#0]  ; AVT_REV_TIME_PAUSE
00070c  4291              CMP      r1,r2
00070e  db01              BLT      |L5.1812|
;;;1009   				proc_phase=ppFF;	
000710  7004              STRB     r4,[r0,#0]
                  |L5.1810|
;;;1010   				time_proc_phase=0;
000712  801c              STRH     r4,[r3,#0]
                  |L5.1812|
;;;1011   			}
;;;1012   		}
;;;1013   	}
;;;1014   	}
;;;1015   
;;;1016   
;;;1017   if(work_stat==wsPS)
000714  f8980000          LDRB     r0,[r8,#0]  ; work_stat
000718  2802              CMP      r0,#2
00071a  d15c              BNE      |L5.2006|
;;;1018   	{
;;;1019   	time_proc++;
00071c  486f              LDR      r0,|L5.2268|
00071e  6801              LDR      r1,[r0,#0]  ; time_proc
000720  1c49              ADDS     r1,r1,#1
;;;1020   	if(((time_proc%600L)==0)&&(restart_enable==reON))
000722  fb91f2fa          SDIV     r2,r1,r10
000726  6001              STR      r1,[r0,#0]  ; time_proc
000728  fb0a1012          MLS      r0,r10,r2,r1
00072c  b110              CBZ      r0,|L5.1844|
00072e  e008              B        |L5.1858|
                  |L5.1840|
000730  702c              STRB     r4,[r5,#0]            ;1006
000732  e7e9              B        |L5.1800|
                  |L5.1844|
000734  486a              LDR      r0,|L5.2272|
000736  7800              LDRB     r0,[r0,#0]  ; restart_enable
000738  2801              CMP      r0,#1
00073a  d102              BNE      |L5.1858|
;;;1021   		{
;;;1022   		lc640_write_long(EE_TIME_PROC_PS_RESTART,time_proc);
00073c  20d4              MOVS     r0,#0xd4
00073e  f7fffffe          BL       lc640_write_long
                  |L5.1858|
;;;1023   		}
;;;1024   	if(time_proc_remain)
000742  f8d91000          LDR      r1,[r9,#0]  ; time_proc_remain
000746  4648              MOV      r0,r9
000748  b109              CBZ      r1,|L5.1870|
;;;1025   		{
;;;1026   		time_proc_remain--;
00074a  1e49              SUBS     r1,r1,#1
00074c  6001              STR      r1,[r0,#0]  ; time_proc_remain
                  |L5.1870|
;;;1027   		}
;;;1028   	if((!time_proc_remain)&&(!T_PROC_PS_MODE))
00074e  4608              MOV      r0,r1
000750  496a              LDR      r1,|L5.2300|
000752  f9b11000          LDRSH    r1,[r1,#0]  ; T_PROC_PS_MODE
000756  4308              ORRS     r0,r0,r1
000758  d10c              BNE      |L5.1908|
;;;1029   		{
;;;1030   		work_stat=wsOFF;
00075a  f8884000          STRB     r4,[r8,#0]
;;;1031   		restart_off();
00075e  f7fffffe          BL       restart_off
;;;1032   		tree_up(iProcIsComplete,0,0,0);
000762  2300              MOVS     r3,#0
000764  461a              MOV      r2,r3
000766  4619              MOV      r1,r3
000768  2078              MOVS     r0,#0x78
00076a  f7fffffe          BL       tree_up
;;;1033   		ret(0);
00076e  2000              MOVS     r0,#0
000770  f7fffffe          BL       ||ret||
                  |L5.1908|
;;;1034   		}
;;;1035   	if((REV_IS_ON)&&(AVT_REV_IS_ON)){
000774  485c              LDR      r0,|L5.2280|
000776  8800              LDRH     r0,[r0,#0]  ; REV_IS_ON
000778  2800              CMP      r0,#0
00077a  d02c              BEQ      |L5.2006|
00077c  f8bb0000          LDRH     r0,[r11,#0]  ; AVT_REV_IS_ON
000780  2800              CMP      r0,#0
000782  d028              BEQ      |L5.2006|
;;;1036   		time_proc_phase++;
000784  4859              LDR      r0,|L5.2284|
000786  8801              LDRH     r1,[r0,#0]  ; time_proc_phase
000788  1c49              ADDS     r1,r1,#1
00078a  b20a              SXTH     r2,r1
;;;1037   		
;;;1038   		if(proc_phase==ppFF) {
00078c  4958              LDR      r1,|L5.2288|
00078e  8002              STRH     r2,[r0,#0]            ;1036
000790  780b              LDRB     r3,[r1,#0]  ; proc_phase
000792  b16b              CBZ      r3,|L5.1968|
;;;1039   			REV_STAT=rsFF;
;;;1040   			if(time_proc_phase>=AVT_REV_TIME_FF) {
;;;1041   				proc_phase=ppFF_P_REW;	
;;;1042   				time_proc_phase=0;
;;;1043   			}
;;;1044   		} else if(proc_phase==ppFF_P_REW) {
000794  2b01              CMP      r3,#1
000796  d013              BEQ      |L5.1984|
;;;1045   			if(time_proc_phase==0)REV_STAT=rsFF;
;;;1046   			else REV_STAT=rsREW;
;;;1047   			if(time_proc_phase>=AVT_REV_TIME_PAUSE) {
;;;1048   				proc_phase=ppREW;	
;;;1049   				time_proc_phase=0;
;;;1050   			}
;;;1051   		} else if(proc_phase==ppREW) {
000798  2b02              CMP      r3,#2
00079a  d01e              BEQ      |L5.2010|
;;;1052   			REV_STAT=rsREW;
;;;1053   			if(time_proc_phase>=AVT_REV_TIME_REW) {
;;;1054   				proc_phase=ppREW_P_FF;	
;;;1055   				time_proc_phase=0;
;;;1056   			}
;;;1057   		} else if(proc_phase==ppREW_P_FF) {
00079c  2b03              CMP      r3,#3
00079e  d11a              BNE      |L5.2006|
;;;1058   			if(time_proc_phase==0)REV_STAT=rsREW;
0007a0  b322              CBZ      r2,|L5.2028|
;;;1059   			else REV_STAT=rsFF;
0007a2  702e              STRB     r6,[r5,#0]
                  |L5.1956|
;;;1060   			if(time_proc_phase>=AVT_REV_TIME_PAUSE) {
0007a4  f9b73000          LDRSH    r3,[r7,#0]  ; AVT_REV_TIME_PAUSE
0007a8  429a              CMP      r2,r3
0007aa  db14              BLT      |L5.2006|
;;;1061   				proc_phase=ppFF;	
0007ac  700c              STRB     r4,[r1,#0]
;;;1062   				time_proc_phase=0;
0007ae  e011              B        |L5.2004|
                  |L5.1968|
0007b0  4b50              LDR      r3,|L5.2292|
0007b2  702e              STRB     r6,[r5,#0]            ;1039
0007b4  f9b33000          LDRSH    r3,[r3,#0]            ;1040  ; AVT_REV_TIME_FF
0007b8  429a              CMP      r2,r3                 ;1040
0007ba  db0c              BLT      |L5.2006|
0007bc  700e              STRB     r6,[r1,#0]            ;1041
0007be  e009              B        |L5.2004|
                  |L5.1984|
0007c0  b132              CBZ      r2,|L5.2000|
0007c2  702c              STRB     r4,[r5,#0]            ;1046
                  |L5.1988|
0007c4  f9b73000          LDRSH    r3,[r7,#0]            ;1047  ; AVT_REV_TIME_PAUSE
0007c8  429a              CMP      r2,r3                 ;1047
0007ca  db04              BLT      |L5.2006|
0007cc  2202              MOVS     r2,#2                 ;1048
0007ce  e00b              B        |L5.2024|
                  |L5.2000|
0007d0  702e              STRB     r6,[r5,#0]            ;1045
0007d2  e7f7              B        |L5.1988|
                  |L5.2004|
0007d4  8004              STRH     r4,[r0,#0]            ;1042
                  |L5.2006|
;;;1063   			}
;;;1064   		}
;;;1065   	}
;;;1066   	}
;;;1067   
;;;1068   
;;;1069   
;;;1070   }
0007d6  e8bd9ff0          POP      {r4-r12,pc}
                  |L5.2010|
0007da  4b47              LDR      r3,|L5.2296|
0007dc  702c              STRB     r4,[r5,#0]            ;1052
0007de  f9b33000          LDRSH    r3,[r3,#0]            ;1053  ; AVT_REV_TIME_REW
0007e2  429a              CMP      r2,r3                 ;1053
0007e4  dbf7              BLT      |L5.2006|
0007e6  2203              MOVS     r2,#3                 ;1054
                  |L5.2024|
0007e8  700a              STRB     r2,[r1,#0]            ;1054
0007ea  e7f3              B        |L5.2004|
                  |L5.2028|
0007ec  702c              STRB     r4,[r5,#0]            ;1058
0007ee  e7d9              B        |L5.1956|
;;;1071   
                          ENDP

                  cap_time_hndl PROC
;;;1072   //-----------------------------------------------
;;;1073   void cap_time_hndl(void) /*10 раз в секунду*/
0007f0  b570              PUSH     {r4-r6,lr}
;;;1074   {
;;;1075   
;;;1076   if(work_stat==wsCAP)
0007f2  4827              LDR      r0,|L5.2192|
0007f4  7800              LDRB     r0,[r0,#0]  ; work_stat
0007f6  2803              CMP      r0,#3
0007f8  d143              BNE      |L5.2178|
;;;1077   	{
;;;1078   	cap_time_proc++;
0007fa  4941              LDR      r1,|L5.2304|
;;;1079   	if(cap_time_proc>=(CAP_ZAR_TIME+CAP_PAUSE1_TIME+CAP_RAZR_TIME+CAP_PAUSE2_TIME))
0007fc  4841              LDR      r0,|L5.2308|
0007fe  680a              LDR      r2,[r1,#0]            ;1078  ; cap_time_proc
000800  1c52              ADDS     r2,r2,#1              ;1078
000802  600a              STR      r2,[r1,#0]  ; cap_time_proc
000804  f9b05000          LDRSH    r5,[r0,#0]  ; CAP_ZAR_TIME
000808  483f              LDR      r0,|L5.2312|
00080a  f9b00000          LDRSH    r0,[r0,#0]  ; CAP_PAUSE1_TIME
00080e  182b              ADDS     r3,r5,r0
000810  483e              LDR      r0,|L5.2316|
000812  f9b00000          LDRSH    r0,[r0,#0]  ; CAP_RAZR_TIME
000816  181c              ADDS     r4,r3,r0
000818  483d              LDR      r0,|L5.2320|
00081a  f9b00000          LDRSH    r0,[r0,#0]  ; CAP_PAUSE2_TIME
00081e  1826              ADDS     r6,r4,r0
;;;1080   		{
;;;1081   		cap_time_proc=0;
000820  2000              MOVS     r0,#0
000822  4296              CMP      r6,r2                 ;1079
000824  dc04              BGT      |L5.2096|
;;;1082   		CAP_COUNTER++;
000826  4e3b              LDR      r6,|L5.2324|
000828  6008              STR      r0,[r1,#0]  ; cap_time_proc
00082a  8832              LDRH     r2,[r6,#0]  ; CAP_COUNTER
00082c  1c52              ADDS     r2,r2,#1
00082e  8032              STRH     r2,[r6,#0]
                  |L5.2096|
;;;1083   		}
;;;1084   
;;;1085   	if(cap_time_proc>=CAP_ZAR_TIME)bOFF=1;
000830  6809              LDR      r1,[r1,#0]  ; cap_time_proc
000832  4e39              LDR      r6,|L5.2328|
000834  2201              MOVS     r2,#1
000836  42a9              CMP      r1,r5
000838  db01              BLT      |L5.2110|
00083a  7032              STRB     r2,[r6,#0]
00083c  e000              B        |L5.2112|
                  |L5.2110|
;;;1086   	else bOFF=0;
00083e  7030              STRB     r0,[r6,#0]
                  |L5.2112|
;;;1087   
;;;1088   	if((cap_time_proc>=(CAP_ZAR_TIME+CAP_PAUSE1_TIME))&&(cap_time_proc<(CAP_ZAR_TIME+CAP_PAUSE1_TIME+CAP_RAZR_TIME)))bRAZR=1;
000840  4d36              LDR      r5,|L5.2332|
000842  428b              CMP      r3,r1
000844  dc03              BGT      |L5.2126|
000846  428c              CMP      r4,r1
000848  dd01              BLE      |L5.2126|
00084a  702a              STRB     r2,[r5,#0]
00084c  e000              B        |L5.2128|
                  |L5.2126|
;;;1089   	else bRAZR=0;
00084e  7028              STRB     r0,[r5,#0]
                  |L5.2128|
;;;1090   
;;;1091   
;;;1092   	CAP_TIME_SEC++;
000850  4933              LDR      r1,|L5.2336|
000852  880a              LDRH     r2,[r1,#0]  ; CAP_TIME_SEC
000854  1c52              ADDS     r2,r2,#1
000856  b212              SXTH     r2,r2
000858  800a              STRH     r2,[r1,#0]
;;;1093   	if(CAP_TIME_SEC>=600)
00085a  f5b27f16          CMP      r2,#0x258
00085e  db10              BLT      |L5.2178|
;;;1094   		{
;;;1095   		CAP_TIME_SEC=0;
000860  8008              STRH     r0,[r1,#0]
;;;1096   		
;;;1097   		CAP_TIME_MIN++;
000862  4930              LDR      r1,|L5.2340|
000864  880a              LDRH     r2,[r1,#0]  ; CAP_TIME_MIN
000866  1c52              ADDS     r2,r2,#1
000868  b212              SXTH     r2,r2
00086a  800a              STRH     r2,[r1,#0]
;;;1098   		if(CAP_TIME_MIN>=60)
00086c  2a3c              CMP      r2,#0x3c
00086e  db08              BLT      |L5.2178|
;;;1099   			{
;;;1100   			CAP_TIME_MIN=0;
000870  8008              STRH     r0,[r1,#0]
;;;1101   	
;;;1102   			CAP_TIME_HOUR++;
000872  492d              LDR      r1,|L5.2344|
000874  880a              LDRH     r2,[r1,#0]  ; CAP_TIME_HOUR
000876  1c52              ADDS     r2,r2,#1
000878  b212              SXTH     r2,r2
00087a  800a              STRH     r2,[r1,#0]
;;;1103   			if(CAP_TIME_HOUR>=24)
00087c  2a18              CMP      r2,#0x18
00087e  db00              BLT      |L5.2178|
;;;1104   				{
;;;1105   				CAP_TIME_HOUR=0;
000880  8008              STRH     r0,[r1,#0]
                  |L5.2178|
;;;1106   				}
;;;1107   			}
;;;1108   		}
;;;1109   	}
;;;1110   
;;;1111   }
000882  bd70              POP      {r4-r6,pc}
                  |L5.2180|
                          DCD      avg
                  |L5.2184|
                          DCD      bAVG
                  |L5.2188|
                          DCD      bAVG_CNT
                  |L5.2192|
                          DCD      work_stat
                  |L5.2196|
                          DCD      milliAmperSecunda
                  |L5.2200|
                          DCD      ACH_OFF_EN
                  |L5.2204|
                          DCD      load_I
                  |L5.2208|
                          DCD      AMPERCHAS
                  |L5.2212|
                          DCD      ACH_OFF_LEVEL
                  |L5.2216|
                          DCD      curr_off_stop_cnt
                  |L5.2220|
                          DCD      curr_off_start_cnt
                  |L5.2224|
                          DCD      CURR_OFF_EN
                  |L5.2228|
                          DCD      CUR_OFF_T_OFF
                  |L5.2232|
                          DCD      I_ug_temp
                  |L5.2236|
                          DCD      I_maxp
                  |L5.2240|
                          DCD      CUR_OFF_LEVEL_RELATIV
                  |L5.2244|
                          DCD      curr_off_temp
                  |L5.2248|
                          DCD      CUR_OFF_T_ON
                  |L5.2252|
                          DCD      AVT_REV_IS_ON
                  |L5.2256|
                          DCD      REV_STAT
                  |L5.2260|
                          DCD      AVT_REV_TIME_PAUSE
                  |L5.2264|
                          DCD      time_proc_remain
                  |L5.2268|
                          DCD      time_proc
                  |L5.2272|
                          DCD      restart_enable
                  |L5.2276|
                          DCD      T_PROC_GS_MODE
                  |L5.2280|
                          DCD      REV_IS_ON
                  |L5.2284|
                          DCD      time_proc_phase
                  |L5.2288|
                          DCD      proc_phase
                  |L5.2292|
                          DCD      AVT_REV_TIME_FF
                  |L5.2296|
                          DCD      AVT_REV_TIME_REW
                  |L5.2300|
                          DCD      T_PROC_PS_MODE
                  |L5.2304|
                          DCD      cap_time_proc
                  |L5.2308|
                          DCD      CAP_ZAR_TIME
                  |L5.2312|
                          DCD      CAP_PAUSE1_TIME
                  |L5.2316|
                          DCD      CAP_RAZR_TIME
                  |L5.2320|
                          DCD      CAP_PAUSE2_TIME
                  |L5.2324|
                          DCD      CAP_COUNTER
                  |L5.2328|
                          DCD      bOFF
                  |L5.2332|
                          DCD      bRAZR
                  |L5.2336|
                          DCD      CAP_TIME_SEC
                  |L5.2340|
                          DCD      CAP_TIME_MIN
                  |L5.2344|
                          DCD      CAP_TIME_HOUR
                          ENDP

                  restart_on_GS PROC
;;;1114   //-----------------------------------------------
;;;1115   void restart_on_GS(void)
00092c  2101              MOVS     r1,#1
;;;1116   {
;;;1117   lc640_write_long(EE_TIME_PROC_GS_RESTART,1);
00092e  20d0              MOVS     r0,#0xd0
000930  f7ffbffe          B.W      lc640_write_long
;;;1118   }
;;;1119   
                          ENDP

                  restart_on_PS PROC
;;;1120   //-----------------------------------------------
;;;1121   void restart_on_PS(void)
000934  2101              MOVS     r1,#1
;;;1122   {
;;;1123   lc640_write_long(EE_TIME_PROC_PS_RESTART,1);
000936  20d4              MOVS     r0,#0xd4
000938  f7ffbffe          B.W      lc640_write_long
;;;1124   }
;;;1125   
                          ENDP

                  start_GS PROC
;;;1133   //-----------------------------------------------
;;;1134   void start_GS(void) {
00093c  b570              PUSH     {r4-r6,lr}
;;;1135   	work_stat=wsGS;
00093e  48f8              LDR      r0,|L5.3360|
000940  2501              MOVS     r5,#1
;;;1136   	time_proc=0;
000942  2400              MOVS     r4,#0
000944  7005              STRB     r5,[r0,#0]            ;1135
000946  48f7              LDR      r0,|L5.3364|
;;;1137   	time_proc_remain=T_PROC_GS;
000948  49f8              LDR      r1,|L5.3372|
00094a  6004              STR      r4,[r0,#0]  ; time_proc
00094c  48f6              LDR      r0,|L5.3368|
00094e  6800              LDR      r0,[r0,#0]  ; T_PROC_GS
;;;1138   	//index_set=0;
;;;1139   	restart_on_GS();
000950  6008              STR      r0,[r1,#0]  ; time_proc_remain
000952  f7fffffe          BL       restart_on_GS
;;;1140   	bFAST_REG=1;
000956  48f6              LDR      r0,|L5.3376|
000958  7205              STRB     r5,[r0,#8]
;;;1141   	bU_VALID=0;
00095a  7244              STRB     r4,[r0,#9]
;;;1142   	bU_VALID_VALID=0;
00095c  7284              STRB     r4,[r0,#0xa]
;;;1143   	
;;;1144   	if((REV_IS_ON)&&(AVT_REV_IS_ON)){
00095e  48f5              LDR      r0,|L5.3380|
000960  8800              LDRH     r0,[r0,#0]  ; REV_IS_ON
000962  b140              CBZ      r0,|L5.2422|
000964  48f4              LDR      r0,|L5.3384|
000966  8800              LDRH     r0,[r0,#0]  ; AVT_REV_IS_ON
000968  b128              CBZ      r0,|L5.2422|
;;;1145   		time_proc_phase=0;
00096a  48f4              LDR      r0,|L5.3388|
00096c  8004              STRH     r4,[r0,#0]
;;;1146   		proc_phase=ppFF;
00096e  48f4              LDR      r0,|L5.3392|
000970  7004              STRB     r4,[r0,#0]
;;;1147   		REV_STAT=rsFF;	
000972  48f4              LDR      r0,|L5.3396|
000974  7005              STRB     r5,[r0,#0]
                  |L5.2422|
;;;1148   	}
;;;1149   
;;;1150   	milliAmperSecunda=0L;
000976  48f4              LDR      r0,|L5.3400|
000978  4621              MOV      r1,r4
;;;1151   	AMPERCHAS=0L;
00097a  6004              STR      r4,[r0,#0]  ; milliAmperSecunda
00097c  48f3              LDR      r0,|L5.3404|
;;;1152   	lc640_write_long(EE_AMPERCHAS,AMPERCHAS);
00097e  6004              STR      r4,[r0,#0]  ; AMPERCHAS
000980  e8bd4070          POP      {r4-r6,lr}
000984  f44f709e          MOV      r0,#0x13c
000988  f7ffbffe          B.W      lc640_write_long
;;;1153   }
;;;1154   
                          ENDP

                  start_PS PROC
;;;1156   //-----------------------------------------------
;;;1157   void start_PS(void) {
00098c  49e4              LDR      r1,|L5.3360|
00098e  b510              PUSH     {r4,lr}
;;;1158   	work_stat=wsPS;
000990  2002              MOVS     r0,#2
000992  7008              STRB     r0,[r1,#0]
;;;1159   	time_proc=0;
000994  48e3              LDR      r0,|L5.3364|
000996  2400              MOVS     r4,#0
;;;1160   	time_proc_remain=T_PROC_PS;
000998  49e4              LDR      r1,|L5.3372|
00099a  6004              STR      r4,[r0,#0]  ; time_proc
00099c  48ec              LDR      r0,|L5.3408|
00099e  6800              LDR      r0,[r0,#0]  ; T_PROC_PS
;;;1161   	//index_set=0;
;;;1162   	restart_on_PS();
0009a0  6008              STR      r0,[r1,#0]  ; time_proc_remain
0009a2  f7fffffe          BL       restart_on_PS
;;;1163   	bFAST_REG=1;
0009a6  48e2              LDR      r0,|L5.3376|
0009a8  2101              MOVS     r1,#1
0009aa  7201              STRB     r1,[r0,#8]
;;;1164   	bU_VALID=0;
0009ac  7244              STRB     r4,[r0,#9]
;;;1165   	bU_VALID_VALID=0;
0009ae  7284              STRB     r4,[r0,#0xa]
;;;1166   	
;;;1167   	if((REV_IS_ON)&&(AVT_REV_IS_ON)){
0009b0  48e0              LDR      r0,|L5.3380|
0009b2  8800              LDRH     r0,[r0,#0]  ; REV_IS_ON
0009b4  b140              CBZ      r0,|L5.2504|
0009b6  48e0              LDR      r0,|L5.3384|
0009b8  8800              LDRH     r0,[r0,#0]  ; AVT_REV_IS_ON
0009ba  b128              CBZ      r0,|L5.2504|
;;;1168   		time_proc_phase=0;
0009bc  48df              LDR      r0,|L5.3388|
0009be  8004              STRH     r4,[r0,#0]
;;;1169   		proc_phase=ppFF;
0009c0  48df              LDR      r0,|L5.3392|
0009c2  7004              STRB     r4,[r0,#0]
;;;1170   		REV_STAT=rsFF;	
0009c4  48df              LDR      r0,|L5.3396|
0009c6  7001              STRB     r1,[r0,#0]
                  |L5.2504|
;;;1171   	}
;;;1172   	milliAmperSecunda=0L;
0009c8  48df              LDR      r0,|L5.3400|
0009ca  4621              MOV      r1,r4
;;;1173   	AMPERCHAS=0L;
0009cc  6004              STR      r4,[r0,#0]  ; milliAmperSecunda
0009ce  48df              LDR      r0,|L5.3404|
;;;1174   	lc640_write_long(EE_AMPERCHAS,AMPERCHAS);
0009d0  6004              STR      r4,[r0,#0]  ; AMPERCHAS
0009d2  e8bd4010          POP      {r4,lr}
0009d6  f44f709e          MOV      r0,#0x13c
0009da  f7ffbffe          B.W      lc640_write_long
;;;1175   }
;;;1176   
                          ENDP

                  start_CAP PROC
;;;1177   //-----------------------------------------------
;;;1178   void start_CAP(void) {
0009de  49d0              LDR      r1,|L5.3360|
;;;1179   	work_stat=wsCAP;
0009e0  2003              MOVS     r0,#3
0009e2  7008              STRB     r0,[r1,#0]
;;;1180   }
0009e4  4770              BX       lr
;;;1181   
                          ENDP

                  pause_CAP PROC
;;;1182   //-----------------------------------------------
;;;1183   void pause_CAP(void) {
0009e6  49ce              LDR      r1,|L5.3360|
;;;1184   	work_stat=wsOFF;
0009e8  2000              MOVS     r0,#0
0009ea  7008              STRB     r0,[r1,#0]
;;;1185   }
0009ec  4770              BX       lr
;;;1186   
                          ENDP

                  stop_CAP PROC
;;;1187   //-----------------------------------------------
;;;1188   void stop_CAP(void) {
0009ee  49cc              LDR      r1,|L5.3360|
;;;1189   	work_stat=wsOFF;
0009f0  2000              MOVS     r0,#0
0009f2  7008              STRB     r0,[r1,#0]
;;;1190   
;;;1191   }
0009f4  4770              BX       lr
;;;1192   
                          ENDP

                  ramModbusCnt_hndl PROC
;;;1193   //-----------------------------------------------
;;;1194   void ramModbusCnt_hndl(void)  
0009f6  48d7              LDR      r0,|L5.3412|
;;;1195   {
;;;1196   if(ramModbusCnt) ramModbusCnt--;
0009f8  f9b01000          LDRSH    r1,[r0,#0]  ; ramModbusCnt
0009fc  b111              CBZ      r1,|L5.2564|
0009fe  1e49              SUBS     r1,r1,#1
000a00  8001              STRH     r1,[r0,#0]
;;;1197   else 
;;;1198   	{
;;;1199   	I_ug_ram=0;
;;;1200   	U_up_ram=0;
;;;1201   	}	
;;;1202   }
000a02  4770              BX       lr
                  |L5.2564|
000a04  49d4              LDR      r1,|L5.3416|
000a06  2000              MOVS     r0,#0                 ;1199
000a08  8008              STRH     r0,[r1,#0]            ;1199
000a0a  49d4              LDR      r1,|L5.3420|
000a0c  8008              STRH     r0,[r1,#0]            ;1200
000a0e  4770              BX       lr
;;;1203   
                          ENDP

                  reset_CAP PROC
;;;1204   //-----------------------------------------------
;;;1205   void reset_CAP(void) {
000a10  49c3              LDR      r1,|L5.3360|
;;;1206   	work_stat=wsOFF;
000a12  2000              MOVS     r0,#0
000a14  7008              STRB     r0,[r1,#0]
;;;1207   	cap_time_proc=0;
000a16  49d2              LDR      r1,|L5.3424|
;;;1208   	CAP_COUNTER=0;
000a18  6008              STR      r0,[r1,#0]  ; cap_time_proc
000a1a  49d2              LDR      r1,|L5.3428|
000a1c  8008              STRH     r0,[r1,#0]
;;;1209   	CAP_TIME_SEC=0;
000a1e  49d2              LDR      r1,|L5.3432|
000a20  8008              STRH     r0,[r1,#0]
;;;1210   	CAP_TIME_MIN=0;
000a22  49d2              LDR      r1,|L5.3436|
000a24  8008              STRH     r0,[r1,#0]
;;;1211   	CAP_TIME_HOUR=0;
000a26  49d2              LDR      r1,|L5.3440|
000a28  8008              STRH     r0,[r1,#0]
;;;1212   }
000a2a  4770              BX       lr
;;;1213   
                          ENDP

                  stop_proc PROC
;;;1214   //-----------------------------------------------
;;;1215   void stop_proc(void)
000a2c  49bc              LDR      r1,|L5.3360|
;;;1216   {
;;;1217   work_stat=wsOFF;
000a2e  2000              MOVS     r0,#0
000a30  7008              STRB     r0,[r1,#0]
;;;1218   restart_off();
000a32  e7fe              B        restart_off
;;;1219   }
;;;1220   
                          ENDP

                  find_U_curve PROC
;;;1221   //-----------------------------------------------
;;;1222   short find_U_curve(signed short in)
000a34  e92d41f0          PUSH     {r4-r8,lr}
;;;1223   {
;;;1224   short ii,i=0,out=0;
000a38  2400              MOVS     r4,#0
000a3a  4606              MOV      r6,r0                 ;1223
;;;1225   
;;;1226   ii=0;
;;;1227   
;;;1228   if(lc640_read_int(SEKTOR_KURVE_U+(ii*2)) >= in)
000a3c  f44f75fa          MOV      r5,#0x1f4
000a40  46a0              MOV      r8,r4                 ;1224
000a42  4627              MOV      r7,r4                 ;1226
000a44  4628              MOV      r0,r5
000a46  f7fffffe          BL       lc640_read_int
000a4a  42b0              CMP      r0,r6
000a4c  da29              BGE      |L5.2722|
;;;1229   	{
;;;1230   	out=0;
;;;1231   	}
;;;1232   else 
;;;1233   	{
;;;1234   	for (ii=0;ii<=200;ii+=10)
;;;1235   		{
;;;1236   		if(lc640_read_int(SEKTOR_KURVE_U+(ii*2)) <= in)
000a4e  bf00              NOP      
                  |L5.2640|
000a50  eb050047          ADD      r0,r5,r7,LSL #1
000a54  f7fffffe          BL       lc640_read_int
000a58  42b0              CMP      r0,r6
000a5a  dc00              BGT      |L5.2654|
;;;1237   			{
;;;1238   			i=ii;
000a5c  463c              MOV      r4,r7
                  |L5.2654|
000a5e  370a              ADDS     r7,r7,#0xa            ;1234
000a60  b23f              SXTH     r7,r7                 ;1234
000a62  2fc8              CMP      r7,#0xc8              ;1234
000a64  ddf4              BLE      |L5.2640|
;;;1239   			}
;;;1240   		else continue;
;;;1241   		}
;;;1242   	if(i<200)
000a66  2cc8              CMP      r4,#0xc8
000a68  da0e              BGE      |L5.2696|
;;;1243   		{
;;;1244   		for (ii=i;ii<i+10;ii++)
000a6a  f104070a          ADD      r7,r4,#0xa
000a6e  e008              B        |L5.2690|
                  |L5.2672|
;;;1245   			{
;;;1246   			if(lc640_read_int(SEKTOR_KURVE_U+(ii*2)) <= in)
000a70  eb050044          ADD      r0,r5,r4,LSL #1
000a74  f7fffffe          BL       lc640_read_int
000a78  42b0              CMP      r0,r6
000a7a  dc00              BGT      |L5.2686|
;;;1247   				{
;;;1248   				out=ii;
000a7c  46a0              MOV      r8,r4
                  |L5.2686|
000a7e  1c64              ADDS     r4,r4,#1              ;1244
000a80  b224              SXTH     r4,r4                 ;1244
                  |L5.2690|
000a82  42bc              CMP      r4,r7                 ;1244
000a84  dbf4              BLT      |L5.2672|
000a86  e00c              B        |L5.2722|
                  |L5.2696|
;;;1249   				}
;;;1250   			else continue;
;;;1251   			}
;;;1252   		}
;;;1253   	else 
;;;1254   		{
;;;1255   		for (ii=200;ii<=202;ii++)
000a88  f05f04c8          MOVS.W   r4,#0xc8
                  |L5.2700|
;;;1256   			{
;;;1257   			if(lc640_read_int(SEKTOR_KURVE_U+(ii*2)) <= in)
000a8c  eb050044          ADD      r0,r5,r4,LSL #1
000a90  f7fffffe          BL       lc640_read_int
000a94  42b0              CMP      r0,r6
000a96  dc00              BGT      |L5.2714|
;;;1258   				{
;;;1259   				out=ii;
000a98  46a0              MOV      r8,r4
                  |L5.2714|
000a9a  1c64              ADDS     r4,r4,#1              ;1255
000a9c  b224              SXTH     r4,r4                 ;1255
000a9e  2cca              CMP      r4,#0xca              ;1255
000aa0  ddf4              BLE      |L5.2700|
                  |L5.2722|
;;;1260   				}
;;;1261   			else continue;
;;;1262   			}
;;;1263   	
;;;1264   	
;;;1265   		}
;;;1266   	}
;;;1267   
;;;1268   return out;
000aa2  4640              MOV      r0,r8
                  |L5.2724|
;;;1269   }
000aa4  e439              B        |L5.794|
;;;1270   
                          ENDP

                  find_I_curve PROC
;;;1271   //-----------------------------------------------
;;;1272   short find_I_curve(signed short in)
000aa6  e92d41f0          PUSH     {r4-r8,lr}
;;;1273   {
;;;1274   short ii,i=0,out=0;
000aaa  2400              MOVS     r4,#0
000aac  4606              MOV      r6,r0                 ;1273
;;;1275   
;;;1276   ii=0;
;;;1277   
;;;1278   if(lc640_read_int(SEKTOR_KURVE_I+(ii*2)) >= in)
000aae  f44f757a          MOV      r5,#0x3e8
000ab2  46a0              MOV      r8,r4                 ;1274
000ab4  4627              MOV      r7,r4                 ;1276
000ab6  4628              MOV      r0,r5
000ab8  f7fffffe          BL       lc640_read_int
000abc  42b0              CMP      r0,r6
000abe  da28              BGE      |L5.2834|
                  |L5.2752|
;;;1279   	{
;;;1280   	out=0;
;;;1281   	}
;;;1282   else 
;;;1283   	{
;;;1284   	for (ii=0;ii<=200;ii+=10)
;;;1285   		{
;;;1286   		if(lc640_read_int(SEKTOR_KURVE_I+(ii*2)) <= in)
000ac0  eb050047          ADD      r0,r5,r7,LSL #1
000ac4  f7fffffe          BL       lc640_read_int
000ac8  42b0              CMP      r0,r6
000aca  dc00              BGT      |L5.2766|
;;;1287   			{
;;;1288   			i=ii;
000acc  463c              MOV      r4,r7
                  |L5.2766|
000ace  370a              ADDS     r7,r7,#0xa            ;1284
000ad0  b23f              SXTH     r7,r7                 ;1284
000ad2  2fc8              CMP      r7,#0xc8              ;1284
000ad4  ddf4              BLE      |L5.2752|
;;;1289   			}
;;;1290   		else continue;
;;;1291   		}
;;;1292   	
;;;1293   	if(i<200)
000ad6  2cc8              CMP      r4,#0xc8
000ad8  da0e              BGE      |L5.2808|
;;;1294   		{
;;;1295   		for (ii=i;ii<i+10;ii++)
000ada  f104070a          ADD      r7,r4,#0xa
000ade  e008              B        |L5.2802|
                  |L5.2784|
;;;1296   			{
;;;1297   			if(lc640_read_int(SEKTOR_KURVE_I+(ii*2)) <= in)
000ae0  eb050044          ADD      r0,r5,r4,LSL #1
000ae4  f7fffffe          BL       lc640_read_int
000ae8  42b0              CMP      r0,r6
000aea  dc00              BGT      |L5.2798|
;;;1298   				{
;;;1299   				out=ii;
000aec  46a0              MOV      r8,r4
                  |L5.2798|
000aee  1c64              ADDS     r4,r4,#1              ;1295
000af0  b224              SXTH     r4,r4                 ;1295
                  |L5.2802|
000af2  42bc              CMP      r4,r7                 ;1295
000af4  dbf4              BLT      |L5.2784|
000af6  e00c              B        |L5.2834|
                  |L5.2808|
;;;1300   				}
;;;1301   			else continue;
;;;1302   			}
;;;1303   		}
;;;1304   	else 
;;;1305   		{
;;;1306   		for (ii=200;ii<=202;ii++)
000af8  f05f04c8          MOVS.W   r4,#0xc8
                  |L5.2812|
;;;1307   			{
;;;1308   			if(lc640_read_int(SEKTOR_KURVE_I+(ii*2)) <= in)
000afc  eb050044          ADD      r0,r5,r4,LSL #1
000b00  f7fffffe          BL       lc640_read_int
000b04  42b0              CMP      r0,r6
000b06  dc00              BGT      |L5.2826|
;;;1309   				{
;;;1310   				out=ii;
000b08  46a0              MOV      r8,r4
                  |L5.2826|
000b0a  1c64              ADDS     r4,r4,#1              ;1306
000b0c  b224              SXTH     r4,r4                 ;1306
000b0e  2cca              CMP      r4,#0xca              ;1306
000b10  ddf4              BLE      |L5.2812|
                  |L5.2834|
;;;1311   				}
;;;1312   			else continue;
;;;1313   			}
;;;1314   		}
;;;1315   	}
;;;1316   return out;
000b12  4640              MOV      r0,r8
;;;1317   }
000b14  e7c6              B        |L5.2724|
;;;1318   
                          ENDP

                  viz_hndl PROC
;;;1320   //-----------------------------------------------
;;;1321   void viz_hndl(void)
000b16  e92d5ff0          PUSH     {r4-r12,lr}
;;;1322   {
;;;1323   if(ind==iK_viz_u)
000b1a  f8df9258          LDR      r9,|L5.3444|
;;;1324   	{
;;;1325   	if(viz_stat==vsON)
;;;1326   		{
;;;1327   		viz_stat_cnt++;
;;;1328   		if(viz_stat_cnt>=10221)
;;;1329   			{
;;;1330   			viz_stat=vsOFF;
;;;1331   			lc640_write_int(EE_U_CURVE_IS_ON,0xabcd);
;;;1332   			//ind=iK_viz_sel;
;;;1333   			tree_down(0,0);
;;;1334   			}
;;;1335   		tst_pwm_i=1022;
;;;1336   		tst_pwm_u=(viz_stat_cnt/50)*5;
000b1e  4f96              LDR      r7,|L5.3448|
000b20  4e96              LDR      r6,|L5.3452|
000b22  f8990000          LDRB     r0,[r9,#0]            ;1323  ; a_ind
000b26  4c96              LDR      r4,|L5.3456|
000b28  2532              MOVS     r5,#0x32
000b2a  f24278ed          MOV      r8,#0x27ed            ;1328
000b2e  f04f0a00          MOV      r10,#0                ;1330
000b32  f2403bfe          MOV      r11,#0x3fe            ;1335
000b36  2845              CMP      r0,#0x45              ;1323
000b38  d12a              BNE      |L5.2960|
000b3a  7830              LDRB     r0,[r6,#0]            ;1325  ; viz_stat
000b3c  2801              CMP      r0,#1                 ;1325
000b3e  d158              BNE      |L5.3058|
000b40  8820              LDRH     r0,[r4,#0]            ;1327  ; viz_stat_cnt
000b42  1c40              ADDS     r0,r0,#1              ;1327
000b44  b200              SXTH     r0,r0                 ;1327
000b46  8020              STRH     r0,[r4,#0]            ;1327
000b48  4540              CMP      r0,r8                 ;1328
000b4a  db09              BLT      |L5.2912|
000b4c  f886a000          STRB     r10,[r6,#0]           ;1330
000b50  498c              LDR      r1,|L5.3460|
000b52  20ac              MOVS     r0,#0xac              ;1331
000b54  f7fffffe          BL       lc640_write_int
000b58  2100              MOVS     r1,#0                 ;1333
000b5a  4608              MOV      r0,r1                 ;1333
000b5c  f7fffffe          BL       tree_down
                  |L5.2912|
000b60  4989              LDR      r1,|L5.3464|
000b62  f8a1b000          STRH     r11,[r1,#0]           ;1335
000b66  f9b41000          LDRSH    r1,[r4,#0]  ; viz_stat_cnt
000b6a  fb91f0f5          SDIV     r0,r1,r5
;;;1337   		if(viz_stat_cnt%50==49)
000b6e  fb051110          MLS      r1,r5,r0,r1
000b72  eb000280          ADD      r2,r0,r0,LSL #2       ;1336
000b76  803a              STRH     r2,[r7,#0]            ;1336
000b78  2931              CMP      r1,#0x31
000b7a  d109              BNE      |L5.2960|
;;;1338   			{
;;;1339   			lc640_write_int(SEKTOR_KURVE_U+((viz_stat_cnt/50)*2),load_U);
000b7c  f44f71fa          MOV      r1,#0x1f4
000b80  eb010040          ADD      r0,r1,r0,LSL #1
000b84  4981              LDR      r1,|L5.3468|
000b86  b200              SXTH     r0,r0
000b88  f9b11000          LDRSH    r1,[r1,#0]  ; load_U
000b8c  f7fffffe          BL       lc640_write_int
                  |L5.2960|
;;;1340   			}
;;;1341   		}
;;;1342   	}
;;;1343   
;;;1344   if(ind==iK_viz_i)
000b90  f8990000          LDRB     r0,[r9,#0]  ; a_ind
000b94  2844              CMP      r0,#0x44
000b96  d12c              BNE      |L5.3058|
;;;1345   	{
;;;1346   	if(viz_stat==vsON)
000b98  7830              LDRB     r0,[r6,#0]  ; viz_stat
000b9a  2801              CMP      r0,#1
000b9c  d129              BNE      |L5.3058|
;;;1347   		{
;;;1348   		viz_stat_cnt++;
000b9e  8820              LDRH     r0,[r4,#0]  ; viz_stat_cnt
000ba0  1c40              ADDS     r0,r0,#1
000ba2  b200              SXTH     r0,r0
000ba4  8020              STRH     r0,[r4,#0]
;;;1349   		if(viz_stat_cnt>=10221)
000ba6  4540              CMP      r0,r8
000ba8  db09              BLT      |L5.3006|
;;;1350   			{
;;;1351   			viz_stat=vsOFF;
000baa  f886a000          STRB     r10,[r6,#0]
;;;1352   			lc640_write_int(EE_I_CURVE_IS_ON,0xabcd);
000bae  4975              LDR      r1,|L5.3460|
000bb0  20ae              MOVS     r0,#0xae
000bb2  f7fffffe          BL       lc640_write_int
;;;1353   			//ind=iK_viz_sel;
;;;1354   			tree_down(0,0);
000bb6  2100              MOVS     r1,#0
000bb8  4608              MOV      r0,r1
000bba  f7fffffe          BL       tree_down
                  |L5.3006|
;;;1355   			}
;;;1356   		tst_pwm_u=1022;
000bbe  f8a7b000          STRH     r11,[r7,#0]
;;;1357   		tst_pwm_i=(viz_stat_cnt/50)*5;
000bc2  f9b41000          LDRSH    r1,[r4,#0]  ; viz_stat_cnt
000bc6  4b70              LDR      r3,|L5.3464|
000bc8  fb91f0f5          SDIV     r0,r1,r5
;;;1358   		if(viz_stat_cnt%50==49)
000bcc  fb051110          MLS      r1,r5,r0,r1
000bd0  eb000280          ADD      r2,r0,r0,LSL #2       ;1357
000bd4  801a              STRH     r2,[r3,#0]            ;1357
000bd6  2931              CMP      r1,#0x31
000bd8  d10b              BNE      |L5.3058|
;;;1359   			{
;;;1360   			lc640_write_int(SEKTOR_KURVE_I+((viz_stat_cnt/50)*2),load_I);
000bda  f44f717a          MOV      r1,#0x3e8
000bde  eb010040          ADD      r0,r1,r0,LSL #1
000be2  496b              LDR      r1,|L5.3472|
000be4  b200              SXTH     r0,r0
000be6  f9b11000          LDRSH    r1,[r1,#0]  ; load_I
000bea  e8bd5ff0          POP      {r4-r12,lr}
000bee  f7ffbffe          B.W      lc640_write_int
                  |L5.3058|
;;;1361   			}
;;;1362   		}
;;;1363   	}
;;;1364   }
000bf2  e5f0              B        |L5.2006|
;;;1365   
                          ENDP

                  bps_hndl PROC
;;;1368   //-----------------------------------------------
;;;1369   void bps_hndl(void) /*ГЦ, 10 раз в секунду*/
000bf4  e92d5ffc          PUSH     {r2-r12,lr}
;;;1370   {
;;;1371   char /*ptr__,*/i;
;;;1372   
;;;1373   if((REV_IS_ON)&&(AVT_REV_IS_ON)) {
000bf8  484e              LDR      r0,|L5.3380|
;;;1374   	if(work_stat==wsGS) {
000bfa  f8df9124          LDR      r9,|L5.3360|
000bfe  8800              LDRH     r0,[r0,#0]            ;1373  ; REV_IS_ON
000c00  b338              CBZ      r0,|L5.3154|
000c02  484d              LDR      r0,|L5.3384|
000c04  8800              LDRH     r0,[r0,#0]            ;1373  ; AVT_REV_IS_ON
000c06  b320              CBZ      r0,|L5.3154|
;;;1375   		if(REV_STAT==rsFF) 	I_ug_temp=AVT_REV_I_NOM_FF;
000c08  4862              LDR      r0,|L5.3476|
000c0a  f8993000          LDRB     r3,[r9,#0]            ;1374  ; work_stat
000c0e  f9b02000          LDRSH    r2,[r0,#0]
000c12  484c              LDR      r0,|L5.3396|
000c14  2b01              CMP      r3,#1                 ;1374
000c16  7800              LDRB     r0,[r0,#0]
000c18  d007              BEQ      |L5.3114|
;;;1376   		else if (REV_STAT==rsREW) I_ug_temp=AVT_REV_I_NOM_REW;
;;;1377   	} else if (work_stat==wsPS) {
;;;1378   		if(REV_STAT==rsFF) 	U_up_temp=AVT_REV_U_NOM_FF;
000c1a  495f              LDR      r1,|L5.3480|
000c1c  2b02              CMP      r3,#2                 ;1377
000c1e  f9b11000          LDRSH    r1,[r1,#0]
000c22  d00d              BEQ      |L5.3136|
;;;1379   		else if (REV_STAT==rsREW) U_up_temp=AVT_REV_U_NOM_REW;
;;;1380   	} else {
;;;1381   		U_up_temp=AVT_REV_U_NOM_FF;
000c24  485d              LDR      r0,|L5.3484|
000c26  8001              STRH     r1,[r0,#0]
;;;1382   		I_ug_temp=AVT_REV_I_NOM_FF;
000c28  e003              B        |L5.3122|
                  |L5.3114|
000c2a  2801              CMP      r0,#1                 ;1375
000c2c  d001              BEQ      |L5.3122|
000c2e  b118              CBZ      r0,|L5.3128|
000c30  e025              B        |L5.3198|
                  |L5.3122|
000c32  485b              LDR      r0,|L5.3488|
000c34  8002              STRH     r2,[r0,#0]            ;1375
000c36  e022              B        |L5.3198|
                  |L5.3128|
000c38  485a              LDR      r0,|L5.3492|
000c3a  4959              LDR      r1,|L5.3488|
000c3c  8800              LDRH     r0,[r0,#0]            ;1376  ; AVT_REV_I_NOM_REW
000c3e  e01d              B        |L5.3196|
                  |L5.3136|
000c40  2801              CMP      r0,#1                 ;1378
000c42  d001              BEQ      |L5.3144|
000c44  b118              CBZ      r0,|L5.3150|
000c46  e01a              B        |L5.3198|
                  |L5.3144|
000c48  4854              LDR      r0,|L5.3484|
000c4a  8001              STRH     r1,[r0,#0]            ;1378
000c4c  e017              B        |L5.3198|
                  |L5.3150|
000c4e  4856              LDR      r0,|L5.3496|
000c50  e0d1              B        |L5.3574|
                  |L5.3154|
;;;1383   	}
;;;1384   } else {
;;;1385   
;;;1386   if(fiks_stat_I==2)I_ug_temp=I_ug3;
000c52  4856              LDR      r0,|L5.3500|
000c54  f9b00000          LDRSH    r0,[r0,#0]  ; fiks_stat_I
000c58  2802              CMP      r0,#2
000c5a  d05d              BEQ      |L5.3352|
;;;1387   else if(fiks_stat_I==1)I_ug_temp=I_ug2;
000c5c  2801              CMP      r0,#1
000c5e  d05c              BEQ      |L5.3354|
;;;1388   else I_ug_temp=I_ug;
000c60  4853              LDR      r0,|L5.3504|
                  |L5.3170|
000c62  8801              LDRH     r1,[r0,#0]            ;1387  ; I_ug2
000c64  484e              LDR      r0,|L5.3488|
000c66  8001              STRH     r1,[r0,#0]            ;1387
;;;1389   
;;;1390   if(fiks_stat_U==2)U_up_temp=U_up3;
000c68  4852              LDR      r0,|L5.3508|
000c6a  f9b00000          LDRSH    r0,[r0,#0]  ; fiks_stat_U
000c6e  2802              CMP      r0,#2
000c70  d054              BEQ      |L5.3356|
;;;1391   	else if(fiks_stat_U==1)U_up_temp=U_up2;
000c72  2801              CMP      r0,#1
000c74  d053              BEQ      |L5.3358|
;;;1392   	else U_up_temp=U_up;
000c76  4850              LDR      r0,|L5.3512|
                  |L5.3192|
000c78  4948              LDR      r1,|L5.3484|
000c7a  8800              LDRH     r0,[r0,#0]            ;1391  ; U_up2
                  |L5.3196|
000c7c  8008              STRH     r0,[r1,#0]            ;1391
                  |L5.3198|
;;;1393   
;;;1394   }
;;;1395   	
;;;1396   gran(&I_ug_temp,0/*I_MIN_IPS*/,I_MAX_IPS);
000c7e  484f              LDR      r0,|L5.3516|
000c80  2100              MOVS     r1,#0
000c82  f9b02000          LDRSH    r2,[r0,#0]  ; I_MAX_IPS
000c86  4846              LDR      r0,|L5.3488|
000c88  f7fffffe          BL       gran
;;;1397   gran(&U_up_temp,0/*U_MIN*/,U_MAX);
000c8c  484c              LDR      r0,|L5.3520|
000c8e  2100              MOVS     r1,#0
000c90  f9b02000          LDRSH    r2,[r0,#0]  ; U_MAX
000c94  4841              LDR      r0,|L5.3484|
000c96  f7fffffe          BL       gran
;;;1398   
;;;1399   if(sh_cnt0<10) {
000c9a  4f25              LDR      r7,|L5.3376|
000c9c  2601              MOVS     r6,#1                 ;1374
000c9e  2500              MOVS     r5,#0                 ;1373
000ca0  7978              LDRB     r0,[r7,#5]  ; sh_cnt0
000ca2  280a              CMP      r0,#0xa
000ca4  d210              BCS      |L5.3272|
;;;1400   	sh_cnt0++;
000ca6  1c40              ADDS     r0,r0,#1
000ca8  b2c0              UXTB     r0,r0
000caa  7178              STRB     r0,[r7,#5]
;;;1401   	if(sh_cnt0>=10) {
000cac  280a              CMP      r0,#0xa
000cae  d30b              BCC      |L5.3272|
;;;1402   		sh_cnt0=0;
000cb0  717d              STRB     r5,[r7,#5]
;;;1403   		b1Hz_sh=1;
000cb2  71be              STRB     r6,[r7,#6]
;;;1404   		if(sh_cnt1<5) {
000cb4  79f8              LDRB     r0,[r7,#7]  ; sh_cnt1
000cb6  2805              CMP      r0,#5
000cb8  d206              BCS      |L5.3272|
;;;1405   			sh_cnt1++;
000cba  1c40              ADDS     r0,r0,#1
000cbc  b2c0              UXTB     r0,r0
000cbe  71f8              STRB     r0,[r7,#7]
;;;1406   			if(sh_cnt1>=5) {
000cc0  2805              CMP      r0,#5
000cc2  d301              BCC      |L5.3272|
;;;1407   			 	sh_cnt1=0;
000cc4  71fd              STRB     r5,[r7,#7]
;;;1408   				bPRECESSION_REG=1;
000cc6  72fe              STRB     r6,[r7,#0xb]
                  |L5.3272|
;;;1409   			}
;;;1410   		}
;;;1411   	}
;;;1412   }
;;;1413   
;;;1414   if(ind==iK_load)
000cc8  492a              LDR      r1,|L5.3444|
;;;1415   	{
;;;1416   	if(sub_ind==0)
;;;1417   		{
;;;1418   		cntrl_stat_U=1022;
;;;1419   		cntrl_stat_I=1022;
;;;1420   		bps_stat=stON;
000cca  483e              LDR      r0,|L5.3524|
;;;1421   
;;;1422   		for(i=0;i<NUMIST;i++)
;;;1423   			{
;;;1424   			bps[i]._vol_u=1022;
;;;1425   			bps[i]._vol_i=1022;
;;;1426   			bps[i]._flags_tu=0;
;;;1427   			}
;;;1428   		}
;;;1429   	else if(sub_ind==1)
;;;1430   		{
;;;1431   		if(phase==0)
000ccc  4a3e              LDR      r2,|L5.3528|
000cce  780b              LDRB     r3,[r1,#0]            ;1414  ; a_ind
000cd0  4c3e              LDR      r4,|L5.3532|
000cd2  f8df80fc          LDR      r8,|L5.3536|
000cd6  f2403afe          MOV      r10,#0x3fe            ;1418
000cda  2b30              CMP      r3,#0x30              ;1414
000cdc  d07e              BEQ      |L5.3548|
;;;1432   			{
;;;1433     			cntrl_stat_U=0;
;;;1434   			cntrl_stat_I=0;
;;;1435   			bps_stat=stOFF;
;;;1436   
;;;1437   			for(i=0;i<NUMIST;i++)
;;;1438   				{
;;;1439   				bps[i]._vol_u=0;
;;;1440   				bps[i]._vol_i=0;
;;;1441   				bps[i]._flags_tu=1;
;;;1442   				}
;;;1443   			}
;;;1444   		else if(phase==1)
;;;1445   			{
;;;1446     			cntrl_stat_U=1022;
;;;1447   			cntrl_stat_I=1022;
;;;1448   			bps_stat=stON;
;;;1449   
;;;1450   			for(i=0;i<NUMIST;i++)
;;;1451   				{
;;;1452   				bps[i]._vol_u=1022;
;;;1453   				bps[i]._vol_i=1022;
;;;1454   				bps[i]._flags_tu=0;
;;;1455   				}
;;;1456   			}
;;;1457   		}
;;;1458   	else 
;;;1459   		{
;;;1460   		bps_stat=stOFF;
;;;1461   
;;;1462   		bps[0]._vol_u=0;
;;;1463   		bps[0]._vol_i=0;
;;;1464   		bps[0]._flags_tu=1;
;;;1465   		}
;;;1466   	}
;;;1467   else if(ind==iK_bps)
000cde  2b2b              CMP      r3,#0x2b
000ce0  d07d              BEQ      |L5.3550|
;;;1468   	{
;;;1469   	if(sub_ind==0)
;;;1470   		{
;;;1471   		cntrl_stat_U=1022;
;;;1472   		cntrl_stat_I=1022;
;;;1473   		bps_stat=stON;
;;;1474   
;;;1475   		bps[0]._vol_u=0;
;;;1476   		bps[0]._vol_i=0;
;;;1477   		bps[0]._flags_tu=1;
;;;1478   
;;;1479   		bps[1]._vol_u=0;
;;;1480   		bps[1]._vol_i=0;
;;;1481   		bps[1]._flags_tu=1;
;;;1482   
;;;1483   		bps[1]._vol_u=0;
;;;1484   		bps[1]._vol_i=0;
;;;1485   		bps[1]._flags_tu=1;
;;;1486   
;;;1487   		bps[2]._vol_u=0;
;;;1488   		bps[2]._vol_i=0;
;;;1489   		bps[2]._flags_tu=1;
;;;1490   
;;;1491   		bps[3]._vol_u=0;
;;;1492   		bps[3]._vol_i=0;
;;;1493   		bps[3]._flags_tu=1;
;;;1494   
;;;1495   		bps[4]._vol_u=0;
;;;1496   		bps[4]._vol_i=0;
;;;1497   		bps[4]._flags_tu=1;
;;;1498   
;;;1499   		bps[5]._vol_u=0;
;;;1500   		bps[5]._vol_i=0;
;;;1501   		bps[5]._flags_tu=1;
;;;1502   
;;;1503   		bps[6]._vol_u=0;
;;;1504   		bps[6]._vol_i=0;
;;;1505   		bps[6]._flags_tu=1;
;;;1506   
;;;1507   		bps[7]._vol_u=0;
;;;1508   		bps[7]._vol_i=0;
;;;1509   		bps[7]._flags_tu=1;
;;;1510   
;;;1511   		bps[8]._vol_u=0;
;;;1512   		bps[8]._vol_i=0;
;;;1513   		bps[8]._flags_tu=1;
;;;1514   		
;;;1515   		bps[9]._vol_u=0;
;;;1516   		bps[9]._vol_i=0;
;;;1517   		bps[9]._flags_tu=1;
;;;1518   
;;;1519   		bps[10]._vol_u=0;
;;;1520   		bps[10]._vol_i=0;
;;;1521   		bps[10]._flags_tu=1;
;;;1522   
;;;1523   		bps[11]._vol_u=0;
;;;1524   		bps[11]._vol_i=0;
;;;1525   		bps[11]._flags_tu=1;
;;;1526    		
;;;1527   		bps[sub_ind1]._vol_u=1022;
;;;1528   		bps[sub_ind1]._vol_i=1022;
;;;1529   		bps[sub_ind1]._flags_tu=0;
;;;1530   		}
;;;1531   
;;;1532   	else if(sub_ind==3)
;;;1533   		{
;;;1534   		if(phase==0)
;;;1535   			{
;;;1536     			cntrl_stat_U=0;
;;;1537   			cntrl_stat_I=0;
;;;1538   			bps_stat=stOFF;
;;;1539   			bps[0]._vol_u=0;
;;;1540   			bps[0]._vol_i=0;
;;;1541   			bps[0]._flags_tu=1;
;;;1542   	
;;;1543   			bps[1]._vol_u=0;
;;;1544   			bps[1]._vol_i=0;
;;;1545   			bps[1]._flags_tu=1;
;;;1546   	
;;;1547   			bps[1]._vol_u=0;
;;;1548   			bps[1]._vol_i=0;
;;;1549   			bps[1]._flags_tu=1;
;;;1550   	
;;;1551   			bps[2]._vol_u=0;
;;;1552   			bps[2]._vol_i=0;
;;;1553   			bps[2]._flags_tu=1;
;;;1554   	
;;;1555   			bps[3]._vol_u=0;
;;;1556   			bps[3]._vol_i=0;
;;;1557   			bps[3]._flags_tu=1;
;;;1558   	
;;;1559   			bps[4]._vol_u=0;
;;;1560   			bps[4]._vol_i=0;
;;;1561   			bps[4]._flags_tu=1;
;;;1562   	
;;;1563   			bps[5]._vol_u=0;
;;;1564   			bps[5]._vol_i=0;
;;;1565   			bps[5]._flags_tu=1;
;;;1566   	
;;;1567   			bps[6]._vol_u=0;
;;;1568   			bps[6]._vol_i=0;
;;;1569   			bps[6]._flags_tu=1;
;;;1570   	
;;;1571   			bps[7]._vol_u=0;
;;;1572   			bps[7]._vol_i=0;
;;;1573   			bps[7]._flags_tu=1;
;;;1574   	
;;;1575   			bps[8]._vol_u=0;
;;;1576   			bps[8]._vol_i=0;
;;;1577   			bps[8]._flags_tu=1;
;;;1578   			
;;;1579   			bps[9]._vol_u=0;
;;;1580   			bps[9]._vol_i=0;
;;;1581   			bps[9]._flags_tu=1;
;;;1582   	
;;;1583   			bps[10]._vol_u=0;
;;;1584   			bps[10]._vol_i=0;
;;;1585   			bps[10]._flags_tu=1;
;;;1586   	
;;;1587   			bps[11]._vol_u=0;
;;;1588   			bps[11]._vol_i=0;
;;;1589   			bps[11]._flags_tu=1;
;;;1590   
;;;1591   			}
;;;1592   		else if(phase==1)
;;;1593   			{
;;;1594     			cntrl_stat_U=1022;
;;;1595   			cntrl_stat_I=1022;
;;;1596   			bps_stat=stON;
;;;1597   
;;;1598   			bps[0]._vol_u=0;
;;;1599   			bps[0]._vol_i=0;
;;;1600   			bps[0]._flags_tu=1;
;;;1601   	
;;;1602   			bps[1]._vol_u=0;
;;;1603   			bps[1]._vol_i=0;
;;;1604   			bps[1]._flags_tu=1;
;;;1605   	
;;;1606   			bps[1]._vol_u=0;
;;;1607   			bps[1]._vol_i=0;
;;;1608   			bps[1]._flags_tu=1;
;;;1609   	
;;;1610   			bps[2]._vol_u=0;
;;;1611   			bps[2]._vol_i=0;
;;;1612   			bps[2]._flags_tu=1;
;;;1613   	
;;;1614   			bps[3]._vol_u=0;
;;;1615   			bps[3]._vol_i=0;
;;;1616   			bps[3]._flags_tu=1;
;;;1617   	
;;;1618   			bps[4]._vol_u=0;
;;;1619   			bps[4]._vol_i=0;
;;;1620   			bps[4]._flags_tu=1;
;;;1621   	
;;;1622   			bps[5]._vol_u=0;
;;;1623   			bps[5]._vol_i=0;
;;;1624   			bps[5]._flags_tu=1;
;;;1625   	
;;;1626   			bps[6]._vol_u=0;
;;;1627   			bps[6]._vol_i=0;
;;;1628   			bps[6]._flags_tu=1;
;;;1629   	
;;;1630   			bps[7]._vol_u=0;
;;;1631   			bps[7]._vol_i=0;
;;;1632   			bps[7]._flags_tu=1;
;;;1633   	
;;;1634   			bps[8]._vol_u=0;
;;;1635   			bps[8]._vol_i=0;
;;;1636   			bps[8]._flags_tu=1;
;;;1637   			
;;;1638   			bps[9]._vol_u=0;
;;;1639   			bps[9]._vol_i=0;
;;;1640   			bps[9]._flags_tu=1;
;;;1641   	
;;;1642   			bps[10]._vol_u=0;
;;;1643   			bps[10]._vol_i=0;
;;;1644   			bps[10]._flags_tu=1;
;;;1645   	
;;;1646   			bps[11]._vol_u=0;
;;;1647   			bps[11]._vol_i=0;
;;;1648   			bps[11]._flags_tu=1;
;;;1649   
;;;1650   
;;;1651   
;;;1652   			bps[sub_ind1]._vol_u=1022;
;;;1653   			bps[sub_ind1]._vol_i=1022;
;;;1654   			bps[sub_ind1]._flags_tu=0;
;;;1655   			}
;;;1656   		}
;;;1657   	else 
;;;1658   		{
;;;1659   		bps_stat=stOFF;
;;;1660   
;;;1661   		bps[0]._vol_u=0;
;;;1662   		bps[0]._vol_i=0;
;;;1663   		bps[0]._flags_tu=1;
;;;1664   
;;;1665   		bps[1]._vol_u=0;
;;;1666   		bps[1]._vol_i=0;
;;;1667   		bps[1]._flags_tu=1;
;;;1668   
;;;1669   		bps[1]._vol_u=0;
;;;1670   		bps[1]._vol_i=0;
;;;1671   		bps[1]._flags_tu=1;
;;;1672   
;;;1673   		bps[2]._vol_u=0;
;;;1674   		bps[2]._vol_i=0;
;;;1675   		bps[2]._flags_tu=1;
;;;1676   
;;;1677   		bps[3]._vol_u=0;
;;;1678   		bps[3]._vol_i=0;
;;;1679   		bps[3]._flags_tu=1;
;;;1680   
;;;1681   		bps[4]._vol_u=0;
;;;1682   		bps[4]._vol_i=0;
;;;1683   		bps[4]._flags_tu=1;
;;;1684   
;;;1685   		bps[5]._vol_u=0;
;;;1686   		bps[5]._vol_i=0;
;;;1687   		bps[5]._flags_tu=1;
;;;1688   
;;;1689   		bps[6]._vol_u=0;
;;;1690   		bps[6]._vol_i=0;
;;;1691   		bps[6]._flags_tu=1;
;;;1692   
;;;1693   		bps[7]._vol_u=0;
;;;1694   		bps[7]._vol_i=0;
;;;1695   		bps[7]._flags_tu=1;
;;;1696   
;;;1697   		bps[8]._vol_u=0;
;;;1698   		bps[8]._vol_i=0;
;;;1699   		bps[8]._flags_tu=1;
;;;1700   		
;;;1701   		bps[9]._vol_u=0;
;;;1702   		bps[9]._vol_i=0;
;;;1703   		bps[9]._flags_tu=1;
;;;1704   
;;;1705   		bps[10]._vol_u=0;
;;;1706   		bps[10]._vol_i=0;
;;;1707   		bps[10]._flags_tu=1;
;;;1708   
;;;1709   		bps[11]._vol_u=0;
;;;1710   		bps[11]._vol_i=0;
;;;1711   		bps[11]._flags_tu=1;
;;;1712   
;;;1713   		}
;;;1714   	}
;;;1715   
;;;1716   else if(ind==iTst_pwm)
;;;1717   	{
;;;1718   	char i;
;;;1719   
;;;1720   	for(i=0;i<NUMIST;i++)
;;;1721   		{
;;;1722   		bps[i]._vol_u=tst_pwm_u;
000ce2  4925              LDR      r1,|L5.3448|
;;;1723   		bps[i]._vol_i=tst_pwm_i;
000ce4  4a28              LDR      r2,|L5.3464|
000ce6  2b33              CMP      r3,#0x33              ;1716
000ce8  d07a              BEQ      |L5.3552|
;;;1724   		bps[i]._flags_tu=0;
;;;1725   		}
;;;1726   	}
;;;1727   
;;;1728   else if(ind==iK_viz_u)
;;;1729   	{
;;;1730   	char i;
;;;1731   
;;;1732   	if(viz_stat!=vsON)
000cea  f8dfc090          LDR      r12,|L5.3452|
000cee  2b45              CMP      r3,#0x45              ;1728
000cf0  d077              BEQ      |L5.3554|
;;;1733   		{
;;;1734   		for(i=0;i<NUMIST;i++)
;;;1735   			{
;;;1736   			bps[i]._vol_u=1022;
;;;1737   			bps[i]._vol_i=1022;
;;;1738   			bps[i]._flags_tu=0;
;;;1739   			}
;;;1740   		}
;;;1741   	else 
;;;1742   		{
;;;1743   		for(i=0;i<NUMIST;i++)
;;;1744   			{
;;;1745   			bps[i]._vol_u=tst_pwm_u;
;;;1746   			bps[i]._vol_i=tst_pwm_i;
;;;1747   			bps[i]._flags_tu=0;
;;;1748   			}
;;;1749   		}
;;;1750   	}
;;;1751   
;;;1752   else if(ind==iK_viz_i)
000cf2  2b44              CMP      r3,#0x44
000cf4  d076              BEQ      |L5.3556|
;;;1753   	{
;;;1754   	char i;
;;;1755   
;;;1756   	if(viz_stat!=vsON)
;;;1757   		{
;;;1758   		for(i=0;i<NUMIST;i++)
;;;1759   			{
;;;1760   			bps[i]._vol_u=1022;
;;;1761   			bps[i]._vol_i=1022;
;;;1762   			bps[i]._flags_tu=0;
;;;1763   			}
;;;1764   		}
;;;1765   	else 
;;;1766   		{
;;;1767   		for(i=0;i<NUMIST;i++)
;;;1768   			{
;;;1769   			bps[i]._vol_u=tst_pwm_u;
;;;1770   			bps[i]._vol_i=tst_pwm_i;
;;;1771   			bps[i]._flags_tu=0;
;;;1772   			}
;;;1773   		}
;;;1774   	}
;;;1775   
;;;1776   else if(work_stat==wsGS)
000cf6  f8991000          LDRB     r1,[r9,#0]  ; work_stat
;;;1777   	{
;;;1778   	signed long temp_SL_U,temp_SL_I;
;;;1779   	
;;;1780   	if((CURR_FADE_IN) && (time_proc<CURR_FADE_IN))
;;;1781   		{
;;;1782   		signed long temp_SL_;
;;;1783   		
;;;1784   		temp_SL_=	(signed long)I_ug_temp;
;;;1785   		temp_SL_*= (signed long)time_proc;
;;;1786   		temp_SL_/= (signed long)CURR_FADE_IN;
;;;1787   
;;;1788   		//I_ug_temp= (signed short)((signed long)I_ug_temp*(signed long)time_proc)/(signed long)CURR_FADE_IN;
;;;1789   
;;;1790   		I_ug_temp= (signed short)temp_SL_;
;;;1791   		}	
;;;1792   	
;;;1793   	if(b1Hz_sh) {
;;;1794   
;;;1795   
;;;1796   
;;;1797   
;;;1798   		if(!((REV_IS_ON)&&(AVT_REV_IS_ON)&&((proc_phase==ppFF_P_REW)||(proc_phase==ppREW_P_FF)))) {
;;;1799   	 		if(load_I<I_ug_temp)_x_++;
;;;1800      			else if(load_I>I_ug_temp)_x_--;
;;;1801   			//gran(&_x_,-temp_SL_I,1022-temp_SL_I);
;;;1802   			gran(&_x_,-50,50); 
;;;1803   
;;;1804   	 		if(load_U<U_maxg)_xu_++;
000cfa  f8df90d8          LDR      r9,|L5.3540|
000cfe  f8dfb0d8          LDR      r11,|L5.3544|
000d02  2901              CMP      r1,#1                 ;1776
000d04  d06f              BEQ      |L5.3558|
;;;1805      			else if(load_U>U_maxg)_xu_--;
;;;1806   			//gran(&_x_,-temp_SL_U,1022-temp_SL_U);
;;;1807   			gran(&_xu_,-50,50); 
;;;1808   		}
;;;1809   	}
;;;1810   
;;;1811   	temp_SL_U=1022;
;;;1812   	temp_SL_U*=(signed long)U_maxg;
;;;1813   	temp_SL_U/=(signed long)U_MAX;
;;;1814   
;;;1815   	temp_SL_I=1022;
;;;1816   	//temp_SL_I*=NUMIST;
;;;1817   	temp_SL_I*=(signed long)I_ug_temp;
;;;1818   	temp_SL_I/=(signed long)I_MAX_IPS;
;;;1819   
;;;1820   	if(lc640_read_int(EE_U_CURVE_IS_ON)==0xabcd)
;;;1821   		{
;;;1822   		temp_SL_U=find_U_curve(U_maxg)*5;
;;;1823   		}
;;;1824   	 
;;;1825   	if(lc640_read_int(EE_I_CURVE_IS_ON)==0xabcd)
;;;1826   		{
;;;1827   		temp_SL_I=find_I_curve(I_ug_temp)*5;
;;;1828   		}
;;;1829   
;;;1830   	for(i=0;i<NUMIST;i++)
;;;1831   		{
;;;1832   		if((REV_IS_ON)&&(AVT_REV_IS_ON)&&((proc_phase==ppFF_P_REW)||(proc_phase==ppREW_P_FF))) {
;;;1833   		 	bps[i]._vol_u=0;
;;;1834   			bps[i]._vol_i=0;
;;;1835   			bps[i]._flags_tu=1;
;;;1836   		} else {
;;;1837   			bps[i]._vol_u=(short)temp_SL_U + _xu_/*+bps[i]._xu_*/;
;;;1838   			if(bps[i]._vol_u<0)bps[i]._vol_u=0;
;;;1839   			if(bps[i]._vol_u>1022)bps[i]._vol_u=1022;
;;;1840   			bps[i]._vol_i=((short)temp_SL_I + _x_);///NUMIST;
;;;1841   			if(bps[i]._vol_i<0)bps[i]._vol_i=0;
;;;1842   			if(bps[i]._vol_i>1022)bps[i]._vol_i=1022;
;;;1843   			bps[i]._flags_tu=0;
;;;1844   		}
;;;1845   	}
;;;1846   
;;;1847   	}
;;;1848   else if(work_stat==wsPS)
000d06  2902              CMP      r1,#2
000d08  d06e              BEQ      |L5.3560|
;;;1849   	{
;;;1850   	signed long temp_SL_U,temp_SL_I;
;;;1851   	/*	U_up_d=U_up/100;
;;;1852   	if(U_up_d<5) U_up_d=5;
;;;1853   	*/
;;;1854   	if(load_U_>5)bU_VALID=1;
;;;1855   	else bU_VALID=0;
;;;1856   
;;;1857   	temp_SL_U=(long)U_up_temp/100L;
;;;1858   	if(temp_SL_U<=0)temp_SL_U=1;
;;;1859   	if((abs(load_U_-U_up_temp))<(signed short)temp_SL_U) bU_VALID_VALID=1;
;;;1860   	else bU_VALID_VALID=0;
;;;1861   /*	if( (load_U_>(U_up-U_up_d))&&(load_U_<(U_up+U_up_d)) )bFAST_REG=0;
;;;1862   	else bFAST_REG=1;*/
;;;1863   
;;;1864   	bFAST_REG=0;
;;;1865   
;;;1866   	if(bU_VALID_VALID)
;;;1867   		{
;;;1868   		if(bPRECESSION_REG)
;;;1869   			{
;;;1870   			bPRECESSION_REG=0;
;;;1871   			if(load_U_<U_up_temp)_xu_++;
;;;1872      			else if(load_U_>U_up_temp)_xu_--;
;;;1873   			gran(&_xu_,-50,50);
;;;1874   			}
;;;1875   		}
;;;1876   	else if((b1Hz_sh&&bU_VALID)||(bFAST_REG&&bU_VALID))
;;;1877   		{
;;;1878   	 	if(load_I<I_maxp)_x_++;
;;;1879      		else if(load_I>I_maxp)_x_--;
;;;1880   		gran(&_x_,-50,50); 
;;;1881   
;;;1882   	 	if(load_U_<U_up_temp)_xu_++;
;;;1883      		else if(load_U_>U_up_temp)_xu_--;
;;;1884   		gran(&_xu_,-50,50); 
;;;1885   
;;;1886   		}
;;;1887   
;;;1888   
;;;1889   	temp_SL_U=900;
;;;1890   	temp_SL_U*=(signed long)U_up_temp;
;;;1891   	temp_SL_U/=(signed long)U_MAX;
;;;1892   	temp_SL_U+=50;
;;;1893   
;;;1894   	if(lc640_read_int(EE_U_CURVE_IS_ON)==0xabcd)
;;;1895   		{	
;;;1896   		temp_SL_U=find_U_curve(U_up_temp)*5;
;;;1897   		}
;;;1898   	//temp_SL_U=lc640_read_int(SEKTOR_KURVE_U+(temp_SL_U*2));
;;;1899   	 
;;;1900   	temp_SL_I=1022;
;;;1901   	//temp_SL_I*=NUMIST;
;;;1902   	temp_SL_I*=(signed long)I_maxp;
;;;1903   	temp_SL_I/=(signed long)I_MAX_IPS;
;;;1904   
;;;1905   	if(lc640_read_int(EE_I_CURVE_IS_ON)==0xabcd)
;;;1906   		{
;;;1907   		temp_SL_I=find_I_curve(I_maxp)*5;
;;;1908   		}
;;;1909   
;;;1910   	for(i=0;i<NUMIST;i++) {
;;;1911   
;;;1912   		if((REV_IS_ON)&&(AVT_REV_IS_ON)&&((proc_phase==ppFF_P_REW)||(proc_phase==ppREW_P_FF))) {
;;;1913   		 	bps[i]._vol_u=0;
;;;1914   			bps[i]._vol_i=0;
;;;1915   			bps[i]._flags_tu=1;
;;;1916   		} else {
;;;1917   			bps[i]._vol_u=(short)temp_SL_U + _xu_+bps[i]._xu_;
;;;1918   			if(bps[i]._vol_u<0)bps[i]._vol_u=0;
;;;1919   			if(bps[i]._vol_u>1022)bps[i]._vol_u=1022;
;;;1920   			bps[i]._vol_i=((short)temp_SL_I + _x_);///NUMIST;
;;;1921   			if(bps[i]._vol_i<0)bps[i]._vol_i=0;
;;;1922   			if(bps[i]._vol_i>1022)bps[i]._vol_i=1022;
;;;1923   			bps[i]._flags_tu=0;
;;;1924   		}
;;;1925   	}
;;;1926   
;;;1927   
;;;1928   /*	for(i=0;i<NUMIST;i++)
;;;1929   		{
;;;1930   		bps[i]._vol_u=(short)temp_SL_U + _xu_;
;;;1931   	 	bps[i]._vol_i=((short)temp_SL_I+ _x_);//NUMIST;
;;;1932   		bps[i]._flags_tu=0;
;;;1933   		}*/
;;;1934   	//bps[0]._vol_i+= _x_;
;;;1935   	plazma_vol_u_0=temp_SL_U;
;;;1936   	plazma_vol_u_1=bps[0]._vol_u;
;;;1937   	}
;;;1938   
;;;1939   else if(work_stat==wsCAP)
000d0a  2903              CMP      r1,#3
000d0c  d06d              BEQ      |L5.3562|
;;;1940   	{
;;;1941   	signed long temp_SL_U=0,temp_SL_I=0;
;;;1942   
;;;1943   
;;;1944   
;;;1945   
;;;1946   
;;;1947   
;;;1948   	if(b1Hz_sh) {
;;;1949   		if(!bOFF) {
;;;1950   	 		if(load_I<(CAP_WRK_CURR*10))_x_++;
;;;1951      			else if(load_I>(CAP_WRK_CURR*10))_x_--;
;;;1952   			gran(&_x_,-temp_SL_I,1022-temp_SL_I);
;;;1953   			gran(&_x_,-50,50); 
;;;1954   
;;;1955   	 		if(load_U<(CAP_MAX_VOLT*10))_xu_++;
;;;1956      			else if(load_U>(CAP_MAX_VOLT*10))_xu_--;
;;;1957   			gran(&_x_,-temp_SL_U,1022-temp_SL_U);
;;;1958   			gran(&_xu_,-50,50); 
;;;1959   		}
;;;1960   	}
;;;1961   
;;;1962   	temp_SL_U=10220L;
;;;1963   	temp_SL_U*=(signed long)CAP_MAX_VOLT;
;;;1964   	temp_SL_U/=(signed long)U_MAX;
;;;1965   
;;;1966   	temp_SL_I=10220L;
;;;1967   	//temp_SL_I*=NUMIST;
;;;1968   	temp_SL_I*=(signed long)CAP_WRK_CURR;
;;;1969   	temp_SL_I/=(signed long)I_MAX_IPS;
;;;1970   
;;;1971   	if(lc640_read_int(EE_U_CURVE_IS_ON)==0xabcd)
;;;1972   		{
;;;1973   		temp_SL_U=find_U_curve(CAP_MAX_VOLT*10)*5;
;;;1974   		}
;;;1975   	 
;;;1976   	if(lc640_read_int(EE_I_CURVE_IS_ON)==0xabcd)
;;;1977   		{
;;;1978   		temp_SL_I=find_I_curve(CAP_WRK_CURR*10)*5;
;;;1979   		} 
;;;1980   
;;;1981   //temp_SL_U=1000;
;;;1982   
;;;1983   	for(i=0;i<NUMIST;i++)
;;;1984   		{
;;;1985   		if(bOFF) {
;;;1986   		 	bps[i]._vol_u=0;
;;;1987   			bps[i]._vol_i=0;
;;;1988   			bps[i]._flags_tu=1;
;;;1989   		} else {
;;;1990   			bps[i]._vol_u=(short)temp_SL_U + _xu_;
;;;1991   			if(bps[i]._vol_u<0)bps[i]._vol_u=0;
;;;1992   			if(bps[i]._vol_u>1022)bps[i]._vol_u=1022;
;;;1993   			bps[i]._vol_i=((short)temp_SL_I + _x_);///NUMIST;
;;;1994   			if(bps[i]._vol_i<0)bps[i]._vol_i=0;
;;;1995   			if(bps[i]._vol_i>1022)bps[i]._vol_i=1022;
;;;1996   			bps[i]._flags_tu=0;
;;;1997   		}
;;;1998   	}
;;;1999   
;;;2000   	}
;;;2001   else 
;;;2002   	{
;;;2003   	bps_stat=stOFF;
000d0e  7005              STRB     r5,[r0,#0]
;;;2004   
;;;2005   	for(i=0;i<NUMIST;i++)
000d10  2000              MOVS     r0,#0
000d12  f9b82000          LDRSH    r2,[r8,#0]            ;1422
000d16  e3fe              B        |L5.5398|
                  |L5.3352|
000d18  e068              B        |L5.3564|
                  |L5.3354|
000d1a  e069              B        |L5.3568|
                  |L5.3356|
000d1c  e06a              B        |L5.3572|
                  |L5.3358|
000d1e  e06c              B        |L5.3578|
                  |L5.3360|
                          DCD      work_stat
                  |L5.3364|
                          DCD      time_proc
                  |L5.3368|
                          DCD      T_PROC_GS
                  |L5.3372|
                          DCD      time_proc_remain
                  |L5.3376|
                          DCD      ||area_number.25||
                  |L5.3380|
                          DCD      REV_IS_ON
                  |L5.3384|
                          DCD      AVT_REV_IS_ON
                  |L5.3388|
                          DCD      time_proc_phase
                  |L5.3392|
                          DCD      proc_phase
                  |L5.3396|
                          DCD      REV_STAT
                  |L5.3400|
                          DCD      milliAmperSecunda
                  |L5.3404|
                          DCD      AMPERCHAS
                  |L5.3408|
                          DCD      T_PROC_PS
                  |L5.3412|
                          DCD      ramModbusCnt
                  |L5.3416|
                          DCD      I_ug_ram
                  |L5.3420|
                          DCD      U_up_ram
                  |L5.3424|
                          DCD      cap_time_proc
                  |L5.3428|
                          DCD      CAP_COUNTER
                  |L5.3432|
                          DCD      CAP_TIME_SEC
                  |L5.3436|
                          DCD      CAP_TIME_MIN
                  |L5.3440|
                          DCD      CAP_TIME_HOUR
                  |L5.3444|
                          DCD      a_ind
                  |L5.3448|
                          DCD      tst_pwm_u
                  |L5.3452|
                          DCD      viz_stat
                  |L5.3456|
                          DCD      viz_stat_cnt
                  |L5.3460|
                          DCD      0xffffabcd
                  |L5.3464|
                          DCD      tst_pwm_i
                  |L5.3468|
                          DCD      load_U
                  |L5.3472|
                          DCD      load_I
                  |L5.3476|
                          DCD      AVT_REV_I_NOM_FF
                  |L5.3480|
                          DCD      AVT_REV_U_NOM_FF
                  |L5.3484|
                          DCD      U_up_temp
                  |L5.3488|
                          DCD      I_ug_temp
                  |L5.3492|
                          DCD      AVT_REV_I_NOM_REW
                  |L5.3496|
                          DCD      AVT_REV_U_NOM_REW
                  |L5.3500|
                          DCD      fiks_stat_I
                  |L5.3504|
                          DCD      I_ug
                  |L5.3508|
                          DCD      fiks_stat_U
                  |L5.3512|
                          DCD      U_up
                  |L5.3516|
                          DCD      I_MAX_IPS
                  |L5.3520|
                          DCD      U_MAX
                  |L5.3524|
                          DCD      bps_stat
                  |L5.3528|
                          DCD      phase
                  |L5.3532|
                          DCD      bps
                  |L5.3536|
                          DCD      NUMIST
                  |L5.3540|
                          DCD      _xu_
                  |L5.3544|
                          DCD      _x_
                  |L5.3548|
000ddc  e00f              B        |L5.3582|
                  |L5.3550|
000dde  e068              B        |L5.3762|
                  |L5.3552|
000de0  e115              B        |L5.4110|
                  |L5.3554|
000de2  e12c              B        |L5.4158|
                  |L5.3556|
000de4  e15b              B        |L5.4254|
                  |L5.3558|
000de6  e18a              B        |L5.4350|
                  |L5.3560|
000de8  e276              B        |L5.4824|
                  |L5.3562|
000dea  e362              B        |L5.5298|
                  |L5.3564|
000dec  48ff              LDR      r0,|L5.4588|
000dee  e738              B        |L5.3170|
                  |L5.3568|
000df0  48ff              LDR      r0,|L5.4592|
000df2  e736              B        |L5.3170|
                  |L5.3572|
000df4  48ff              LDR      r0,|L5.4596|
                  |L5.3574|
000df6  8801              LDRH     r1,[r0,#0]            ;1379  ; AVT_REV_U_NOM_REW
000df8  e726              B        |L5.3144|
                  |L5.3578|
000dfa  48ff              LDR      r0,|L5.4600|
000dfc  e73c              B        |L5.3192|
                  |L5.3582|
000dfe  f9911001          LDRSB    r1,[r1,#1]            ;1416  ; a_ind
000e02  b139              CBZ      r1,|L5.3604|
000e04  2901              CMP      r1,#1                 ;1429
000e06  d01e              BEQ      |L5.3654|
000e08  7005              STRB     r5,[r0,#0]            ;1460
000e0a  62e5              STR      r5,[r4,#0x2c]         ;1463  ; bps
000e0c  6325              STR      r5,[r4,#0x30]         ;1464  ; bps
000e0e  f8846028          STRB     r6,[r4,#0x28]         ;1464
000e12  e260              B        |L5.4822|
                  |L5.3604|
000e14  f8a7a010          STRH     r10,[r7,#0x10]        ;1418
000e18  f8a7a012          STRH     r10,[r7,#0x12]        ;1419
000e1c  7006              STRB     r6,[r0,#0]            ;1420
000e1e  4651              MOV      r1,r10                ;1418
000e20  2000              MOVS     r0,#0                 ;1422
000e22  f9b82000          LDRSH    r2,[r8,#0]            ;1422
000e26  e00b              B        |L5.3648|
                  |L5.3624|
000e28  ebc003c0          RSB      r3,r0,r0,LSL #3       ;1424
000e2c  eb030343          ADD      r3,r3,r3,LSL #1       ;1424
000e30  eb040383          ADD      r3,r4,r3,LSL #2       ;1424
000e34  1c40              ADDS     r0,r0,#1              ;1422
000e36  62d9              STR      r1,[r3,#0x2c]         ;1425
000e38  6319              STR      r1,[r3,#0x30]         ;1426
000e3a  f8835028          STRB     r5,[r3,#0x28]         ;1426
000e3e  b2c0              UXTB     r0,r0                 ;1422
                  |L5.3648|
000e40  4290              CMP      r0,r2                 ;1422
000e42  dbf1              BLT      |L5.3624|
000e44  e247              B        |L5.4822|
                  |L5.3654|
000e46  7811              LDRB     r1,[r2,#0]            ;1431  ; phase
000e48  b111              CBZ      r1,|L5.3664|
000e4a  2901              CMP      r1,#1                 ;1444
000e4c  d017              BEQ      |L5.3710|
000e4e  e242              B        |L5.4822|
                  |L5.3664|
000e50  823d              STRH     r5,[r7,#0x10]         ;1433
000e52  827d              STRH     r5,[r7,#0x12]         ;1434
000e54  7005              STRB     r5,[r0,#0]            ;1435
000e56  2000              MOVS     r0,#0                 ;1437
000e58  f9b82000          LDRSH    r2,[r8,#0]            ;1422
000e5c  e00c              B        |L5.3704|
000e5e  bf00              NOP                            ;1439
                  |L5.3680|
000e60  ebc001c0          RSB      r1,r0,r0,LSL #3       ;1439
000e64  eb010141          ADD      r1,r1,r1,LSL #1       ;1439
000e68  eb040181          ADD      r1,r4,r1,LSL #2       ;1439
000e6c  1c40              ADDS     r0,r0,#1              ;1437
000e6e  62cd              STR      r5,[r1,#0x2c]         ;1440
000e70  630d              STR      r5,[r1,#0x30]         ;1441
000e72  f8816028          STRB     r6,[r1,#0x28]         ;1441
000e76  b2c0              UXTB     r0,r0                 ;1437
                  |L5.3704|
000e78  4290              CMP      r0,r2                 ;1437
000e7a  dbf1              BLT      |L5.3680|
000e7c  e22b              B        |L5.4822|
                  |L5.3710|
000e7e  f8a7a010          STRH     r10,[r7,#0x10]        ;1446
000e82  f8a7a012          STRH     r10,[r7,#0x12]        ;1447
000e86  7006              STRB     r6,[r0,#0]            ;1448
000e88  4651              MOV      r1,r10                ;1446
000e8a  2000              MOVS     r0,#0                 ;1450
000e8c  f9b82000          LDRSH    r2,[r8,#0]            ;1422
000e90  e00c              B        |L5.3756|
000e92  bf00              NOP                            ;1452
                  |L5.3732|
000e94  ebc003c0          RSB      r3,r0,r0,LSL #3       ;1452
000e98  eb030343          ADD      r3,r3,r3,LSL #1       ;1452
000e9c  eb040383          ADD      r3,r4,r3,LSL #2       ;1452
000ea0  1c40              ADDS     r0,r0,#1              ;1450
000ea2  62d9              STR      r1,[r3,#0x2c]         ;1453
000ea4  6319              STR      r1,[r3,#0x30]         ;1454
000ea6  f8835028          STRB     r5,[r3,#0x28]         ;1454
000eaa  b2c0              UXTB     r0,r0                 ;1450
                  |L5.3756|
000eac  4290              CMP      r0,r2                 ;1450
000eae  dbf1              BLT      |L5.3732|
000eb0  e3fa              B        |L5.5800|
                  |L5.3762|
000eb2  f9913001          LDRSB    r3,[r1,#1]            ;1469  ; a_ind
000eb6  b113              CBZ      r3,|L5.3774|
000eb8  2b03              CMP      r3,#3                 ;1532
000eba  d05a              BEQ      |L5.3954|
000ebc  e060              B        |L5.3968|
                  |L5.3774|
000ebe  f8a7a010          STRH     r10,[r7,#0x10]        ;1471
000ec2  f8a7a012          STRH     r10,[r7,#0x12]        ;1472
000ec6  f1040428          ADD      r4,r4,#0x28           ;1473
000eca  7006              STRB     r6,[r0,#0]            ;1473
000ecc  6065              STR      r5,[r4,#4]            ;1476  ; bps
000ece  60a5              STR      r5,[r4,#8]            ;1477  ; bps
000ed0  7026              STRB     r6,[r4,#0]            ;1477
000ed2  65a5              STR      r5,[r4,#0x58]         ;1480  ; bps
000ed4  65e5              STR      r5,[r4,#0x5c]         ;1481  ; bps
000ed6  f8846054          STRB     r6,[r4,#0x54]         ;1481
000eda  f8c450ac          STR      r5,[r4,#0xac]         ;1488  ; bps
000ede  f8c450b0          STR      r5,[r4,#0xb0]         ;1489  ; bps
000ee2  f88460a8          STRB     r6,[r4,#0xa8]         ;1489
000ee6  f8c45100          STR      r5,[r4,#0x100]        ;1492  ; bps
000eea  f8c45104          STR      r5,[r4,#0x104]        ;1493  ; bps
000eee  f88460fc          STRB     r6,[r4,#0xfc]         ;1493
000ef2  f8c45154          STR      r5,[r4,#0x154]        ;1496  ; bps
000ef6  f8c45158          STR      r5,[r4,#0x158]        ;1497  ; bps
000efa  f8846150          STRB     r6,[r4,#0x150]        ;1497
000efe  f8c451a8          STR      r5,[r4,#0x1a8]        ;1500  ; bps
000f02  f8c451ac          STR      r5,[r4,#0x1ac]        ;1501  ; bps
000f06  f88461a4          STRB     r6,[r4,#0x1a4]        ;1501
000f0a  f8c451fc          STR      r5,[r4,#0x1fc]        ;1504  ; bps
000f0e  f8c45200          STR      r5,[r4,#0x200]        ;1505  ; bps
000f12  f88461f8          STRB     r6,[r4,#0x1f8]        ;1505
000f16  f8c45250          STR      r5,[r4,#0x250]        ;1508  ; bps
000f1a  f8c45254          STR      r5,[r4,#0x254]        ;1509  ; bps
000f1e  f884624c          STRB     r6,[r4,#0x24c]        ;1509
000f22  f8c452a4          STR      r5,[r4,#0x2a4]        ;1512  ; bps
000f26  f8c452a8          STR      r5,[r4,#0x2a8]        ;1513  ; bps
000f2a  f88462a0          STRB     r6,[r4,#0x2a0]        ;1513
000f2e  f8c452f8          STR      r5,[r4,#0x2f8]        ;1516  ; bps
000f32  f8c452fc          STR      r5,[r4,#0x2fc]        ;1517  ; bps
000f36  f88462f4          STRB     r6,[r4,#0x2f4]        ;1517
000f3a  f8c4534c          STR      r5,[r4,#0x34c]        ;1520  ; bps
000f3e  f8c45350          STR      r5,[r4,#0x350]        ;1521  ; bps
000f42  f8846348          STRB     r6,[r4,#0x348]        ;1521
000f46  f8c453a0          STR      r5,[r4,#0x3a0]        ;1524  ; bps
000f4a  f8c453a4          STR      r5,[r4,#0x3a4]        ;1525  ; bps
000f4e  f884639c          STRB     r6,[r4,#0x39c]        ;1525
000f52  f9910002          LDRSB    r0,[r1,#2]            ;1527  ; a_ind
000f56  f1a40428          SUB      r4,r4,#0x28           ;1525
000f5a  ebc000c0          RSB      r0,r0,r0,LSL #3       ;1527
000f5e  eb000040          ADD      r0,r0,r0,LSL #1       ;1527
000f62  eb040080          ADD      r0,r4,r0,LSL #2       ;1527
000f66  4652              MOV      r2,r10                ;1471
000f68  62c2              STR      r2,[r0,#0x2c]         ;1528
000f6a  6302              STR      r2,[r0,#0x30]         ;1529
000f6c  f8805028          STRB     r5,[r0,#0x28]         ;1529
000f70  e39a              B        |L5.5800|
                  |L5.3954|
000f72  7812              LDRB     r2,[r2,#0]            ;1534  ; phase
000f74  b112              CBZ      r2,|L5.3964|
000f76  2a01              CMP      r2,#1                 ;1592
000f78  d0a1              BEQ      |L5.3774|
000f7a  e395              B        |L5.5800|
                  |L5.3964|
000f7c  823d              STRH     r5,[r7,#0x10]         ;1536
000f7e  827d              STRH     r5,[r7,#0x12]         ;1537
                  |L5.3968|
000f80  f1040428          ADD      r4,r4,#0x28           ;1659
000f84  7005              STRB     r5,[r0,#0]            ;1659
000f86  6065              STR      r5,[r4,#4]            ;1662  ; bps
000f88  60a5              STR      r5,[r4,#8]            ;1663  ; bps
000f8a  7026              STRB     r6,[r4,#0]            ;1663
000f8c  65a5              STR      r5,[r4,#0x58]         ;1666  ; bps
000f8e  65e5              STR      r5,[r4,#0x5c]         ;1667  ; bps
000f90  f8846054          STRB     r6,[r4,#0x54]         ;1667
000f94  f8c450ac          STR      r5,[r4,#0xac]         ;1674  ; bps
000f98  f8c450b0          STR      r5,[r4,#0xb0]         ;1675  ; bps
000f9c  f88460a8          STRB     r6,[r4,#0xa8]         ;1675
000fa0  f8c45100          STR      r5,[r4,#0x100]        ;1678  ; bps
000fa4  f8c45104          STR      r5,[r4,#0x104]        ;1679  ; bps
000fa8  f88460fc          STRB     r6,[r4,#0xfc]         ;1679
000fac  f8c45154          STR      r5,[r4,#0x154]        ;1682  ; bps
000fb0  f8c45158          STR      r5,[r4,#0x158]        ;1683  ; bps
000fb4  f8846150          STRB     r6,[r4,#0x150]        ;1683
000fb8  f8c451a8          STR      r5,[r4,#0x1a8]        ;1686  ; bps
000fbc  f8c451ac          STR      r5,[r4,#0x1ac]        ;1687  ; bps
000fc0  f88461a4          STRB     r6,[r4,#0x1a4]        ;1687
000fc4  f8c451fc          STR      r5,[r4,#0x1fc]        ;1690  ; bps
000fc8  f8c45200          STR      r5,[r4,#0x200]        ;1691  ; bps
000fcc  f88461f8          STRB     r6,[r4,#0x1f8]        ;1691
000fd0  f8c45250          STR      r5,[r4,#0x250]        ;1694  ; bps
000fd4  f8c45254          STR      r5,[r4,#0x254]        ;1695  ; bps
000fd8  f884624c          STRB     r6,[r4,#0x24c]        ;1695
000fdc  f8c452a4          STR      r5,[r4,#0x2a4]        ;1698  ; bps
000fe0  f8c452a8          STR      r5,[r4,#0x2a8]        ;1699  ; bps
000fe4  f88462a0          STRB     r6,[r4,#0x2a0]        ;1699
000fe8  f8c452f8          STR      r5,[r4,#0x2f8]        ;1702  ; bps
000fec  f8c452fc          STR      r5,[r4,#0x2fc]        ;1703  ; bps
000ff0  f88462f4          STRB     r6,[r4,#0x2f4]        ;1703
000ff4  f8c4534c          STR      r5,[r4,#0x34c]        ;1706  ; bps
000ff8  f8c45350          STR      r5,[r4,#0x350]        ;1707  ; bps
000ffc  f8846348          STRB     r6,[r4,#0x348]        ;1707
001000  f8c453a0          STR      r5,[r4,#0x3a0]        ;1710  ; bps
001004  f8c453a4          STR      r5,[r4,#0x3a4]        ;1711  ; bps
001008  f884639c          STRB     r6,[r4,#0x39c]        ;1711
00100c  e34c              B        |L5.5800|
                  |L5.4110|
00100e  2000              MOVS     r0,#0                 ;1720
001010  f9b11000          LDRSH    r1,[r1,#0]            ;1722
001014  f9b22000          LDRSH    r2,[r2,#0]            ;1723
001018  f9b83000          LDRSH    r3,[r8,#0]            ;1422
00101c  e00c              B        |L5.4152|
00101e  bf00              NOP                            ;1722
                  |L5.4128|
001020  ebc006c0          RSB      r6,r0,r0,LSL #3       ;1722
001024  eb060646          ADD      r6,r6,r6,LSL #1       ;1722
001028  eb040686          ADD      r6,r4,r6,LSL #2       ;1722
00102c  1c40              ADDS     r0,r0,#1              ;1720
00102e  e9c6120b          STRD     r1,r2,[r6,#0x2c]      ;1722
001032  f8865028          STRB     r5,[r6,#0x28]         ;1724
001036  b2c0              UXTB     r0,r0                 ;1720
                  |L5.4152|
001038  4298              CMP      r0,r3                 ;1720
00103a  dbf1              BLT      |L5.4128|
00103c  e334              B        |L5.5800|
                  |L5.4158|
00103e  f89c0000          LDRB     r0,[r12,#0]           ;1732  ; viz_stat
001042  2801              CMP      r0,#1                 ;1732
001044  f04f0000          MOV      r0,#0                 ;1743
001048  d013              BEQ      |L5.4210|
00104a  4651              MOV      r1,r10                ;1418
00104c  f9b82000          LDRSH    r2,[r8,#0]            ;1422
001050  e00c              B        |L5.4204|
001052  bf00              NOP                            ;1736
                  |L5.4180|
001054  ebc003c0          RSB      r3,r0,r0,LSL #3       ;1736
001058  eb030343          ADD      r3,r3,r3,LSL #1       ;1736
00105c  eb040383          ADD      r3,r4,r3,LSL #2       ;1736
001060  1c40              ADDS     r0,r0,#1              ;1734
001062  62d9              STR      r1,[r3,#0x2c]         ;1737
001064  6319              STR      r1,[r3,#0x30]         ;1738
001066  f8835028          STRB     r5,[r3,#0x28]         ;1738
00106a  b2c0              UXTB     r0,r0                 ;1734
                  |L5.4204|
00106c  4290              CMP      r0,r2                 ;1734
00106e  dbf1              BLT      |L5.4180|
001070  e31a              B        |L5.5800|
                  |L5.4210|
001072  f9b11000          LDRSH    r1,[r1,#0]            ;1722
001076  f9b22000          LDRSH    r2,[r2,#0]            ;1723
00107a  f9b83000          LDRSH    r3,[r8,#0]            ;1422
00107e  e00b              B        |L5.4248|
                  |L5.4224|
001080  ebc006c0          RSB      r6,r0,r0,LSL #3       ;1745
001084  eb060646          ADD      r6,r6,r6,LSL #1       ;1745
001088  eb040686          ADD      r6,r4,r6,LSL #2       ;1745
00108c  1c40              ADDS     r0,r0,#1              ;1743
00108e  e9c6120b          STRD     r1,r2,[r6,#0x2c]      ;1745
001092  f8865028          STRB     r5,[r6,#0x28]         ;1747
001096  b2c0              UXTB     r0,r0                 ;1743
                  |L5.4248|
001098  4298              CMP      r0,r3                 ;1743
00109a  dbf1              BLT      |L5.4224|
00109c  e304              B        |L5.5800|
                  |L5.4254|
00109e  f89c0000          LDRB     r0,[r12,#0]           ;1756  ; viz_stat
0010a2  2801              CMP      r0,#1                 ;1756
0010a4  f04f0000          MOV      r0,#0                 ;1767
0010a8  d013              BEQ      |L5.4306|
0010aa  4651              MOV      r1,r10                ;1418
0010ac  f9b83000          LDRSH    r3,[r8,#0]            ;1422
0010b0  e00c              B        |L5.4300|
0010b2  bf00              NOP                            ;1760
                  |L5.4276|
0010b4  ebc002c0          RSB      r2,r0,r0,LSL #3       ;1760
0010b8  eb020242          ADD      r2,r2,r2,LSL #1       ;1760
0010bc  eb040282          ADD      r2,r4,r2,LSL #2       ;1760
0010c0  1c40              ADDS     r0,r0,#1              ;1758
0010c2  62d1              STR      r1,[r2,#0x2c]         ;1761
0010c4  6311              STR      r1,[r2,#0x30]         ;1762
0010c6  f8825028          STRB     r5,[r2,#0x28]         ;1762
0010ca  b2c0              UXTB     r0,r0                 ;1758
                  |L5.4300|
0010cc  4298              CMP      r0,r3                 ;1758
0010ce  dbf1              BLT      |L5.4276|
0010d0  e2ea              B        |L5.5800|
                  |L5.4306|
0010d2  f9b11000          LDRSH    r1,[r1,#0]            ;1722
0010d6  f9b22000          LDRSH    r2,[r2,#0]            ;1723
0010da  f9b83000          LDRSH    r3,[r8,#0]            ;1422
0010de  e00b              B        |L5.4344|
                  |L5.4320|
0010e0  ebc006c0          RSB      r6,r0,r0,LSL #3       ;1769
0010e4  eb060646          ADD      r6,r6,r6,LSL #1       ;1769
0010e8  eb040686          ADD      r6,r4,r6,LSL #2       ;1769
0010ec  1c40              ADDS     r0,r0,#1              ;1767
0010ee  e9c6120b          STRD     r1,r2,[r6,#0x2c]      ;1769
0010f2  f8865028          STRB     r5,[r6,#0x28]         ;1771
0010f6  b2c0              UXTB     r0,r0                 ;1767
                  |L5.4344|
0010f8  4298              CMP      r0,r3                 ;1767
0010fa  dbf1              BLT      |L5.4320|
0010fc  e2d4              B        |L5.5800|
                  |L5.4350|
0010fe  483f              LDR      r0,|L5.4604|
001100  f9b00000          LDRSH    r0,[r0,#0]            ;1780  ; CURR_FADE_IN
001104  b150              CBZ      r0,|L5.4380|
001106  493e              LDR      r1,|L5.4608|
001108  680b              LDR      r3,[r1,#0]            ;1780  ; time_proc
00110a  4283              CMP      r3,r0                 ;1780
00110c  da06              BGE      |L5.4380|
00110e  493d              LDR      r1,|L5.4612|
001110  f9b12000          LDRSH    r2,[r1,#0]            ;1784  ; I_ug_temp
001114  435a              MULS     r2,r3,r2              ;1785
001116  fb92f0f0          SDIV     r0,r2,r0              ;1786
00111a  8008              STRH     r0,[r1,#0]            ;1790
                  |L5.4380|
00111c  79b8              LDRB     r0,[r7,#6]            ;1793  ; b1Hz_sh
00111e  b388              CBZ      r0,|L5.4484|
001120  4839              LDR      r0,|L5.4616|
001122  8800              LDRH     r0,[r0,#0]            ;1798  ; REV_IS_ON
001124  b140              CBZ      r0,|L5.4408|
001126  4839              LDR      r0,|L5.4620|
001128  8800              LDRH     r0,[r0,#0]            ;1798  ; AVT_REV_IS_ON
00112a  b128              CBZ      r0,|L5.4408|
00112c  4838              LDR      r0,|L5.4624|
00112e  7800              LDRB     r0,[r0,#0]            ;1798  ; proc_phase
001130  2801              CMP      r0,#1                 ;1798
001132  d034              BEQ      |L5.4510|
001134  2803              CMP      r0,#3                 ;1798
001136  d032              BEQ      |L5.4510|
                  |L5.4408|
001138  4836              LDR      r0,|L5.4628|
00113a  f9b01000          LDRSH    r1,[r0,#0]            ;1799  ; load_I
00113e  4831              LDR      r0,|L5.4612|
001140  f9b00000          LDRSH    r0,[r0,#0]            ;1799  ; I_ug_temp
001144  4281              CMP      r1,r0                 ;1799
001146  da04              BGE      |L5.4434|
001148  f8bb1000          LDRH     r1,[r11,#0]           ;1799  ; _x_
00114c  f1010101          ADD      r1,r1,#1              ;1799
001150  e004              B        |L5.4444|
                  |L5.4434|
001152  dd05              BLE      |L5.4448|
001154  f8bb1000          LDRH     r1,[r11,#0]           ;1800  ; _x_
001158  f1a10101          SUB      r1,r1,#1              ;1800
                  |L5.4444|
00115c  f8ab1000          STRH     r1,[r11,#0]           ;1800
                  |L5.4448|
001160  2232              MOVS     r2,#0x32              ;1802
001162  4251              RSBS     r1,r2,#0              ;1802
001164  482c              LDR      r0,|L5.4632|
001166  f7fffffe          BL       gran
00116a  482c              LDR      r0,|L5.4636|
00116c  f9b01000          LDRSH    r1,[r0,#0]            ;1804  ; load_U
001170  482b              LDR      r0,|L5.4640|
001172  f9b00000          LDRSH    r0,[r0,#0]            ;1804  ; U_maxg
001176  4281              CMP      r1,r0                 ;1804
001178  da05              BGE      |L5.4486|
00117a  f8b91000          LDRH     r1,[r9,#0]            ;1804  ; _xu_
00117e  f1010101          ADD      r1,r1,#1              ;1804
001182  e005              B        |L5.4496|
                  |L5.4484|
001184  e00b              B        |L5.4510|
                  |L5.4486|
001186  dd05              BLE      |L5.4500|
001188  f8b91000          LDRH     r1,[r9,#0]            ;1805  ; _xu_
00118c  f1a10101          SUB      r1,r1,#1              ;1805
                  |L5.4496|
001190  f8a91000          STRH     r1,[r9,#0]            ;1805
                  |L5.4500|
001194  2232              MOVS     r2,#0x32              ;1807
001196  4251              RSBS     r1,r2,#0              ;1807
001198  4822              LDR      r0,|L5.4644|
00119a  f7fffffe          BL       gran
                  |L5.4510|
00119e  4820              LDR      r0,|L5.4640|
0011a0  4921              LDR      r1,|L5.4648|
0011a2  f9b00000          LDRSH    r0,[r0,#0]            ;1812  ; U_maxg
0011a6  f9b11000          LDRSH    r1,[r1,#0]            ;1813  ; U_MAX
0011aa  ebc02040          RSB      r0,r0,r0,LSL #9       ;1812
0011ae  0040              LSLS     r0,r0,#1              ;1812
0011b0  fb90f0f1          SDIV     r0,r0,r1              ;1813
0011b4  9000              STR      r0,[sp,#0]            ;1817
0011b6  4813              LDR      r0,|L5.4612|
0011b8  491c              LDR      r1,|L5.4652|
0011ba  f9b00000          LDRSH    r0,[r0,#0]            ;1817  ; I_ug_temp
0011be  f9b11000          LDRSH    r1,[r1,#0]            ;1818  ; I_MAX_IPS
0011c2  ebc02040          RSB      r0,r0,r0,LSL #9       ;1817
0011c6  0040              LSLS     r0,r0,#1              ;1817
0011c8  fb90f0f1          SDIV     r0,r0,r1              ;1818
0011cc  4682              MOV      r10,r0                ;1818
0011ce  20ac              MOVS     r0,#0xac              ;1820
0011d0  f7fffffe          BL       lc640_read_int
0011d4  f5a0412b          SUB      r1,r0,#0xab00         ;1820
0011d8  39cd              SUBS     r1,r1,#0xcd           ;1820
0011da  d12a              BNE      |L5.4658|
0011dc  4810              LDR      r0,|L5.4640|
0011de  f9b00000          LDRSH    r0,[r0,#0]            ;1822  ; U_maxg
0011e2  f7fffffe          BL       find_U_curve
0011e6  eb000080          ADD      r0,r0,r0,LSL #2       ;1822
0011ea  e021              B        |L5.4656|
                  |L5.4588|
                          DCD      I_ug3
                  |L5.4592|
                          DCD      I_ug2
                  |L5.4596|
                          DCD      U_up3
                  |L5.4600|
                          DCD      U_up2
                  |L5.4604|
                          DCD      CURR_FADE_IN
                  |L5.4608|
                          DCD      time_proc
                  |L5.4612|
                          DCD      I_ug_temp
                  |L5.4616|
                          DCD      REV_IS_ON
                  |L5.4620|
                          DCD      AVT_REV_IS_ON
                  |L5.4624|
                          DCD      proc_phase
                  |L5.4628|
                          DCD      load_I
                  |L5.4632|
                          DCD      _x_
                  |L5.4636|
                          DCD      load_U
                  |L5.4640|
                          DCD      U_maxg
                  |L5.4644|
                          DCD      _xu_
                  |L5.4648|
                          DCD      U_MAX
                  |L5.4652|
                          DCD      I_MAX_IPS
                  |L5.4656|
001230  9000              STR      r0,[sp,#0]            ;1822
                  |L5.4658|
001232  20ae              MOVS     r0,#0xae              ;1825
001234  f7fffffe          BL       lc640_read_int
001238  f5a0412b          SUB      r1,r0,#0xab00         ;1825
00123c  39cd              SUBS     r1,r1,#0xcd           ;1825
00123e  d107              BNE      |L5.4688|
001240  48f8              LDR      r0,|L5.5668|
001242  f9b00000          LDRSH    r0,[r0,#0]            ;1827  ; I_ug_temp
001246  f7fffffe          BL       find_I_curve
00124a  eb000080          ADD      r0,r0,r0,LSL #2       ;1827
00124e  4682              MOV      r10,r0                ;1827
                  |L5.4688|
001250  2000              MOVS     r0,#0                 ;1830
001252  f9b8c000          LDRSH    r12,[r8,#0]           ;1422
001256  e03c              B        |L5.4818|
                  |L5.4696|
001258  49f3              LDR      r1,|L5.5672|
00125a  8809              LDRH     r1,[r1,#0]            ;1832  ; REV_IS_ON
00125c  b141              CBZ      r1,|L5.4720|
00125e  49f3              LDR      r1,|L5.5676|
001260  8809              LDRH     r1,[r1,#0]            ;1832  ; AVT_REV_IS_ON
001262  b129              CBZ      r1,|L5.4720|
001264  49f2              LDR      r1,|L5.5680|
001266  7809              LDRB     r1,[r1,#0]            ;1832  ; proc_phase
001268  2901              CMP      r1,#1                 ;1832
00126a  d010              BEQ      |L5.4750|
00126c  2903              CMP      r1,#3                 ;1832
00126e  d00e              BEQ      |L5.4750|
                  |L5.4720|
001270  9900              LDR      r1,[sp,#0]            ;1837
001272  b20a              SXTH     r2,r1                 ;1837
001274  f9b91000          LDRSH    r1,[r9,#0]            ;1837  ; _xu_
001278  1852              ADDS     r2,r2,r1              ;1837
00127a  ebc001c0          RSB      r1,r0,r0,LSL #3       ;1837
00127e  eb010141          ADD      r1,r1,r1,LSL #1       ;1837
001282  eb040181          ADD      r1,r4,r1,LSL #2       ;1837
001286  62ca              STR      r2,[r1,#0x2c]         ;1838
001288  d50c              BPL      |L5.4772|
00128a  62cd              STR      r5,[r1,#0x2c]         ;1838
00128c  e00f              B        |L5.4782|
                  |L5.4750|
00128e  ebc001c0          RSB      r1,r0,r0,LSL #3       ;1833
001292  eb010141          ADD      r1,r1,r1,LSL #1       ;1833
001296  eb040181          ADD      r1,r4,r1,LSL #2       ;1833
00129a  62cd              STR      r5,[r1,#0x2c]         ;1834
00129c  630d              STR      r5,[r1,#0x30]         ;1835
00129e  f8816028          STRB     r6,[r1,#0x28]         ;1835
0012a2  e014              B        |L5.4814|
                  |L5.4772|
0012a4  f24033fe          MOV      r3,#0x3fe             ;1839
0012a8  429a              CMP      r2,r3                 ;1839
0012aa  dd00              BLE      |L5.4782|
0012ac  62cb              STR      r3,[r1,#0x2c]         ;1839
                  |L5.4782|
0012ae  f9bb2000          LDRSH    r2,[r11,#0]           ;1840  ; _x_
0012b2  fa0ff38a          SXTH     r3,r10                ;1840
0012b6  189a              ADDS     r2,r3,r2              ;1840
0012b8  630a              STR      r2,[r1,#0x30]         ;1841
0012ba  d501              BPL      |L5.4800|
0012bc  630d              STR      r5,[r1,#0x30]         ;1841
0012be  e004              B        |L5.4810|
                  |L5.4800|
0012c0  f24033fe          MOV      r3,#0x3fe             ;1842
0012c4  429a              CMP      r2,r3                 ;1842
0012c6  dd00              BLE      |L5.4810|
0012c8  630b              STR      r3,[r1,#0x30]         ;1842
                  |L5.4810|
0012ca  f8815028          STRB     r5,[r1,#0x28]         ;1843
                  |L5.4814|
0012ce  1c40              ADDS     r0,r0,#1              ;1830
0012d0  b2c0              UXTB     r0,r0                 ;1830
                  |L5.4818|
0012d2  4560              CMP      r0,r12                ;1830
0012d4  dbc0              BLT      |L5.4696|
                  |L5.4822|
0012d6  e1e7              B        |L5.5800|
                  |L5.4824|
0012d8  f8dfc358          LDR      r12,|L5.5684|
0012dc  f9bc1000          LDRSH    r1,[r12,#0]           ;1854  ; load_U_
0012e0  2905              CMP      r1,#5                 ;1854
0012e2  dd01              BLE      |L5.4840|
0012e4  727e              STRB     r6,[r7,#9]            ;1854
0012e6  e000              B        |L5.4842|
                  |L5.4840|
0012e8  727d              STRB     r5,[r7,#9]            ;1855
                  |L5.4842|
0012ea  48d3              LDR      r0,|L5.5688|
0012ec  2364              MOVS     r3,#0x64              ;1857
0012ee  f9b02000          LDRSH    r2,[r0,#0]            ;1857  ; U_up_temp
0012f2  fb92f3f3          SDIV     r3,r2,r3              ;1857
0012f6  9300              STR      r3,[sp,#0]            ;1858
0012f8  2b00              CMP      r3,#0                 ;1858
0012fa  dc01              BGT      |L5.4864|
0012fc  2301              MOVS     r3,#1                 ;1858
0012fe  9300              STR      r3,[sp,#0]            ;1858
                  |L5.4864|
001300  1a88              SUBS     r0,r1,r2              ;1859
001302  b200              SXTH     r0,r0                 ;1859
001304  f7fffffe          BL       abs
001308  9900              LDR      r1,[sp,#0]            ;1859
00130a  b209              SXTH     r1,r1                 ;1859
00130c  4288              CMP      r0,r1                 ;1859
00130e  da01              BGE      |L5.4884|
001310  72be              STRB     r6,[r7,#0xa]          ;1859
001312  e000              B        |L5.4886|
                  |L5.4884|
001314  72bd              STRB     r5,[r7,#0xa]          ;1860
                  |L5.4886|
001316  723d              STRB     r5,[r7,#8]            ;1864
001318  7ab8              LDRB     r0,[r7,#0xa]          ;1866  ; bU_VALID_VALID
00131a  b180              CBZ      r0,|L5.4926|
00131c  7af8              LDRB     r0,[r7,#0xb]          ;1868  ; bPRECESSION_REG
00131e  b3b8              CBZ      r0,|L5.5008|
001320  48c4              LDR      r0,|L5.5684|
001322  72fd              STRB     r5,[r7,#0xb]          ;1870
001324  f9b01000          LDRSH    r1,[r0,#0]            ;1871  ; load_U_
001328  48c3              LDR      r0,|L5.5688|
00132a  f9b00000          LDRSH    r0,[r0,#0]            ;1871  ; U_up_temp
00132e  4281              CMP      r1,r0                 ;1871
001330  db2a              BLT      |L5.5000|
001332  dc2f              BGT      |L5.5012|
001334  e032              B        |L5.5020|
001336  bf00              NOP                            ;1872
                  |L5.4920|
001338  f8a91000          STRH     r1,[r9,#0]            ;1872
00133c  e02e              B        |L5.5020|
                  |L5.4926|
00133e  79b8              LDRB     r0,[r7,#6]            ;1876  ; b1Hz_sh
001340  b330              CBZ      r0,|L5.5008|
001342  7a78              LDRB     r0,[r7,#9]            ;1876  ; bU_VALID
001344  b320              CBZ      r0,|L5.5008|
001346  48bd              LDR      r0,|L5.5692|
001348  f9b01000          LDRSH    r1,[r0,#0]            ;1878  ; load_I
00134c  48bc              LDR      r0,|L5.5696|
00134e  f9b00000          LDRSH    r0,[r0,#0]            ;1878  ; I_maxp
001352  4281              CMP      r1,r0                 ;1878
001354  da04              BGE      |L5.4960|
001356  f8bb1000          LDRH     r1,[r11,#0]           ;1878  ; _x_
00135a  f1010101          ADD      r1,r1,#1              ;1878
00135e  e004              B        |L5.4970|
                  |L5.4960|
001360  dd05              BLE      |L5.4974|
001362  f8bb1000          LDRH     r1,[r11,#0]           ;1879  ; _x_
001366  f1a10101          SUB      r1,r1,#1              ;1879
                  |L5.4970|
00136a  f8ab1000          STRH     r1,[r11,#0]           ;1879
                  |L5.4974|
00136e  2232              MOVS     r2,#0x32              ;1880
001370  4251              RSBS     r1,r2,#0              ;1880
001372  48b4              LDR      r0,|L5.5700|
001374  f7fffffe          BL       gran
001378  48ae              LDR      r0,|L5.5684|
00137a  f9b01000          LDRSH    r1,[r0,#0]            ;1882  ; load_U_
00137e  48ae              LDR      r0,|L5.5688|
001380  f9b00000          LDRSH    r0,[r0,#0]            ;1882  ; U_up_temp
001384  4281              CMP      r1,r0                 ;1882
001386  da04              BGE      |L5.5010|
                  |L5.5000|
001388  f8b91000          LDRH     r1,[r9,#0]            ;1882  ; _xu_
00138c  1c49              ADDS     r1,r1,#1              ;1882
00138e  e7d3              B        |L5.4920|
                  |L5.5008|
001390  e009              B        |L5.5030|
                  |L5.5010|
001392  dd03              BLE      |L5.5020|
                  |L5.5012|
001394  f8b91000          LDRH     r1,[r9,#0]            ;1883  ; _xu_
001398  1e49              SUBS     r1,r1,#1              ;1883
00139a  e7cd              B        |L5.4920|
                  |L5.5020|
00139c  2232              MOVS     r2,#0x32              ;1884
00139e  4251              RSBS     r1,r2,#0              ;1884
0013a0  48a9              LDR      r0,|L5.5704|
0013a2  f7fffffe          BL       gran
                  |L5.5030|
0013a6  48a4              LDR      r0,|L5.5688|
0013a8  f44f7161          MOV      r1,#0x384             ;1890
0013ac  f9b00000          LDRSH    r0,[r0,#0]            ;1890  ; U_up_temp
0013b0  4348              MULS     r0,r1,r0              ;1890
0013b2  49a6              LDR      r1,|L5.5708|
0013b4  f9b11000          LDRSH    r1,[r1,#0]            ;1891  ; U_MAX
0013b8  fb90f0f1          SDIV     r0,r0,r1              ;1891
0013bc  3032              ADDS     r0,r0,#0x32           ;1892
0013be  9000              STR      r0,[sp,#0]            ;1894
0013c0  20ac              MOVS     r0,#0xac              ;1894
0013c2  f7fffffe          BL       lc640_read_int
0013c6  f5a0412b          SUB      r1,r0,#0xab00         ;1894
0013ca  39cd              SUBS     r1,r1,#0xcd           ;1894
0013cc  d107              BNE      |L5.5086|
0013ce  489a              LDR      r0,|L5.5688|
0013d0  f9b00000          LDRSH    r0,[r0,#0]            ;1896  ; U_up_temp
0013d4  f7fffffe          BL       find_U_curve
0013d8  eb000080          ADD      r0,r0,r0,LSL #2       ;1896
0013dc  9000              STR      r0,[sp,#0]            ;1896
                  |L5.5086|
0013de  4898              LDR      r0,|L5.5696|
0013e0  499b              LDR      r1,|L5.5712|
0013e2  f9b00000          LDRSH    r0,[r0,#0]            ;1902  ; I_maxp
0013e6  f9b11000          LDRSH    r1,[r1,#0]            ;1903  ; I_MAX_IPS
0013ea  ebc02040          RSB      r0,r0,r0,LSL #9       ;1902
0013ee  0040              LSLS     r0,r0,#1              ;1902
0013f0  fb90f0f1          SDIV     r0,r0,r1              ;1903
0013f4  4682              MOV      r10,r0                ;1903
0013f6  20ae              MOVS     r0,#0xae              ;1905
0013f8  f7fffffe          BL       lc640_read_int
0013fc  f5a0412b          SUB      r1,r0,#0xab00         ;1905
001400  39cd              SUBS     r1,r1,#0xcd           ;1905
001402  d107              BNE      |L5.5140|
001404  488e              LDR      r0,|L5.5696|
001406  f9b00000          LDRSH    r0,[r0,#0]            ;1907  ; I_maxp
00140a  f7fffffe          BL       find_I_curve
00140e  eb000080          ADD      r0,r0,r0,LSL #2       ;1907
001412  4682              MOV      r10,r0                ;1907
                  |L5.5140|
001414  f9b80000          LDRSH    r0,[r8,#0]            ;1422
001418  2100              MOVS     r1,#0                 ;1910
00141a  4680              MOV      r8,r0                 ;1422
00141c  e040              B        |L5.5280|
                  |L5.5150|
00141e  4882              LDR      r0,|L5.5672|
001420  8800              LDRH     r0,[r0,#0]            ;1912  ; REV_IS_ON
001422  b140              CBZ      r0,|L5.5174|
001424  4881              LDR      r0,|L5.5676|
001426  8800              LDRH     r0,[r0,#0]            ;1912  ; AVT_REV_IS_ON
001428  b128              CBZ      r0,|L5.5174|
00142a  4881              LDR      r0,|L5.5680|
00142c  7800              LDRB     r0,[r0,#0]            ;1912  ; proc_phase
00142e  2801              CMP      r0,#1                 ;1912
001430  d014              BEQ      |L5.5212|
001432  2803              CMP      r0,#3                 ;1912
001434  d012              BEQ      |L5.5212|
                  |L5.5174|
001436  ebc100c1          RSB      r0,r1,r1,LSL #3       ;1917
00143a  9a00              LDR      r2,[sp,#0]            ;1917
00143c  eb000040          ADD      r0,r0,r0,LSL #1       ;1917
001440  eb040080          ADD      r0,r4,r0,LSL #2       ;1917
001444  fa0ffc82          SXTH     r12,r2                ;1917
001448  f9b92000          LDRSH    r2,[r9,#0]            ;1917  ; _xu_
00144c  f9b03050          LDRSH    r3,[r0,#0x50]         ;1917
001450  4462              ADD      r2,r2,r12             ;1917
001452  189a              ADDS     r2,r3,r2              ;1917
001454  62c2              STR      r2,[r0,#0x2c]         ;1918
001456  d50c              BPL      |L5.5234|
001458  62c5              STR      r5,[r0,#0x2c]         ;1918
00145a  e00f              B        |L5.5244|
                  |L5.5212|
00145c  ebc100c1          RSB      r0,r1,r1,LSL #3       ;1913
001460  eb000040          ADD      r0,r0,r0,LSL #1       ;1913
001464  eb040080          ADD      r0,r4,r0,LSL #2       ;1913
001468  62c5              STR      r5,[r0,#0x2c]         ;1914
00146a  6305              STR      r5,[r0,#0x30]         ;1915
00146c  f8806028          STRB     r6,[r0,#0x28]         ;1915
001470  e014              B        |L5.5276|
                  |L5.5234|
001472  f24033fe          MOV      r3,#0x3fe             ;1919
001476  429a              CMP      r2,r3                 ;1919
001478  dd00              BLE      |L5.5244|
00147a  62c3              STR      r3,[r0,#0x2c]         ;1919
                  |L5.5244|
00147c  f9bb2000          LDRSH    r2,[r11,#0]           ;1920  ; _x_
001480  fa0ff38a          SXTH     r3,r10                ;1920
001484  189a              ADDS     r2,r3,r2              ;1920
001486  6302              STR      r2,[r0,#0x30]         ;1921
001488  d501              BPL      |L5.5262|
00148a  6305              STR      r5,[r0,#0x30]         ;1921
00148c  e004              B        |L5.5272|
                  |L5.5262|
00148e  f24033fe          MOV      r3,#0x3fe             ;1922
001492  429a              CMP      r2,r3                 ;1922
001494  dd00              BLE      |L5.5272|
001496  6303              STR      r3,[r0,#0x30]         ;1922
                  |L5.5272|
001498  f8805028          STRB     r5,[r0,#0x28]         ;1923
                  |L5.5276|
00149c  1c49              ADDS     r1,r1,#1              ;1910
00149e  b2c9              UXTB     r1,r1                 ;1910
                  |L5.5280|
0014a0  4541              CMP      r1,r8                 ;1910
0014a2  dbbc              BLT      |L5.5150|
0014a4  496b              LDR      r1,|L5.5716|
0014a6  9800              LDR      r0,[sp,#0]            ;1935
0014a8  8008              STRH     r0,[r1,#0]            ;1935
0014aa  496b              LDR      r1,|L5.5720|
0014ac  6ae0              LDR      r0,[r4,#0x2c]         ;1936  ; bps
0014ae  8008              STRH     r0,[r1,#0]            ;1936
0014b0  e0fa              B        |L5.5800|
                  |L5.5298|
0014b2  79b8              LDRB     r0,[r7,#6]            ;1948  ; b1Hz_sh
0014b4  b380              CBZ      r0,|L5.5400|
0014b6  4869              LDR      r0,|L5.5724|
0014b8  7800              LDRB     r0,[r0,#0]            ;1949  ; bOFF
0014ba  bb68              CBNZ     r0,|L5.5400|
0014bc  4868              LDR      r0,|L5.5728|
0014be  f9b00000          LDRSH    r0,[r0,#0]            ;1950  ; CAP_WRK_CURR
0014c2  eb000180          ADD      r1,r0,r0,LSL #2       ;1950
0014c6  485d              LDR      r0,|L5.5692|
0014c8  f9b00000          LDRSH    r0,[r0,#0]            ;1950  ; load_I
0014cc  ebb00f41          CMP      r0,r1,LSL #1          ;1950
0014d0  da04              BGE      |L5.5340|
0014d2  f8bb1000          LDRH     r1,[r11,#0]           ;1950  ; _x_
0014d6  f1010101          ADD      r1,r1,#1              ;1950
0014da  e004              B        |L5.5350|
                  |L5.5340|
0014dc  dd05              BLE      |L5.5354|
0014de  f8bb1000          LDRH     r1,[r11,#0]           ;1951  ; _x_
0014e2  f1a10101          SUB      r1,r1,#1              ;1951
                  |L5.5350|
0014e6  f8ab1000          STRH     r1,[r11,#0]           ;1951
                  |L5.5354|
0014ea  4652              MOV      r2,r10                ;1952
0014ec  4629              MOV      r1,r5                 ;1952
0014ee  4855              LDR      r0,|L5.5700|
0014f0  f7fffffe          BL       gran
0014f4  2232              MOVS     r2,#0x32              ;1953
0014f6  4251              RSBS     r1,r2,#0              ;1953
0014f8  4852              LDR      r0,|L5.5700|
0014fa  f7fffffe          BL       gran
0014fe  4859              LDR      r0,|L5.5732|
001500  f9b00000          LDRSH    r0,[r0,#0]            ;1955  ; CAP_MAX_VOLT
001504  eb000180          ADD      r1,r0,r0,LSL #2       ;1955
001508  4857              LDR      r0,|L5.5736|
00150a  f9b00000          LDRSH    r0,[r0,#0]            ;1955  ; load_U
00150e  ebb00f41          CMP      r0,r1,LSL #1          ;1955
001512  da07              BGE      |L5.5412|
001514  e001              B        |L5.5402|
                  |L5.5398|
001516  e0c1              B        |L5.5788|
                  |L5.5400|
001518  e015              B        |L5.5446|
                  |L5.5402|
00151a  f8b91000          LDRH     r1,[r9,#0]            ;1955  ; _xu_
00151e  f1010101          ADD      r1,r1,#1              ;1955
001522  e004              B        |L5.5422|
                  |L5.5412|
001524  dd05              BLE      |L5.5426|
001526  f8b91000          LDRH     r1,[r9,#0]            ;1956  ; _xu_
00152a  f1a10101          SUB      r1,r1,#1              ;1956
                  |L5.5422|
00152e  f8a91000          STRH     r1,[r9,#0]            ;1956
                  |L5.5426|
001532  4652              MOV      r2,r10                ;1957
001534  4629              MOV      r1,r5                 ;1957
001536  4843              LDR      r0,|L5.5700|
001538  f7fffffe          BL       gran
00153c  2232              MOVS     r2,#0x32              ;1958
00153e  4251              RSBS     r1,r2,#0              ;1958
001540  4841              LDR      r0,|L5.5704|
001542  f7fffffe          BL       gran
                  |L5.5446|
001546  4847              LDR      r0,|L5.5732|
001548  f24271ec          MOV      r1,#0x27ec            ;1963
00154c  f9b00000          LDRSH    r0,[r0,#0]            ;1963  ; CAP_MAX_VOLT
001550  4348              MULS     r0,r1,r0              ;1963
001552  493e              LDR      r1,|L5.5708|
001554  f9b11000          LDRSH    r1,[r1,#0]            ;1964  ; U_MAX
001558  fb90f0f1          SDIV     r0,r0,r1              ;1964
00155c  9000              STR      r0,[sp,#0]            ;1968
00155e  4840              LDR      r0,|L5.5728|
001560  f24271ec          MOV      r1,#0x27ec            ;1968
001564  f9b00000          LDRSH    r0,[r0,#0]            ;1968  ; CAP_WRK_CURR
001568  4348              MULS     r0,r1,r0              ;1968
00156a  4939              LDR      r1,|L5.5712|
00156c  f9b11000          LDRSH    r1,[r1,#0]            ;1969  ; I_MAX_IPS
001570  fb90f0f1          SDIV     r0,r0,r1              ;1969
001574  9001              STR      r0,[sp,#4]            ;1971
001576  20ac              MOVS     r0,#0xac              ;1971
001578  f7fffffe          BL       lc640_read_int
00157c  f5a0412b          SUB      r1,r0,#0xab00         ;1971
001580  39cd              SUBS     r1,r1,#0xcd           ;1971
001582  d10a              BNE      |L5.5530|
001584  4837              LDR      r0,|L5.5732|
001586  8800              LDRH     r0,[r0,#0]            ;1973  ; CAP_MAX_VOLT
001588  eb000080          ADD      r0,r0,r0,LSL #2       ;1973
00158c  0040              LSLS     r0,r0,#1              ;1973
00158e  b200              SXTH     r0,r0                 ;1973
001590  f7fffffe          BL       find_U_curve
001594  eb000080          ADD      r0,r0,r0,LSL #2       ;1973
001598  9000              STR      r0,[sp,#0]            ;1973
                  |L5.5530|
00159a  20ae              MOVS     r0,#0xae              ;1976
00159c  f7fffffe          BL       lc640_read_int
0015a0  f5a0412b          SUB      r1,r0,#0xab00         ;1976
0015a4  39cd              SUBS     r1,r1,#0xcd           ;1976
0015a6  d10a              BNE      |L5.5566|
0015a8  482d              LDR      r0,|L5.5728|
0015aa  8800              LDRH     r0,[r0,#0]            ;1978  ; CAP_WRK_CURR
0015ac  eb000080          ADD      r0,r0,r0,LSL #2       ;1978
0015b0  0040              LSLS     r0,r0,#1              ;1978
0015b2  b200              SXTH     r0,r0                 ;1978
0015b4  f7fffffe          BL       find_I_curve
0015b8  eb000080          ADD      r0,r0,r0,LSL #2       ;1978
0015bc  9001              STR      r0,[sp,#4]            ;1978
                  |L5.5566|
0015be  2000              MOVS     r0,#0                 ;1983
0015c0  f9b81000          LDRSH    r1,[r8,#0]            ;1422
0015c4  e05a              B        |L5.5756|
                  |L5.5574|
0015c6  4a25              LDR      r2,|L5.5724|
0015c8  7812              LDRB     r2,[r2,#0]            ;1985  ; bOFF
0015ca  b152              CBZ      r2,|L5.5602|
0015cc  ebc002c0          RSB      r2,r0,r0,LSL #3       ;1986
0015d0  eb020242          ADD      r2,r2,r2,LSL #1       ;1986
0015d4  eb040282          ADD      r2,r4,r2,LSL #2       ;1986
0015d8  62d5              STR      r5,[r2,#0x2c]         ;1987
0015da  6315              STR      r5,[r2,#0x30]         ;1988
0015dc  f8826028          STRB     r6,[r2,#0x28]         ;1988
0015e0  e04a              B        |L5.5752|
                  |L5.5602|
0015e2  9a00              LDR      r2,[sp,#0]            ;1990
0015e4  b213              SXTH     r3,r2                 ;1990
0015e6  f9b92000          LDRSH    r2,[r9,#0]            ;1990  ; _xu_
0015ea  189a              ADDS     r2,r3,r2              ;1990
0015ec  ebc003c0          RSB      r3,r0,r0,LSL #3       ;1990
0015f0  eb030343          ADD      r3,r3,r3,LSL #1       ;1990
0015f4  eb040c83          ADD      r12,r4,r3,LSL #2      ;1990
0015f8  f8cc202c          STR      r2,[r12,#0x2c]        ;1991
0015fc  d502              BPL      |L5.5636|
0015fe  f8cc502c          STR      r5,[r12,#0x2c]        ;1991
001602  e003              B        |L5.5644|
                  |L5.5636|
001604  4552              CMP      r2,r10                ;1992
001606  dd01              BLE      |L5.5644|
001608  f8cca02c          STR      r10,[r12,#0x2c]       ;1992
                  |L5.5644|
00160c  9a01              LDR      r2,[sp,#4]            ;1993
00160e  b213              SXTH     r3,r2                 ;1993
001610  f9bb2000          LDRSH    r2,[r11,#0]           ;1993  ; _x_
001614  189a              ADDS     r2,r3,r2              ;1993
001616  f8cc2030          STR      r2,[r12,#0x30]        ;1994
00161a  d527              BPL      |L5.5740|
00161c  f8cc5030          STR      r5,[r12,#0x30]        ;1994
001620  e028              B        |L5.5748|
001622  0000              DCW      0x0000
                  |L5.5668|
                          DCD      I_ug_temp
                  |L5.5672|
                          DCD      REV_IS_ON
                  |L5.5676|
                          DCD      AVT_REV_IS_ON
                  |L5.5680|
                          DCD      proc_phase
                  |L5.5684|
                          DCD      load_U_
                  |L5.5688|
                          DCD      U_up_temp
                  |L5.5692|
                          DCD      load_I
                  |L5.5696|
                          DCD      I_maxp
                  |L5.5700|
                          DCD      _x_
                  |L5.5704|
                          DCD      _xu_
                  |L5.5708|
                          DCD      U_MAX
                  |L5.5712|
                          DCD      I_MAX_IPS
                  |L5.5716|
                          DCD      plazma_vol_u_0
                  |L5.5720|
                          DCD      plazma_vol_u_1
                  |L5.5724|
                          DCD      bOFF
                  |L5.5728|
                          DCD      CAP_WRK_CURR
                  |L5.5732|
                          DCD      CAP_MAX_VOLT
                  |L5.5736|
                          DCD      load_U
                  |L5.5740|
00166c  4552              CMP      r2,r10                ;1995
00166e  dd01              BLE      |L5.5748|
001670  f8cca030          STR      r10,[r12,#0x30]       ;1995
                  |L5.5748|
001674  f88c5028          STRB     r5,[r12,#0x28]        ;1996
                  |L5.5752|
001678  1c40              ADDS     r0,r0,#1              ;1983
00167a  b2c0              UXTB     r0,r0                 ;1983
                  |L5.5756|
00167c  4288              CMP      r0,r1                 ;1983
00167e  dba2              BLT      |L5.5574|
001680  e012              B        |L5.5800|
;;;2006   		{
;;;2007   		bps[i]._vol_u=0;
001682  bf00              NOP      
                  |L5.5764|
001684  ebc001c0          RSB      r1,r0,r0,LSL #3
001688  eb010141          ADD      r1,r1,r1,LSL #1
00168c  eb040181          ADD      r1,r4,r1,LSL #2
001690  1c40              ADDS     r0,r0,#1              ;2005
;;;2008   		bps[i]._vol_i=0;
001692  62cd              STR      r5,[r1,#0x2c]
;;;2009   		bps[i]._flags_tu=1;
001694  630d              STR      r5,[r1,#0x30]
001696  f8816028          STRB     r6,[r1,#0x28]
00169a  b2c0              UXTB     r0,r0                 ;2005
                  |L5.5788|
00169c  4290              CMP      r0,r2                 ;2005
00169e  dbf1              BLT      |L5.5764|
;;;2010   		}
;;;2011   	_x_=0;
0016a0  f8ab5000          STRH     r5,[r11,#0]
;;;2012   	_xu_=0;
0016a4  f8a95000          STRH     r5,[r9,#0]
                  |L5.5800|
;;;2013   	}
;;;2014   
;;;2015   //gran(&bps[0]._vol_u,10,1010);
;;;2016   //gran(&bps[0]._vol_i,10,1010);
;;;2017   
;;;2018   b1Hz_sh=0;
0016a8  71bd              STRB     r5,[r7,#6]
;;;2019   }
0016aa  e8bd9ffc          POP      {r2-r12,pc}
;;;2020   
                          ENDP

                  bps_drv PROC
;;;2029   //-----------------------------------------------
;;;2030   void bps_drv(char in)
0016ae  b510              PUSH     {r4,lr}
;;;2031   {
;;;2032   char temp;
;;;2033   
;;;2034   if (bps[in]._device!=dSRC) return;
0016b0  ebc000c0          RSB      r0,r0,r0,LSL #3
0016b4  eb000140          ADD      r1,r0,r0,LSL #1
0016b8  48ff              LDR      r0,|L5.6840|
0016ba  f8102021          LDRB     r2,[r0,r1,LSL #2]
0016be  2a03              CMP      r2,#3
0016c0  d174              BNE      |L5.6060|
;;;2035   temp=bps[in]._flags_tm;
0016c2  eb000081          ADD      r0,r0,r1,LSL #2
0016c6  f890103e          LDRB     r1,[r0,#0x3e]
;;;2036   if(temp&(1<<AV_T))
0016ca  078a              LSLS     r2,r1,#30
;;;2037   	{
;;;2038   	if(bps[in]._temp_av_cnt<1200) 
;;;2039   		{
;;;2040   		bps[in]._temp_av_cnt++;
;;;2041   		if(bps[in]._temp_av_cnt>=1200)
;;;2042   			{
;;;2043   			bps[in]._temp_av_cnt=1200;
;;;2044   		   	//if(!(bps[in]._av&(1<<0)))avar_bps_hndl(in,0,1);
;;;2045   			}
;;;2046   		}
;;;2047   	}
;;;2048   
;;;2049   else if(!(temp&(1<<AV_T)))
;;;2050   	{
;;;2051   	if(bps[in]._temp_av_cnt) 
0016cc  f9b02042          LDRSH    r2,[r0,#0x42]
0016d0  d50c              BPL      |L5.5868|
0016d2  f44f6396          MOV      r3,#0x4b0             ;2038
0016d6  429a              CMP      r2,r3                 ;2038
0016d8  da0d              BGE      |L5.5878|
0016da  1c52              ADDS     r2,r2,#1              ;2040
0016dc  b212              SXTH     r2,r2                 ;2040
0016de  f8a02042          STRH     r2,[r0,#0x42]         ;2040
0016e2  429a              CMP      r2,r3                 ;2041
0016e4  db07              BLT      |L5.5878|
0016e6  f8a03042          STRH     r3,[r0,#0x42]         ;2043
0016ea  e004              B        |L5.5878|
                  |L5.5868|
0016ec  b11a              CBZ      r2,|L5.5878|
;;;2052   		{
;;;2053   		bps[in]._temp_av_cnt--;
0016ee  f1a20201          SUB      r2,r2,#1
0016f2  f8a02042          STRH     r2,[r0,#0x42]
                  |L5.5878|
;;;2054   		if(!bps[in]._temp_av_cnt)
;;;2055   			{
;;;2056   			//if(bps[in]._av&(1<<0))avar_bps_hndl(in,0,0);
;;;2057   			}
;;;2058   		} 	
;;;2059   
;;;2060   	}
;;;2061   
;;;2062   if((temp&(1<<AVUMAX)))
0016f6  070a              LSLS     r2,r1,#28
;;;2063   	{
;;;2064   	if(bps[in]._umax_av_cnt<10) 
;;;2065   		{
;;;2066   		bps[in]._umax_av_cnt++;
;;;2067   		if(bps[in]._umax_av_cnt>=10)
;;;2068   			{ 
;;;2069   			bps[in]._umax_av_cnt=10;
;;;2070   			//if(!(bps[in]._av&(1<<1)))avar_bps_hndl(in,1,1);
;;;2071   		  	/*if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,1,1);
;;;2072   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;2073   				{
;;;2074   				apv_cnt[in,0]=APV_INIT;
;;;2075   				apv_cnt[in,1]=APV_INIT;
;;;2076   				apv_cnt[in,2]=APV_INIT;
;;;2077   				apv_flags[in]=afOFF;
;;;2078   				}				*/
;;;2079   						
;;;2080   			}
;;;2081   		} 
;;;2082   	}		
;;;2083   else if(!(temp&(1<<AVUMAX)))
;;;2084   	{
;;;2085   	if(bps[in]._umax_av_cnt>0) 
0016f8  f9b02044          LDRSH    r2,[r0,#0x44]
0016fc  f04f030a          MOV      r3,#0xa               ;2069
001700  f04f0400          MOV      r4,#0                 ;2038
001704  d50a              BPL      |L5.5916|
001706  2a0a              CMP      r2,#0xa               ;2064
001708  da13              BGE      |L5.5938|
00170a  1c52              ADDS     r2,r2,#1              ;2066
00170c  b212              SXTH     r2,r2                 ;2066
00170e  f8a02044          STRH     r2,[r0,#0x44]         ;2066
001712  2a0a              CMP      r2,#0xa               ;2067
001714  db0d              BLT      |L5.5938|
001716  f8a03044          STRH     r3,[r0,#0x44]         ;2069
00171a  e00a              B        |L5.5938|
                  |L5.5916|
00171c  2a00              CMP      r2,#0
00171e  dd05              BLE      |L5.5932|
;;;2086   		{
;;;2087   		bps[in]._umax_av_cnt--;
001720  f1a20201          SUB      r2,r2,#1
001724  b212              SXTH     r2,r2
001726  f8a02044          STRH     r2,[r0,#0x44]
;;;2088   		if(bps[in]._umax_av_cnt==0)
00172a  e002              B        |L5.5938|
                  |L5.5932|
;;;2089   			{
;;;2090   			bps[in]._umax_av_cnt=0;
;;;2091   			//avar_bps_hndl(in,1,0);
;;;2092   	 //		apv_cnt[in,0]=0;
;;;2093   	//		apv_cnt[in,1]=0;
;;;2094   	 //		apv_cnt[in,2]=0;			
;;;2095   			}
;;;2096   		}
;;;2097   	else if(bps[in]._umax_av_cnt<0) bps[in]._umax_av_cnt=0;		 
00172c  da01              BGE      |L5.5938|
00172e  f8a04044          STRH     r4,[r0,#0x44]
                  |L5.5938|
;;;2098   	}
;;;2099   
;;;2100   if(temp&(1<<AVUMIN))
001732  06ca              LSLS     r2,r1,#27
;;;2101   	{
;;;2102   	if(bps[in]._umin_av_cnt<10) 
;;;2103   		{
;;;2104   		bps[in]._umin_av_cnt++;
;;;2105   		if(bps[in]._umin_av_cnt>=10)
;;;2106   			{ 
;;;2107   			bps[in]._umin_av_cnt=10;
;;;2108   			//if(!(bps[in]._av&(1<<2)))avar_bps_hndl(in,2,1);
;;;2109   		  	/*	if((K[APV]!=ON)||((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afOFF)))avar_s_hndl(in,2,1);
;;;2110   			if((apv_cnt[in,0]==0)&&(apv_cnt[in,1]==0)&&(apv_cnt[in,2]==0)&&(apv_flags[in]==afON))
;;;2111   				{
;;;2112   				apv_cnt[in,0]=APV_INIT;
;;;2113   				apv_cnt[in,1]=APV_INIT;
;;;2114   				apv_cnt[in,2]=APV_INIT;
;;;2115   				apv_flags[in]=afOFF;
;;;2116   				}*/				
;;;2117   			}
;;;2118   		} 
;;;2119   	}	
;;;2120   	
;;;2121   else if(!(temp&(1<<AVUMIN)))
;;;2122   	{
;;;2123   	if(bps[in]._umin_av_cnt) 
001734  f9b02046          LDRSH    r2,[r0,#0x46]
001738  d50a              BPL      |L5.5968|
00173a  2a0a              CMP      r2,#0xa               ;2102
00173c  da0d              BGE      |L5.5978|
00173e  1c52              ADDS     r2,r2,#1              ;2104
001740  b212              SXTH     r2,r2                 ;2104
001742  f8a02046          STRH     r2,[r0,#0x46]         ;2104
001746  2a0a              CMP      r2,#0xa               ;2105
001748  db07              BLT      |L5.5978|
00174a  f8a03046          STRH     r3,[r0,#0x46]         ;2107
00174e  e004              B        |L5.5978|
                  |L5.5968|
001750  b11a              CBZ      r2,|L5.5978|
;;;2124   		{
;;;2125   		bps[in]._umin_av_cnt--;
001752  1e52              SUBS     r2,r2,#1
001754  b212              SXTH     r2,r2
001756  f8a02046          STRH     r2,[r0,#0x46]
                  |L5.5978|
;;;2126   		if(bps[in]._umin_av_cnt==0)
;;;2127   			{
;;;2128   			bps[in]._umin_av_cnt=0;
;;;2129   		//	avar_bps_hndl(in,2,0);
;;;2130   		//	apv_cnt[in,0]=0;
;;;2131   		//	apv_cnt[in,1]=0;
;;;2132   		//	apv_cnt[in,2]=0;
;;;2133   			}
;;;2134   		}
;;;2135   	else if(bps[in]._umin_av_cnt>10)bps[in]._umin_av_cnt--;	 
;;;2136   	}
;;;2137   
;;;2138   //bps[in]._state=bsOFF;
;;;2139   
;;;2140   if (bps[in]._av&0x0f)					bps[in]._state=bsAV;
00175a  7842              LDRB     r2,[r0,#1]
00175c  0712              LSLS     r2,r2,#28
00175e  d001              BEQ      |L5.5988|
001760  2104              MOVS     r1,#4
001762  e00f              B        |L5.6020|
                  |L5.5988|
;;;2141   else if ( (net_av) && (bps[in]._cnt>20)/*&& 
001764  4ad5              LDR      r2,|L5.6844|
001766  7812              LDRB     r2,[r2,#0]  ; net_av
001768  b122              CBZ      r2,|L5.6004|
00176a  78c2              LDRB     r2,[r0,#3]
00176c  2a14              CMP      r2,#0x14
00176e  d901              BLS      |L5.6004|
;;;2142   		(bps[in]._Uii<200)*/)				bps[in]._state=bsOFF_AV_NET;
001770  2105              MOVS     r1,#5
001772  e007              B        |L5.6020|
                  |L5.6004|
;;;2143   else if (bps[in]._flags_tm&BIN8(100000))	bps[in]._state=bsRDY;
001774  0689              LSLS     r1,r1,#26
001776  d501              BPL      |L5.6012|
001778  2102              MOVS     r1,#2
00177a  e003              B        |L5.6020|
                  |L5.6012|
;;;2144   else if (bps[in]._cnt<20)				bps[in]._state=bsWRK;
00177c  78c1              LDRB     r1,[r0,#3]
00177e  2914              CMP      r1,#0x14
001780  d201              BCS      |L5.6022|
001782  2101              MOVS     r1,#1
                  |L5.6020|
001784  7081              STRB     r1,[r0,#2]
                  |L5.6022|
;;;2145   
;;;2146   
;;;2147   
;;;2148   //else if(bps[in]._flags_tm&BIN8(100000)) bps[in]._state=ssBL;
;;;2149   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))bps[in]._state=ssWRK;
;;;2150   //else bps[0]._state=ssNOT;
;;;2151   
;;;2152   //bps[in]._is_ready=0;
;;;2153   //bps[in]._is_wrk=0;
;;;2154   //if(bps[in]._av_net) bps[in]._flags_bp='N';// не подключен
;;;2155   //else if(bps[in]._av_u_max) bps[in]._flags_bp='P';// завышено напряжение(u_.av_.bAS1T)) bps_state[0]=ssAV;
;;;2156   //else if(bps[in]._av_u_min) bps[in]._flags_bp='M';// занижено напряжение
;;;2157   //else if(bps[in]._av_temper) bps[in]._flags_bp='T';// температура
;;;2158   //else if(bps[in]._flags_tm&BIN8(100000)) 
;;;2159   //	{
;;;2160   //	bps[in]._flags_bp='B';// заблокирован
;;;2161   //	bps[in]._is_ready=1;
;;;2162   //	}
;;;2163   //else if((!(bps[in]._flags_tm&BIN8(100000)))&&(net_U>100))
;;;2164   //     {
;;;2165   //     bps[in]._flags_bp='W';// работает
;;;2166   //     bps[in]._is_ready=1;
;;;2167   //     bps[in]._is_wrk=1;
;;;2168        
;;;2169   //     }
;;;2170   //else bps[in]._is_ready=1;     
;;;2171   
;;;2172   
;;;2173   
;;;2174   
;;;2175   
;;;2176   /*
;;;2177   bps[in]._flags_tu&=BIN8(11111110);
;;;2178   if(bps[in]._ist_blok_cnt)
;;;2179   	{
;;;2180   	bps[in]._ist_blok_cnt--;
;;;2181   	bps[in]._flags_tu|=BIN8(1);
;;;2182   	}
;;;2183   
;;;2184   	   */ 
;;;2185   
;;;2186   //Пересброс БПСа при потере связи
;;;2187   if(bps[in]._cnt>=10) bps[in]._flags_tu|=BIN8(10000000);
001786  78c1              LDRB     r1,[r0,#3]
001788  290a              CMP      r1,#0xa
;;;2188   else bps[in]._flags_tu&=BIN8(1111111);
00178a  f8901028          LDRB     r1,[r0,#0x28]
00178e  d302              BCC      |L5.6038|
001790  f0410180          ORR      r1,r1,#0x80           ;2187
001794  e001              B        |L5.6042|
                  |L5.6038|
001796  f001017f          AND      r1,r1,#0x7f
                  |L5.6042|
00179a  f8801028          STRB     r1,[r0,#0x28]
;;;2189   	
;;;2190   bps[in]._vol_u=cntrl_stat_U;	
00179e  49c8              LDR      r1,|L5.6848|
0017a0  f9b12010          LDRSH    r2,[r1,#0x10]  ; cntrl_stat_U
;;;2191   bps[in]._vol_i=cntrl_stat_I;
0017a4  62c2              STR      r2,[r0,#0x2c]
0017a6  f9b11012          LDRSH    r1,[r1,#0x12]  ; cntrl_stat_I
0017aa  6301              STR      r1,[r0,#0x30]
                  |L5.6060|
;;;2192    
;;;2193   }
0017ac  bd10              POP      {r4,pc}
;;;2194   
                          ENDP

                  volt_contr_hndl PROC
;;;2207   //-----------------------------------------------
;;;2208   void volt_contr_hndl(void)
0017ae  e92d47f0          PUSH     {r4-r10,lr}
;;;2209   {
;;;2210   if(work_stat==wsOFF)
0017b2  48c4              LDR      r0,|L5.6852|
;;;2211   	{
;;;2212   	cnt_volt_contr=0;
;;;2213   	}
;;;2214   else 
;;;2215   	{
;;;2216   	if(cnt_volt_contr<(T_DEL_REL_VOLT_START*10))
0017b4  4ec4              LDR      r6,|L5.6856|
0017b6  4cc2              LDR      r4,|L5.6848|
0017b8  7800              LDRB     r0,[r0,#0]            ;2210  ; work_stat
0017ba  2500              MOVS     r5,#0                 ;2210
0017bc  b310              CBZ      r0,|L5.6148|
0017be  f9b60000          LDRSH    r0,[r6,#0]  ; T_DEL_REL_VOLT_START
0017c2  eb000180          ADD      r1,r0,r0,LSL #2
0017c6  f9b40024          LDRSH    r0,[r4,#0x24]  ; cnt_volt_contr
0017ca  ebb00f41          CMP      r0,r1,LSL #1
0017ce  da01              BGE      |L5.6100|
;;;2217   		{
;;;2218   		cnt_volt_contr++;
0017d0  1c40              ADDS     r0,r0,#1
0017d2  84a0              STRH     r0,[r4,#0x24]
                  |L5.6100|
;;;2219   		}
;;;2220   	}
;;;2221   
;;;2222   	
;;;2223   	if(load_U>REL_VOLT_UMIN*10)
0017d4  48bd              LDR      r0,|L5.6860|
0017d6  f8df82f8          LDR      r8,|L5.6864|
;;;2224   		{
;;;2225   		cnt_rel_volt_umin++;
;;;2226   		gran(&cnt_rel_volt_umin,0,30000);
0017da  f2475a30          MOV      r10,#0x7530
0017de  f9b00000          LDRSH    r0,[r0,#0]            ;2223  ; REL_VOLT_UMIN
0017e2  eb000180          ADD      r1,r0,r0,LSL #2       ;2223
0017e6  f9b80000          LDRSH    r0,[r8,#0]            ;2223  ; load_U
0017ea  ebb00f41          CMP      r0,r1,LSL #1          ;2223
0017ee  dd0b              BLE      |L5.6152|
0017f0  8ce0              LDRH     r0,[r4,#0x26]         ;2225  ; cnt_rel_volt_umin
0017f2  4652              MOV      r2,r10
0017f4  1c40              ADDS     r0,r0,#1              ;2225
0017f6  84e0              STRH     r0,[r4,#0x26]         ;2225
0017f8  48b1              LDR      r0,|L5.6848|
0017fa  2100              MOVS     r1,#0
0017fc  3026              ADDS     r0,r0,#0x26
0017fe  f7fffffe          BL       gran
001802  e002              B        |L5.6154|
                  |L5.6148|
001804  84a5              STRH     r5,[r4,#0x24]         ;2212
001806  e7e5              B        |L5.6100|
                  |L5.6152|
;;;2227   		}
;;;2228   	else cnt_rel_volt_umin=0;
001808  84e5              STRH     r5,[r4,#0x26]
                  |L5.6154|
;;;2229   	if((cnt_rel_volt_umin>=T_DEL_REL_VOLT_WRK*10)&&(cnt_volt_contr>=(T_DEL_REL_VOLT_START*10))) 	bVOLT_IS_NOT_DOWN=1;
00180a  f8df92c8          LDR      r9,|L5.6868|
00180e  2701              MOVS     r7,#1
001810  f9b90000          LDRSH    r0,[r9,#0]  ; T_DEL_REL_VOLT_WRK
001814  eb000180          ADD      r1,r0,r0,LSL #2
001818  f9b40026          LDRSH    r0,[r4,#0x26]  ; cnt_rel_volt_umin
00181c  ebb00f41          CMP      r0,r1,LSL #1
001820  db0a              BLT      |L5.6200|
001822  f9b61000          LDRSH    r1,[r6,#0]  ; T_DEL_REL_VOLT_START
001826  f9b42024          LDRSH    r2,[r4,#0x24]  ; cnt_volt_contr
00182a  eb010181          ADD      r1,r1,r1,LSL #2
00182e  ebb20f41          CMP      r2,r1,LSL #1
001832  db01              BLT      |L5.6200|
001834  7327              STRB     r7,[r4,#0xc]
001836  e001              B        |L5.6204|
                  |L5.6200|
;;;2230   	else if(cnt_rel_volt_umin==0)							  							bVOLT_IS_NOT_DOWN=0;
001838  b900              CBNZ     r0,|L5.6204|
00183a  7325              STRB     r5,[r4,#0xc]
                  |L5.6204|
;;;2231   
;;;2232   	if(load_U<REL_VOLT_UMAX*10)
00183c  48a6              LDR      r0,|L5.6872|
00183e  f9b00000          LDRSH    r0,[r0,#0]  ; REL_VOLT_UMAX
001842  eb000180          ADD      r1,r0,r0,LSL #2
001846  f9b80000          LDRSH    r0,[r8,#0]  ; load_U
00184a  ebb00f41          CMP      r0,r1,LSL #1
00184e  da09              BGE      |L5.6244|
;;;2233   		{
;;;2234   		cnt_rel_volt_umax++;
001850  8d20              LDRH     r0,[r4,#0x28]  ; cnt_rel_volt_umax
;;;2235   		gran(&cnt_rel_volt_umax,0,30000);
001852  4652              MOV      r2,r10
001854  1c40              ADDS     r0,r0,#1              ;2234
001856  8520              STRH     r0,[r4,#0x28]         ;2234
001858  4899              LDR      r0,|L5.6848|
00185a  2100              MOVS     r1,#0
00185c  3028              ADDS     r0,r0,#0x28
00185e  f7fffffe          BL       gran
001862  e000              B        |L5.6246|
                  |L5.6244|
;;;2236   		}
;;;2237   	else cnt_rel_volt_umax=0;
001864  8525              STRH     r5,[r4,#0x28]
                  |L5.6246|
;;;2238   	if((cnt_rel_volt_umax>=T_DEL_REL_VOLT_WRK*10)&&(cnt_volt_contr>=(T_DEL_REL_VOLT_START*10))) 	bVOLT_IS_NOT_UP=1;
001866  f9b90000          LDRSH    r0,[r9,#0]  ; T_DEL_REL_VOLT_WRK
00186a  eb000180          ADD      r1,r0,r0,LSL #2
00186e  f9b40028          LDRSH    r0,[r4,#0x28]  ; cnt_rel_volt_umax
001872  ebb00f41          CMP      r0,r1,LSL #1
001876  db0a              BLT      |L5.6286|
001878  f9b61000          LDRSH    r1,[r6,#0]  ; T_DEL_REL_VOLT_START
00187c  f9b42024          LDRSH    r2,[r4,#0x24]  ; cnt_volt_contr
001880  eb010181          ADD      r1,r1,r1,LSL #2
001884  ebb20f41          CMP      r2,r1,LSL #1
001888  db01              BLT      |L5.6286|
00188a  7367              STRB     r7,[r4,#0xd]
00188c  e002              B        |L5.6292|
                  |L5.6286|
;;;2239   	else if(cnt_rel_volt_umax==0)							  							bVOLT_IS_NOT_UP=0;
00188e  b130              CBZ      r0,|L5.6302|
;;;2240   	
;;;2241   	if(bVOLT_IS_NOT_UP && bVOLT_IS_NOT_DOWN) bVOLT_IS_NORM=1;
001890  7b60              LDRB     r0,[r4,#0xd]  ; bVOLT_IS_NOT_UP
001892  b128              CBZ      r0,|L5.6304|
                  |L5.6292|
001894  7b20              LDRB     r0,[r4,#0xc]  ; bVOLT_IS_NOT_DOWN
001896  b118              CBZ      r0,|L5.6304|
001898  73a7              STRB     r7,[r4,#0xe]
                  |L5.6298|
;;;2242   	else bVOLT_IS_NORM=0;
;;;2243   
;;;2244   
;;;2245   }
00189a  e8bd87f0          POP      {r4-r10,pc}
                  |L5.6302|
00189e  7365              STRB     r5,[r4,#0xd]          ;2239
                  |L5.6304|
0018a0  73a5              STRB     r5,[r4,#0xe]          ;2242
0018a2  e7fa              B        |L5.6298|
;;;2246   
                          ENDP

                  current_stab_hndl PROC
;;;2247   //-----------------------------------------------
;;;2248   void current_stab_hndl(void)
0018a4  e92d5ff0          PUSH     {r4-r12,lr}
;;;2249   {
;;;2250   
;;;2251   if(work_stat==wsPS)
0018a8  4886              LDR      r0,|L5.6852|
;;;2252   	{
;;;2253   	delta_U_abs=abs_pal(load_U-U_up);
0018aa  f8df8230          LDR      r8,|L5.6876|
;;;2254   	delta_U_rel=(delta_U_abs*100)/U_up;
;;;2255   
;;;2256   	delta_I_abs=abs_pal(load_I-I_maxp);
0018ae  f8dfb230          LDR      r11,|L5.6880|
0018b2  7801              LDRB     r1,[r0,#0]            ;2251  ; work_stat
0018b4  4886              LDR      r0,|L5.6864|
0018b6  f8dfa22c          LDR      r10,|L5.6884|
0018ba  4d8b              LDR      r5,|L5.6888|
0018bc  f9b00000          LDRSH    r0,[r0,#0]            ;2253
;;;2257   	delta_I_rel=(delta_I_abs*100)/I_maxp;
0018c0  4e8a              LDR      r6,|L5.6892|
;;;2258   	}
;;;2259   
;;;2260   else if(work_stat==wsGS)
;;;2261   	{
;;;2262   	delta_U_abs=abs_pal(load_U-U_maxg);
;;;2263   	delta_U_rel=(delta_U_abs*100)/U_maxg;
;;;2264   
;;;2265   	delta_I_abs=abs_pal(load_I-I_ug_temp);
;;;2266   	delta_I_rel=(delta_I_abs*100)/I_ug_temp;
;;;2267   	}
;;;2268   else 
;;;2269   	{
;;;2270   	cnt_del_rel=0;
0018c2  2700              MOVS     r7,#0
0018c4  4c8a              LDR      r4,|L5.6896|
0018c6  2902              CMP      r1,#2                 ;2251
0018c8  d011              BEQ      |L5.6382|
0018ca  2901              CMP      r1,#1                 ;2260
0018cc  d025              BEQ      |L5.6426|
0018ce  8027              STRH     r7,[r4,#0]
                  |L5.6352|
;;;2271   	}
;;;2272   
;;;2273   if((delta_U_rel>DELT_REL_CURR_U)&&(delta_I_rel<DELT_REL_CURR_I))
0018d0  4988              LDR      r1,|L5.6900|
0018d2  6828              LDR      r0,[r5,#0]  ; delta_U_rel
0018d4  f9b11000          LDRSH    r1,[r1,#0]  ; DELT_REL_CURR_U
0018d8  4288              CMP      r0,r1
0018da  dd43              BLE      |L5.6500|
0018dc  4986              LDR      r1,|L5.6904|
0018de  6830              LDR      r0,[r6,#0]  ; delta_I_rel
0018e0  f9b11000          LDRSH    r1,[r1,#0]  ; DELT_REL_CURR_I
0018e4  4288              CMP      r0,r1
0018e6  da3d              BGE      |L5.6500|
;;;2274   	{
;;;2275   	cnt_del_rel++;
0018e8  8820              LDRH     r0,[r4,#0]  ; cnt_del_rel
0018ea  1c40              ADDS     r0,r0,#1
0018ec  e03c              B        |L5.6504|
                  |L5.6382|
0018ee  f8df920c          LDR      r9,|L5.6908|
0018f2  f8b91000          LDRH     r1,[r9,#0]            ;2253  ; U_up
0018f6  1a40              SUBS     r0,r0,r1              ;2253
0018f8  b200              SXTH     r0,r0                 ;2253
0018fa  f7fffffe          BL       abs_pal
0018fe  f8c80000          STR      r0,[r8,#0]            ;2254  ; delta_U_abs
001902  2164              MOVS     r1,#0x64              ;2254
001904  4348              MULS     r0,r1,r0              ;2254
001906  f9b91000          LDRSH    r1,[r9,#0]            ;2254  ; U_up
00190a  f8df81f4          LDR      r8,|L5.6912|
00190e  fb90f0f1          SDIV     r0,r0,r1              ;2254
001912  6028              STR      r0,[r5,#0]            ;2256  ; delta_U_rel
001914  f8bb1000          LDRH     r1,[r11,#0]           ;2256  ; load_I
001918  e014              B        |L5.6468|
                  |L5.6426|
00191a  f8df91e8          LDR      r9,|L5.6916|
00191e  f8b91000          LDRH     r1,[r9,#0]            ;2262  ; U_maxg
001922  1a40              SUBS     r0,r0,r1              ;2262
001924  b200              SXTH     r0,r0                 ;2262
001926  f7fffffe          BL       abs_pal
00192a  f8c80000          STR      r0,[r8,#0]            ;2263  ; delta_U_abs
00192e  2164              MOVS     r1,#0x64              ;2263
001930  4348              MULS     r0,r1,r0              ;2263
001932  f9b91000          LDRSH    r1,[r9,#0]            ;2263  ; U_maxg
001936  f8df81d0          LDR      r8,|L5.6920|
00193a  fb90f0f1          SDIV     r0,r0,r1              ;2263
00193e  6028              STR      r0,[r5,#0]            ;2265  ; delta_U_rel
001940  f8bb1000          LDRH     r1,[r11,#0]           ;2265  ; load_I
                  |L5.6468|
001944  f8b80000          LDRH     r0,[r8,#0]            ;2265  ; I_ug_temp
001948  1a08              SUBS     r0,r1,r0              ;2265
00194a  b200              SXTH     r0,r0                 ;2265
00194c  f7fffffe          BL       abs_pal
001950  2164              MOVS     r1,#0x64              ;2266
001952  f8ca0000          STR      r0,[r10,#0]           ;2266  ; delta_I_abs
001956  4348              MULS     r0,r1,r0              ;2266
001958  f9b81000          LDRSH    r1,[r8,#0]            ;2266  ; I_ug_temp
00195c  fb90f0f1          SDIV     r0,r0,r1              ;2266
001960  6030              STR      r0,[r6,#0]            ;2266  ; delta_I_rel
001962  e7b5              B        |L5.6352|
                  |L5.6500|
;;;2276   	}
;;;2277   else
;;;2278   	{
;;;2279   	cnt_del_rel--;
001964  8820              LDRH     r0,[r4,#0]  ; cnt_del_rel
001966  1e40              SUBS     r0,r0,#1
                  |L5.6504|
;;;2280   	}
;;;2281   
;;;2282   gran(&cnt_del_rel,0,(T_DEL_REL_CURR_WRK*10)+10);
001968  4d68              LDR      r5,|L5.6924|
00196a  8020              STRH     r0,[r4,#0]            ;2279
00196c  210a              MOVS     r1,#0xa
00196e  8828              LDRH     r0,[r5,#0]  ; T_DEL_REL_CURR_WRK
001970  eb000080          ADD      r0,r0,r0,LSL #2
001974  eb010040          ADD      r0,r1,r0,LSL #1
001978  b202              SXTH     r2,r0
00197a  2100              MOVS     r1,#0
00197c  485c              LDR      r0,|L5.6896|
00197e  f7fffffe          BL       gran
;;;2283   
;;;2284   if(work_stat==wsOFF) cnt_del_rel=0;
001982  4850              LDR      r0,|L5.6852|
001984  7800              LDRB     r0,[r0,#0]  ; work_stat
001986  b900              CBNZ     r0,|L5.6538|
001988  8027              STRH     r7,[r4,#0]
                  |L5.6538|
;;;2285   
;;;2286   
;;;2287   if ( (time_proc>=(T_DEL_REL_CURR_START)) &&
00198a  4861              LDR      r0,|L5.6928|
00198c  4961              LDR      r1,|L5.6932|
;;;2288   	(cnt_del_rel>(T_DEL_REL_CURR_WRK*10)) )
;;;2289   	{
;;;2290   	bCURRENT_STAB=1;
00198e  4a62              LDR      r2,|L5.6936|
001990  6800              LDR      r0,[r0,#0]            ;2287  ; time_proc
001992  f9b11000          LDRSH    r1,[r1,#0]            ;2287  ; T_DEL_REL_CURR_START
001996  4288              CMP      r0,r1                 ;2287
001998  db0a              BLT      |L5.6576|
00199a  f9b53000          LDRSH    r3,[r5,#0]            ;2288  ; T_DEL_REL_CURR_WRK
00199e  f9b46000          LDRSH    r6,[r4,#0]            ;2288  ; cnt_del_rel
0019a2  eb030383          ADD      r3,r3,r3,LSL #2       ;2288
0019a6  ebb60f43          CMP      r6,r3,LSL #1          ;2288
0019aa  dd01              BLE      |L5.6576|
0019ac  2301              MOVS     r3,#1
0019ae  7013              STRB     r3,[r2,#0]
                  |L5.6576|
;;;2291   	}
;;;2292   if ( (time_proc<(T_DEL_REL_CURR_START)) ||
0019b0  4288              CMP      r0,r1
0019b2  db08              BLT      |L5.6598|
;;;2293   	(cnt_del_rel<=(T_DEL_REL_CURR_WRK*10)) )
0019b4  f9b50000          LDRSH    r0,[r5,#0]  ; T_DEL_REL_CURR_WRK
0019b8  f9b41000          LDRSH    r1,[r4,#0]  ; cnt_del_rel
0019bc  eb000080          ADD      r0,r0,r0,LSL #2
0019c0  ebb10f40          CMP      r1,r0,LSL #1
0019c4  dc00              BGT      |L5.6600|
                  |L5.6598|
;;;2294   	{
;;;2295   	bCURRENT_STAB=0;
0019c6  7017              STRB     r7,[r2,#0]
                  |L5.6600|
;;;2296   	}
;;;2297   
;;;2298   /*
;;;2299   SET_REG(LPC_PINCON->PINSEL0,0,5*2,2);
;;;2300   SET_REG(LPC_GPIO0->FIODIR,1,5,1);
;;;2301   //SET_REG(LPC_GPIO0->FIOSET,1,5,1);
;;;2302   
;;;2303   if(RELE_LOG_CURR==0)
;;;2304   	{
;;;2305   	SET_REG(LPC_GPIO0->FIOPIN,1,5,1);
;;;2306   	}
;;;2307   else if(RELE_LOG_CURR==1)
;;;2308   	{
;;;2309   	if(bCURRENT_STAB==0)SET_REG(LPC_GPIO0->FIOPIN,0,5,1);
;;;2310   	else SET_REG(LPC_GPIO0->FIOPIN,1,5,1);
;;;2311   	}
;;;2312   else
;;;2313   	{
;;;2314   	if(bCURRENT_STAB==0)SET_REG(LPC_GPIO0->FIOPIN,1,5,1);
;;;2315   	else SET_REG(LPC_GPIO0->FIOPIN,0,5,1);
;;;2316   	}*/
;;;2317   
;;;2318   }
0019c8  e8bd9ff0          POP      {r4-r12,pc}
;;;2319   
                          ENDP

                  rele_hndl PROC
;;;2343   //-----------------------------------------------
;;;2344   void rele_hndl(void)
0019cc  e92d4ff0          PUSH     {r4-r11,lr}
;;;2345   {
;;;2346   //Реле1
;;;2347   if(RELE_FUNC[0]==0)rele_stat[0]=rsOFF; 		//Выключено
;;;2348   else if(RELE_FUNC[0]==1)					//Реверс
;;;2349   	{
;;;2350   	if(work_stat==wsCAP) 
0019d0  483c              LDR      r0,|L5.6852|
;;;2351   		{
;;;2352   		if(bRAZR) rele_stat[0]=rsOFF;
;;;2353   		else 	rele_stat[0]=rsON;
;;;2354   		} 
;;;2355   	else 
;;;2356   		{
;;;2357   		if(REV_STAT==rsREW)	rele_stat[0]=rsOFF;
;;;2358   		else 			rele_stat[0]=rsON;
;;;2359   		}
;;;2360   	}
;;;2361   else if(RELE_FUNC[0]==2)					//Токоограничение
;;;2362   	{
;;;2363   	if(RELE_LOG_CURR==0)
0019d2  4b55              LDR      r3,|L5.6952|
0019d4  f8dfe144          LDR      lr,|L5.6940|
0019d8  f890c000          LDRB     r12,[r0,#0]           ;2350
0019dc  4850              LDR      r0,|L5.6944|
0019de  f9b36000          LDRSH    r6,[r3,#0]
;;;2364   		{
;;;2365   		if(bCURRENT_STAB==0)	rele_stat[0]=rsON;
;;;2366   		else 				rele_stat[0]=rsOFF;
;;;2367   		}
;;;2368   	else if(RELE_LOG_CURR==1)
;;;2369   		{
;;;2370   		if(bCURRENT_STAB==0)	rele_stat[0]=rsOFF;
;;;2371   		else 				rele_stat[0]=rsON;
;;;2372   		}
;;;2373   	}									
;;;2374   else if(RELE_FUNC[0]==3)					//Напряжение в норме
;;;2375   	{
;;;2376   	if(RELE_LOG_VOLT==0)
0019e2  4b52              LDR      r3,|L5.6956|
0019e4  7800              LDRB     r0,[r0,#0]            ;2352
0019e6  f9be4000          LDRSH    r4,[lr,#0]            ;2347  ; RELE_FUNC
0019ea  4682              MOV      r10,r0                ;2352
0019ec  484d              LDR      r0,|L5.6948|
0019ee  2100              MOVS     r1,#0                 ;2347
0019f0  f9b33000          LDRSH    r3,[r3,#0]
0019f4  7800              LDRB     r0,[r0,#0]            ;2357
0019f6  4683              MOV      r11,r0                ;2357
0019f8  4847              LDR      r0,|L5.6936|
0019fa  7805              LDRB     r5,[r0,#0]            ;2365
;;;2377   		{
;;;2378   		if(bVOLT_IS_NORM==0)	rele_stat[0]=rsON;
0019fc  4830              LDR      r0,|L5.6848|
0019fe  7b87              LDRB     r7,[r0,#0xe]
;;;2379   		else 				rele_stat[0]=rsOFF;
;;;2380   		}
;;;2381   	else if(RELE_LOG_VOLT==1)
;;;2382   		{
;;;2383   		if(bVOLT_IS_NORM==0)	rele_stat[0]=rsOFF;
;;;2384   		else 				rele_stat[0]=rsON;
;;;2385   		}
;;;2386   	}
;;;2387   else if(RELE_FUNC[0]==4)					//Напряжение не выше
;;;2388   	{
;;;2389   	if(RELE_LOG_VOLT==0)
;;;2390   		{
;;;2391   		if(bVOLT_IS_NOT_UP==0)	rele_stat[0]=rsON;
001a00  f890800d          LDRB     r8,[r0,#0xd]
;;;2392   		else 				rele_stat[0]=rsOFF;
;;;2393   		}
;;;2394   	else if(RELE_LOG_VOLT==1)
;;;2395   		{
;;;2396   		if(bVOLT_IS_NOT_UP==0)	rele_stat[0]=rsOFF;
;;;2397   		else 				rele_stat[0]=rsON;
;;;2398   		}
;;;2399   	}
;;;2400   else if(RELE_FUNC[0]==5)					//Напряжение не ниже
;;;2401   	{
;;;2402   	if(RELE_LOG_VOLT==0)
;;;2403   		{
;;;2404   		if(bVOLT_IS_NOT_DOWN==0)	rele_stat[0]=rsON;
001a04  7b00              LDRB     r0,[r0,#0xc]
001a06  4681              MOV      r9,r0
001a08  482d              LDR      r0,|L5.6848|
001a0a  302a              ADDS     r0,r0,#0x2a           ;2347
001a0c  2201              MOVS     r2,#1                 ;2347
001a0e  b314              CBZ      r4,|L5.6742|
001a10  2c01              CMP      r4,#1                 ;2348
001a12  d008              BEQ      |L5.6694|
001a14  2c02              CMP      r4,#2                 ;2361
001a16  d011              BEQ      |L5.6716|
001a18  2c03              CMP      r4,#3                 ;2374
001a1a  d017              BEQ      |L5.6732|
001a1c  2c04              CMP      r4,#4                 ;2387
001a1e  d01d              BEQ      |L5.6748|
001a20  2c05              CMP      r4,#5                 ;2400
001a22  d027              BEQ      |L5.6772|
001a24  e032              B        |L5.6796|
                  |L5.6694|
001a26  f1bc0f03          CMP      r12,#3                ;2350
001a2a  d003              BEQ      |L5.6708|
001a2c  f1bb0f00          CMP      r11,#0                ;2357
001a30  d011              BEQ      |L5.6742|
001a32  e02a              B        |L5.6794|
                  |L5.6708|
001a34  f1ba0f00          CMP      r10,#0                ;2352
001a38  d17c              BNE      |L5.6964|
001a3a  e026              B        |L5.6794|
                  |L5.6716|
001a3c  b116              CBZ      r6,|L5.6724|
001a3e  2e01              CMP      r6,#1                 ;2368
001a40  d002              BEQ      |L5.6728|
001a42  e023              B        |L5.6796|
                  |L5.6724|
001a44  b30d              CBZ      r5,|L5.6794|
001a46  e075              B        |L5.6964|
                  |L5.6728|
001a48  b12d              CBZ      r5,|L5.6742|
001a4a  e01e              B        |L5.6794|
                  |L5.6732|
001a4c  b113              CBZ      r3,|L5.6740|
001a4e  2b01              CMP      r3,#1                 ;2381
001a50  d002              BEQ      |L5.6744|
001a52  e01b              B        |L5.6796|
                  |L5.6740|
001a54  b1cf              CBZ      r7,|L5.6794|
                  |L5.6742|
001a56  e06d              B        |L5.6964|
                  |L5.6744|
001a58  b35f              CBZ      r7,|L5.6834|
001a5a  e016              B        |L5.6794|
                  |L5.6748|
001a5c  b113              CBZ      r3,|L5.6756|
001a5e  2b01              CMP      r3,#1                 ;2394
001a60  d004              BEQ      |L5.6764|
001a62  e013              B        |L5.6796|
                  |L5.6756|
001a64  f1b80f00          CMP      r8,#0                 ;2391
001a68  d00f              BEQ      |L5.6794|
001a6a  e063              B        |L5.6964|
                  |L5.6764|
001a6c  f1b80f00          CMP      r8,#0                 ;2396
001a70  d060              BEQ      |L5.6964|
001a72  e00a              B        |L5.6794|
                  |L5.6772|
001a74  b113              CBZ      r3,|L5.6780|
;;;2405   		else 				rele_stat[0]=rsOFF;
;;;2406   		}
;;;2407   	else if(RELE_LOG_VOLT==1)
001a76  2b01              CMP      r3,#1
001a78  d004              BEQ      |L5.6788|
001a7a  e007              B        |L5.6796|
                  |L5.6780|
001a7c  f1b90f00          CMP      r9,#0                 ;2404
001a80  d003              BEQ      |L5.6794|
001a82  e057              B        |L5.6964|
                  |L5.6788|
;;;2408   		{
;;;2409   		if(bVOLT_IS_NOT_DOWN==0)	rele_stat[0]=rsOFF;
001a84  f1b90f00          CMP      r9,#0
001a88  d054              BEQ      |L5.6964|
                  |L5.6794|
;;;2410   		else 				rele_stat[0]=rsON;
001a8a  7002              STRB     r2,[r0,#0]
                  |L5.6796|
;;;2411   		}
;;;2412   	}
;;;2413   											
;;;2414   //Реле2
;;;2415   if(RELE_FUNC[1]==0)rele_stat[1]=rsOFF; 		//Выключено
001a8c  f9be4002          LDRSH    r4,[lr,#2]  ; RELE_FUNC
001a90  b184              CBZ      r4,|L5.6836|
;;;2416   else if(RELE_FUNC[1]==1)					//Реверс
001a92  2c01              CMP      r4,#1
001a94  d053              BEQ      |L5.6974|
;;;2417   	{
;;;2418   	if(work_stat==wsCAP) 
;;;2419   		{
;;;2420   		if(bRAZR) 		rele_stat[1]=rsOFF;
;;;2421   		else 			rele_stat[1]=rsON;
;;;2422   		} 
;;;2423   	else 
;;;2424   		{
;;;2425   		if(REV_STAT==rsREW)	rele_stat[1]=rsOFF;
;;;2426   		else 			rele_stat[1]=rsON;
;;;2427   		}
;;;2428   	}
;;;2429   else if(RELE_FUNC[1]==2)					//Токоограничение
001a96  2c02              CMP      r4,#2
001a98  d05d              BEQ      |L5.6998|
;;;2430   	{
;;;2431   	if(RELE_LOG_CURR==0)
;;;2432   		{
;;;2433   		if(bCURRENT_STAB==0)rele_stat[1]=rsON;
;;;2434   		else 			rele_stat[1]=rsOFF;
;;;2435   		}
;;;2436   	else if(RELE_LOG_CURR==1)
;;;2437   		{
;;;2438   		if(bCURRENT_STAB==0)rele_stat[1]=rsOFF;
;;;2439   		else 			rele_stat[1]=rsON;
;;;2440   		}
;;;2441   	}									
;;;2442   else if(RELE_FUNC[1]==3)					//Напряжение в норме
001a9a  2c03              CMP      r4,#3
001a9c  d064              BEQ      |L5.7016|
;;;2443   	{
;;;2444   	if(RELE_LOG_VOLT==0)
;;;2445   		{
;;;2446   		if(bVOLT_IS_NORM==0)	rele_stat[1]=rsON;
;;;2447   		else 				rele_stat[1]=rsOFF;
;;;2448   		}
;;;2449   	else if(RELE_LOG_VOLT==1)
;;;2450   		{
;;;2451   		if(bVOLT_IS_NORM==0)	rele_stat[1]=rsOFF;
;;;2452   		else 				rele_stat[1]=rsON;
;;;2453   		}
;;;2454   	}
;;;2455   else if(RELE_FUNC[1]==4)					//Напряжение не выше
001a9e  2c04              CMP      r4,#4
001aa0  d06b              BEQ      |L5.7034|
;;;2456   	{
;;;2457   	if(RELE_LOG_VOLT==0)
;;;2458   		{
;;;2459   		if(bVOLT_IS_NOT_UP==0)	rele_stat[1]=rsON;
;;;2460   		else 				rele_stat[1]=rsOFF;
;;;2461   		}
;;;2462   	else if(RELE_LOG_VOLT==1)
;;;2463   		{
;;;2464   		if(bVOLT_IS_NOT_UP==0)	rele_stat[1]=rsOFF;
;;;2465   		else 				rele_stat[1]=rsON;
;;;2466   		}
;;;2467   	}
;;;2468   else if(RELE_FUNC[1]==5)					//Напряжение не ниже
001aa2  2c05              CMP      r4,#5
001aa4  d149              BNE      |L5.6970|
;;;2469   	{
;;;2470   	if(RELE_LOG_VOLT==0)
001aa6  b133              CBZ      r3,|L5.6838|
;;;2471   		{
;;;2472   		if(bVOLT_IS_NOT_DOWN==0)	rele_stat[1]=rsON;
;;;2473   		else 				rele_stat[1]=rsOFF;
;;;2474   		}
;;;2475   	else if(RELE_LOG_VOLT==1)
001aa8  2b01              CMP      r3,#1
001aaa  d146              BNE      |L5.6970|
;;;2476   		{
;;;2477   		if(bVOLT_IS_NOT_DOWN==0)	rele_stat[1]=rsOFF;
001aac  f1b90f00          CMP      r9,#0
001ab0  e03e              B        |L5.6960|
                  |L5.6834|
001ab2  e03f              B        |L5.6964|
                  |L5.6836|
001ab4  e040              B        |L5.6968|
                  |L5.6838|
001ab6  e06b              B        |L5.7056|
                  |L5.6840|
                          DCD      bps
                  |L5.6844|
                          DCD      net_av
                  |L5.6848|
                          DCD      ||area_number.25||
                  |L5.6852|
                          DCD      work_stat
                  |L5.6856|
                          DCD      T_DEL_REL_VOLT_START
                  |L5.6860|
                          DCD      REL_VOLT_UMIN
                  |L5.6864|
                          DCD      load_U
                  |L5.6868|
                          DCD      T_DEL_REL_VOLT_WRK
                  |L5.6872|
                          DCD      REL_VOLT_UMAX
                  |L5.6876|
                          DCD      delta_U_abs
                  |L5.6880|
                          DCD      load_I
                  |L5.6884|
                          DCD      delta_I_abs
                  |L5.6888|
                          DCD      delta_U_rel
                  |L5.6892|
                          DCD      delta_I_rel
                  |L5.6896|
                          DCD      cnt_del_rel
                  |L5.6900|
                          DCD      DELT_REL_CURR_U
                  |L5.6904|
                          DCD      DELT_REL_CURR_I
                  |L5.6908|
                          DCD      U_up
                  |L5.6912|
                          DCD      I_maxp
                  |L5.6916|
                          DCD      U_maxg
                  |L5.6920|
                          DCD      I_ug_temp
                  |L5.6924|
                          DCD      T_DEL_REL_CURR_WRK
                  |L5.6928|
                          DCD      time_proc
                  |L5.6932|
                          DCD      T_DEL_REL_CURR_START
                  |L5.6936|
                          DCD      bCURRENT_STAB
                  |L5.6940|
                          DCD      RELE_FUNC
                  |L5.6944|
                          DCD      bRAZR
                  |L5.6948|
                          DCD      REV_STAT
                  |L5.6952|
                          DCD      RELE_LOG_CURR
                  |L5.6956|
                          DCD      RELE_LOG_VOLT
                  |L5.6960|
001b30  d10b              BNE      |L5.6986|
001b32  e001              B        |L5.6968|
                  |L5.6964|
001b34  7001              STRB     r1,[r0,#0]            ;2409
001b36  e7a9              B        |L5.6796|
                  |L5.6968|
001b38  7041              STRB     r1,[r0,#1]            ;2415
                  |L5.6970|
;;;2478   		else 				rele_stat[1]=rsON;
;;;2479   		}
;;;2480   	}
;;;2481   	
;;;2482   
;;;2483   //rele_stat[0]=rsON;
;;;2484   //rele_stat[1]=rsON;
;;;2485   										
;;;2486   }
001b3a  e8bd8ff0          POP      {r4-r11,pc}
                  |L5.6974|
001b3e  f1bc0f03          CMP      r12,#3                ;2418
001b42  d004              BEQ      |L5.6990|
001b44  f1bb0f00          CMP      r11,#0                ;2425
001b48  d0f6              BEQ      |L5.6968|
                  |L5.6986|
001b4a  7042              STRB     r2,[r0,#1]            ;2426
001b4c  e7f5              B        |L5.6970|
                  |L5.6990|
001b4e  f1ba0f00          CMP      r10,#0                ;2420
001b52  d1f1              BNE      |L5.6968|
001b54  e7f9              B        |L5.6986|
                  |L5.6998|
001b56  b126              CBZ      r6,|L5.7010|
001b58  2e01              CMP      r6,#1                 ;2436
001b5a  d1ee              BNE      |L5.6970|
001b5c  2d00              CMP      r5,#0                 ;2438
001b5e  d1f4              BNE      |L5.6986|
001b60  e7ea              B        |L5.6968|
                  |L5.7010|
001b62  2d00              CMP      r5,#0                 ;2433
001b64  d0f1              BEQ      |L5.6986|
001b66  e7e7              B        |L5.6968|
                  |L5.7016|
001b68  b123              CBZ      r3,|L5.7028|
001b6a  2b01              CMP      r3,#1                 ;2449
001b6c  d1e5              BNE      |L5.6970|
001b6e  2f00              CMP      r7,#0                 ;2451
001b70  d1eb              BNE      |L5.6986|
001b72  e7e1              B        |L5.6968|
                  |L5.7028|
001b74  2f00              CMP      r7,#0                 ;2446
001b76  d0e8              BEQ      |L5.6986|
001b78  e7de              B        |L5.6968|
                  |L5.7034|
001b7a  b12b              CBZ      r3,|L5.7048|
001b7c  2b01              CMP      r3,#1                 ;2462
001b7e  d1dc              BNE      |L5.6970|
001b80  f1b80f00          CMP      r8,#0                 ;2464
001b84  d1e1              BNE      |L5.6986|
001b86  e7d7              B        |L5.6968|
                  |L5.7048|
001b88  f1b80f00          CMP      r8,#0                 ;2459
001b8c  d0dd              BEQ      |L5.6986|
001b8e  e7d3              B        |L5.6968|
                  |L5.7056|
001b90  f1b90f00          CMP      r9,#0                 ;2472
001b94  d0d9              BEQ      |L5.6986|
001b96  e7cf              B        |L5.6968|
;;;2487    
                          ENDP

                  rele_drv PROC
;;;2488   //-----------------------------------------------
;;;2489   void rele_drv(void)
001b98  4913              LDR      r1,|L5.7144|
;;;2490   {
;;;2491   #ifdef EXT_BOARD_V_1
;;;2492   SET_REG(LPC_PINCON->PINSEL0,0,4*2,2);
;;;2493   SET_REG(LPC_GPIO0->FIODIR,1,4,1);
;;;2494   
;;;2495   if(rele_stat[0]==rsON) SET_REG(LPC_GPIO0->FIOPIN,0,4,1);
;;;2496   else SET_REG(LPC_GPIO0->FIOPIN,1,4,1);
;;;2497   #endif
;;;2498   
;;;2499   #ifdef EXT_BOARD_V_2
;;;2500   SET_REG(LPC_PINCON->PINSEL0,0,7*2,2);
001b9a  6808              LDR      r0,[r1,#0]
001b9c  f4204040          BIC      r0,r0,#0xc000
001ba0  6008              STR      r0,[r1,#0]
;;;2501   SET_REG(LPC_GPIO0->FIODIR,1,7,1);
001ba2  4812              LDR      r0,|L5.7148|
001ba4  6802              LDR      r2,[r0,#0]
001ba6  f0420280          ORR      r2,r2,#0x80
001baa  6002              STR      r2,[r0,#0]
;;;2502   
;;;2503   if(rele_stat[0]==rsON) SET_REG(LPC_GPIO0->FIOPIN,0,7,1);
001bac  4a10              LDR      r2,|L5.7152|
001bae  7813              LDRB     r3,[r2,#0]  ; rele_stat
001bb0  2b01              CMP      r3,#1
;;;2504   else SET_REG(LPC_GPIO0->FIOPIN,1,7,1);
001bb2  6943              LDR      r3,[r0,#0x14]
001bb4  d012              BEQ      |L5.7132|
001bb6  f0430380          ORR      r3,r3,#0x80
                  |L5.7098|
001bba  6143              STR      r3,[r0,#0x14]
;;;2505   #endif
;;;2506   
;;;2507   SET_REG(LPC_PINCON->PINSEL0,0,5*2,2);
001bbc  680b              LDR      r3,[r1,#0]
001bbe  f4236340          BIC      r3,r3,#0xc00
001bc2  600b              STR      r3,[r1,#0]
;;;2508   SET_REG(LPC_GPIO0->FIODIR,1,5,1);
001bc4  6801              LDR      r1,[r0,#0]
001bc6  f0410120          ORR      r1,r1,#0x20
001bca  6001              STR      r1,[r0,#0]
;;;2509   
;;;2510   if(rele_stat[1]==rsON) SET_REG(LPC_GPIO0->FIOPIN,0,5,1);
001bcc  7851              LDRB     r1,[r2,#1]  ; rele_stat
001bce  2901              CMP      r1,#1
;;;2511   else SET_REG(LPC_GPIO0->FIOPIN,1,5,1);
001bd0  6941              LDR      r1,[r0,#0x14]
001bd2  d006              BEQ      |L5.7138|
001bd4  f0410120          ORR      r1,r1,#0x20
                  |L5.7128|
001bd8  6141              STR      r1,[r0,#0x14]         ;2510
;;;2512   
;;;2513   
;;;2514   }
001bda  4770              BX       lr
                  |L5.7132|
001bdc  f0230380          BIC      r3,r3,#0x80           ;2503
001be0  e7eb              B        |L5.7098|
                  |L5.7138|
001be2  f0210120          BIC      r1,r1,#0x20           ;2510
001be6  e7f7              B        |L5.7128|
;;;2515   
                          ENDP

                  |L5.7144|
                          DCD      0x4002c000
                  |L5.7148|
                          DCD      0x2009c000
                  |L5.7152|
                          DCD      ||area_number.25||+0x2a

                          AREA ||area_number.6||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.text||
                  adc_drv6 PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000004  4c77              LDR      r4,|L6.484|
000006  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
000008  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
00000a  1a40              SUBS     r0,r0,r1
00000c  b200              SXTH     r0,r0
00000e  f7fffffe          BL       abs_pal
000012  1da5              ADDS     r5,r4,#6
;;;222    }
000014  8028              STRH     r0,[r5,#0]
000016  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000018  8861              LDRH     r1,[r4,#2]  ; adc_self_ch_buff
00001a  1a40              SUBS     r0,r0,r1
00001c  b200              SXTH     r0,r0
00001e  f7fffffe          BL       abs_pal
000022  8068              STRH     r0,[r5,#2]
000024  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000026  8821              LDRH     r1,[r4,#0]  ; adc_self_ch_buff
000028  1a40              SUBS     r0,r0,r1
00002a  b200              SXTH     r0,r0
00002c  f7fffffe          BL       abs_pal
000030  f44f7296          MOV      r2,#0x12c
000034  80a8              STRH     r0,[r5,#4]
000036  f1a4012c          SUB      r1,r4,#0x2c
00003a  4290              CMP      r0,r2
00003c  da01              BGE      |L6.66|
00003e  88a0              LDRH     r0,[r4,#4]  ; adc_self_ch_buff
000040  e00a              B        |L6.88|
                  |L6.66|
000042  f9b50002          LDRSH    r0,[r5,#2]  ; adc_self_ch_disp
000046  4290              CMP      r0,r2
000048  da01              BGE      |L6.78|
00004a  8860              LDRH     r0,[r4,#2]  ; adc_self_ch_buff
00004c  e004              B        |L6.88|
                  |L6.78|
00004e  f9b50000          LDRSH    r0,[r5,#0]  ; adc_self_ch_disp
000052  4290              CMP      r0,r2
000054  da01              BGE      |L6.90|
000056  8820              LDRH     r0,[r4,#0]  ; adc_self_ch_buff
                  |L6.88|
000058  82c8              STRH     r0,[r1,#0x16]
                  |L6.90|
00005a  784e              LDRB     r6,[r1,#1]  ; adc_ch_net
00005c  2000              MOVS     r0,#0
00005e  b3f6              CBZ      r6,|L6.222|
000060  790c              LDRB     r4,[r1,#4]  ; adc_window_flag
000062  4a61              LDR      r2,|L6.488|
000064  b18c              CBZ      r4,|L6.138|
000066  f9b13016          LDRSH    r3,[r1,#0x16]  ; adc_result
00006a  6815              LDR      r5,[r2,#0]  ; main_power_buffer
00006c  eb0505a3          ADD      r5,r5,r3,ASR #2
000070  6015              STR      r5,[r2,#0]  ; main_power_buffer
000072  6855              LDR      r5,[r2,#4]  ; main_power_buffer
000074  eb0505a3          ADD      r5,r5,r3,ASR #2
000078  6055              STR      r5,[r2,#4]  ; main_power_buffer
00007a  6895              LDR      r5,[r2,#8]  ; main_power_buffer
00007c  eb0505a3          ADD      r5,r5,r3,ASR #2
000080  6095              STR      r5,[r2,#8]  ; main_power_buffer
000082  68d5              LDR      r5,[r2,#0xc]  ; main_power_buffer
000084  eb0503a3          ADD      r3,r5,r3,ASR #2
000088  60d3              STR      r3,[r2,#0xc]  ; main_power_buffer
                  |L6.138|
00008a  f9b13016          LDRSH    r3,[r1,#0x16]  ; adc_result
00008e  2b64              CMP      r3,#0x64
000090  da0e              BGE      |L6.176|
000092  8b4b              LDRH     r3,[r1,#0x1a]  ; adc_zero_cnt
000094  f44f65fa          MOV      r5,#0x7d0
000098  1c5b              ADDS     r3,r3,#1
00009a  b21b              SXTH     r3,r3
00009c  834b              STRH     r3,[r1,#0x1a]
00009e  42ab              CMP      r3,r5
0000a0  db08              BLT      |L6.180|
0000a2  834d              STRH     r5,[r1,#0x1a]
0000a4  6010              STR      r0,[r2,#0]  ; main_power_buffer
0000a6  6050              STR      r0,[r2,#4]  ; main_power_buffer
0000a8  6090              STR      r0,[r2,#8]  ; main_power_buffer
0000aa  60d0              STR      r0,[r2,#0xc]  ; main_power_buffer
0000ac  8288              STRH     r0,[r1,#0x14]
0000ae  e053              B        |L6.344|
                  |L6.176|
0000b0  8348              STRH     r0,[r1,#0x1a]
0000b2  e051              B        |L6.344|
                  |L6.180|
0000b4  2b05              CMP      r3,#5
0000b6  d14f              BNE      |L6.344|
0000b8  b1a4              CBZ      r4,|L6.228|
0000ba  8b0b              LDRH     r3,[r1,#0x18]  ; adc_gorb_cnt
0000bc  1c5b              ADDS     r3,r3,#1
0000be  b21b              SXTH     r3,r3
0000c0  830b              STRH     r3,[r1,#0x18]
0000c2  f5b37f00          CMP      r3,#0x200
0000c6  db00              BLT      |L6.202|
0000c8  8308              STRH     r0,[r1,#0x18]
                  |L6.202|
0000ca  f9b13018          LDRSH    r3,[r1,#0x18]  ; adc_gorb_cnt
0000ce  065d              LSLS     r5,r3,#25
0000d0  d108              BNE      |L6.228|
0000d2  11db              ASRS     r3,r3,#7
0000d4  f8525023          LDR      r5,[r2,r3,LSL #2]
0000d8  122d              ASRS     r5,r5,#8
0000da  828d              STRH     r5,[r1,#0x14]
0000dc  e000              B        |L6.224|
                  |L6.222|
0000de  e00f              B        |L6.256|
                  |L6.224|
0000e0  f8420023          STR      r0,[r2,r3,LSL #2]
                  |L6.228|
0000e4  f9b1201c          LDRSH    r2,[r1,#0x1c]  ; adc_window_cnt
0000e8  2a96              CMP      r2,#0x96
0000ea  dd01              BLE      |L6.240|
0000ec  b104              CBZ      r4,|L6.240|
0000ee  7108              STRB     r0,[r1,#4]
                  |L6.240|
0000f0  3a1f              SUBS     r2,r2,#0x1f
0000f2  2a27              CMP      r2,#0x27
0000f4  d230              BCS      |L6.344|
0000f6  790a              LDRB     r2,[r1,#4]  ; adc_window_flag
0000f8  bb72              CBNZ     r2,|L6.344|
0000fa  2201              MOVS     r2,#1
0000fc  710a              STRB     r2,[r1,#4]
0000fe  e02b              B        |L6.344|
                  |L6.256|
000100  4f3a              LDR      r7,|L6.492|
000102  788a              LDRB     r2,[r1,#2]  ; adc_ch
000104  f891c003          LDRB     r12,[r1,#3]  ; adc_ch_cnt
000108  eb0714c2          ADD      r4,r7,r2,LSL #7
00010c  f9b13016          LDRSH    r3,[r1,#0x16]  ; adc_result
000110  f844302c          STR      r3,[r4,r12,LSL #2]
000114  ea5f738c          LSLS     r3,r12,#30
000118  d110              BNE      |L6.316|
00011a  2400              MOVS     r4,#0
00011c  4623              MOV      r3,r4
00011e  eb0715c2          ADD      r5,r7,r2,LSL #7
000122  bf00              NOP      
                  |L6.292|
000124  f8557023          LDR      r7,[r5,r3,LSL #2]
000128  1c5b              ADDS     r3,r3,#1
00012a  b2db              UXTB     r3,r3
00012c  443c              ADD      r4,r4,r7
00012e  2b10              CMP      r3,#0x10
000130  d3f8              BCC      |L6.292|
000132  1123              ASRS     r3,r4,#4
000134  4c2c              LDR      r4,|L6.488|
000136  3c40              SUBS     r4,r4,#0x40
000138  f8243012          STRH     r3,[r4,r2,LSL #1]
                  |L6.316|
00013c  1c52              ADDS     r2,r2,#1
00013e  b2d2              UXTB     r2,r2
000140  708a              STRB     r2,[r1,#2]
000142  2a10              CMP      r2,#0x10
000144  d308              BCC      |L6.344|
000146  f10c0c01          ADD      r12,r12,#1
00014a  f00c02ff          AND      r2,r12,#0xff
00014e  7088              STRB     r0,[r1,#2]
000150  70ca              STRB     r2,[r1,#3]
000152  2a10              CMP      r2,#0x10
000154  d300              BCC      |L6.344|
000156  70c8              STRB     r0,[r1,#3]
                  |L6.344|
000158  7008              STRB     r0,[r1,#0]
00015a  1c76              ADDS     r6,r6,#1
00015c  f0160001          ANDS     r0,r6,#1
000160  4a23              LDR      r2,|L6.496|
000162  7048              STRB     r0,[r1,#1]
000164  d005              BEQ      |L6.370|
000166  6810              LDR      r0,[r2,#0]
000168  f02000ff          BIC      r0,r0,#0xff
00016c  1d00              ADDS     r0,r0,#4
00016e  6010              STR      r0,[r2,#0]
000170  e032              B        |L6.472|
                  |L6.370|
000172  7889              LDRB     r1,[r1,#2]  ; adc_ch
000174  0708              LSLS     r0,r1,#28
000176  2800              CMP      r0,#0
000178  6810              LDR      r0,[r2,#0]
00017a  f02000ff          BIC      r0,r0,#0xff
00017e  db01              BLT      |L6.388|
000180  1c40              ADDS     r0,r0,#1
000182  e000              B        |L6.390|
                  |L6.388|
000184  1c80              ADDS     r0,r0,#2
                  |L6.390|
000186  6010              STR      r0,[r2,#0]
000188  481a              LDR      r0,|L6.500|
00018a  6803              LDR      r3,[r0,#0]
00018c  f0435380          ORR      r3,r3,#0x10000000
000190  6003              STR      r3,[r0,#0]
000192  6a03              LDR      r3,[r0,#0x20]
000194  f0434380          ORR      r3,r3,#0x40000000
000198  6203              STR      r3,[r0,#0x20]
00019a  6e03              LDR      r3,[r0,#0x60]
00019c  f0436380          ORR      r3,r3,#0x4000000
0001a0  6603              STR      r3,[r0,#0x60]
0001a2  07cb              LSLS     r3,r1,#31
0001a4  6943              LDR      r3,[r0,#0x14]
0001a6  d008              BEQ      |L6.442|
0001a8  f0435380          ORR      r3,r3,#0x10000000
                  |L6.428|
0001ac  6143              STR      r3,[r0,#0x14]
0001ae  078b              LSLS     r3,r1,#30
0001b0  6b43              LDR      r3,[r0,#0x34]
0001b2  d405              BMI      |L6.448|
0001b4  f0234380          BIC      r3,r3,#0x40000000
0001b8  e004              B        |L6.452|
                  |L6.442|
0001ba  f0235380          BIC      r3,r3,#0x10000000
0001be  e7f5              B        |L6.428|
                  |L6.448|
0001c0  f0434380          ORR      r3,r3,#0x40000000
                  |L6.452|
0001c4  6343              STR      r3,[r0,#0x34]
0001c6  0749              LSLS     r1,r1,#29
0001c8  6f41              LDR      r1,[r0,#0x74]
0001ca  d402              BMI      |L6.466|
0001cc  f0216180          BIC      r1,r1,#0x4000000
0001d0  e001              B        |L6.470|
                  |L6.466|
0001d2  f0416180          ORR      r1,r1,#0x4000000
                  |L6.470|
0001d6  6741              STR      r1,[r0,#0x74]
                  |L6.472|
0001d8  6810              LDR      r0,[r2,#0]
0001da  f0407080          ORR      r0,r0,#0x1000000
0001de  6010              STR      r0,[r2,#0]
0001e0  e8bd81f0          POP      {r4-r8,pc}
;;;223    
                          ENDP

                  |L6.484|
                          DCD      ||area_number.25||+0x2c
                  |L6.488|
                          DCD      ||.bss||+0x840
                  |L6.492|
                          DCD      ||.bss||
                  |L6.496|
                          DCD      0x40034000
                  |L6.500|
                          DCD      0x2009c000

                          AREA ||area_number.7||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.text||
                  zar_superviser_start PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  4903              LDR      r1,|L7.16|
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  4a04              LDR      r2,|L7.20|
000004  2001              MOVS     r0,#1
000006  7008              STRB     r0,[r1,#0]
000008  7010              STRB     r0,[r2,#0]
00000a  7048              STRB     r0,[r1,#1]
00000c  7050              STRB     r0,[r2,#1]
00000e  4770              BX       lr
;;;222    }
;;;223    
                          ENDP

                  |L7.16|
                          DCD      sign_U
                  |L7.20|
                          DCD      sign_I

                          AREA ||area_number.8||, CODE, READONLY, ALIGN=2

                          EXPORTAS ||area_number.8||, ||.text||
                  revers_hndl PROC
;;;218    //-----------------------------------------------
;;;219    void kb_init(void)
000000  480e              LDR      r0,|L8.60|
;;;220    {
;;;221    main_kb_cnt=(TBAT*60)-60/*120*/;
000002  6801              LDR      r1,[r0,#0]
000004  f4217140          BIC      r1,r1,#0x300
000008  6001              STR      r1,[r0,#0]
00000a  480d              LDR      r0,|L8.64|
00000c  6801              LDR      r1,[r0,#0]
00000e  f0410110          ORR      r1,r1,#0x10
000012  6001              STR      r1,[r0,#0]
;;;222    }
000014  490b              LDR      r1,|L8.68|
000016  7809              LDRB     r1,[r1,#0]  ; work_stat
000018  2903              CMP      r1,#3
00001a  d003              BEQ      |L8.36|
00001c  490a              LDR      r1,|L8.72|
00001e  7809              LDRB     r1,[r1,#0]  ; REV_STAT
000020  b119              CBZ      r1,|L8.42|
000022  e007              B        |L8.52|
                  |L8.36|
000024  4909              LDR      r1,|L8.76|
000026  7809              LDRB     r1,[r1,#0]  ; bRAZR
000028  b121              CBZ      r1,|L8.52|
                  |L8.42|
00002a  6941              LDR      r1,[r0,#0x14]
00002c  f0210110          BIC      r1,r1,#0x10
                  |L8.48|
000030  6141              STR      r1,[r0,#0x14]
000032  4770              BX       lr
                  |L8.52|
000034  6941              LDR      r1,[r0,#0x14]
000036  f0410110          ORR      r1,r1,#0x10
00003a  e7f9              B        |L8.48|
;;;223    
                          ENDP

                  |L8.60|
                          DCD      0x4002c000
                  |L8.64|
                          DCD      0x2009c000
                  |L8.68|
                          DCD      work_stat
                  |L8.72|
                          DCD      REV_STAT
                  |L8.76|
                          DCD      bRAZR

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  adc_buff
                          %        2048
                  adc_buff_
                          %        32
                  adc_buff__
                          %        32
                  main_power_buffer
                          %        32

                          AREA ||area_number.11||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.11||, ||.bss||
                  adc_buff_max
                          %        24

                          AREA ||area_number.12||, DATA, NOINIT, ALIGN=1

                          EXPORTAS ||area_number.12||, ||.bss||
                  net_buff
                          %        64

                          AREA ||.constdata||, DATA, READONLY, ALIGN=0

                  sk_buff_KONTUR
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.15||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.15||, ||.constdata||
                  sk_buff_RSTKM
000000  0d0b0f0e          DCB      0x0d,0x0b,0x0f,0x0e

                          AREA ||area_number.16||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.16||, ||.constdata||
                  sk_buff_GLONASS
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.17||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.17||, ||.constdata||
                  sk_buff_3U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.18||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.18||, ||.constdata||
                  sk_buff_6U
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||area_number.19||, DATA, READONLY, ALIGN=0

                          EXPORTAS ||area_number.19||, ||.constdata||
                  sk_buff_220
000000  0b0d0f0e          DCB      0x0b,0x0d,0x0f,0x0e

                          AREA ||.data||, DATA, ALIGN=1

                  adc_buff_min
000000  13881388          DCW      0x1388,0x1388
000004  13881388          DCW      0x1388,0x1388
000008  13881388          DCW      0x1388,0x1388
00000c  13881388          DCW      0x1388,0x1388
000010  13881388          DCW      0x1388,0x1388
                          DCDU     0x00000000

                          AREA ||area_number.21||, DATA, ALIGN=1

                          EXPORTAS ||area_number.21||, ||.data||
                  unet_buff_min
000000  1388              DCW      0x1388

                          AREA ||area_number.22||, DATA, ALIGN=0

                          EXPORTAS ||area_number.22||, ||.data||
                  adc_stat
000000  01                DCB      0x01

                          AREA ||area_number.23||, DATA, ALIGN=1

                          EXPORTAS ||area_number.23||, ||.data||
                  bat_ver_cnt
000000  0096              DCW      0x0096

                          AREA ||area_number.24||, DATA, ALIGN=0

                          EXPORTAS ||area_number.24||, ||.data||
                  vent_stat
000000  00                DCB      0x00

                          AREA ||area_number.25||, DATA, ALIGN=1

                          EXPORTAS ||area_number.25||, ||.data||
                  adc_self_ch_cnt
000000  00                DCB      0x00
                  adc_ch_net
000001  00                DCB      0x00
                  adc_ch
000002  00                DCB      0x00
                  adc_ch_cnt
000003  00                DCB      0x00
                  adc_window_flag
000004  00                DCB      0x00
                  sh_cnt0
000005  00                DCB      0x00
                  b1Hz_sh
000006  00                DCB      0x00
                  sh_cnt1
000007  00                DCB      0x00
                  bFAST_REG
000008  00                DCB      0x00
                  bU_VALID
000009  00                DCB      0x00
                  bU_VALID_VALID
00000a  00                DCB      0x00
                  bPRECESSION_REG
00000b  00                DCB      0x00
                  bVOLT_IS_NOT_DOWN
00000c  00                DCB      0x00
                  bVOLT_IS_NOT_UP
00000d  00                DCB      0x00
                  bVOLT_IS_NORM
00000e  0000              DCB      0x00,0x00
                  cntrl_stat_U
000010  03e8              DCW      0x03e8
                  cntrl_stat_I
000012  03e8              DCW      0x03e8
                  net_buff_
000014  0000              DCB      0x00,0x00
                  adc_result
000016  0000              DCB      0x00,0x00
                  adc_gorb_cnt
000018  0000              DCB      0x00,0x00
                  adc_zero_cnt
00001a  0000              DCB      0x00,0x00
                  adc_window_cnt
00001c  0000              DCB      0x00,0x00
                  adc_net_buff_cnt
00001e  0000              DCB      0x00,0x00
                  samokalibr_cnt
000020  0000              DCB      0x00,0x00
                  main_kb_cnt
000022  0000              DCB      0x00,0x00
                  cnt_volt_contr
000024  0000              DCB      0x00,0x00
                  cnt_rel_volt_umin
000026  0000              DCB      0x00,0x00
                  cnt_rel_volt_umax
000028  0000              DCB      0x00,0x00
                  rele_stat
00002a  0000              DCB      0x00,0x00
                  adc_self_ch_buff
                          DCDU     0x00000000
000030  0000              DCB      0x00,0x00
                  adc_self_ch_disp
000032  0000              DCB      0x00,0x00
                          DCDU     0x00000000

                          AREA ||area_number.26||, DATA, ALIGN=1

                          EXPORTAS ||area_number.26||, ||.data||
                  cntrl_stat_old
000000  0258              DCW      0x0258

                          AREA ||area_number.27||, DATA, ALIGN=1

                          EXPORTAS ||area_number.27||, ||.data||
                  unet_buff_max
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.28||, DATA, ALIGN=0

                          EXPORTAS ||area_number.28||, ||.data||
                  adc_cnt
000000  00                DCB      0x00

                          AREA ||area_number.29||, DATA, ALIGN=0

                          EXPORTAS ||area_number.29||, ||.data||
                  adc_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.30||, DATA, ALIGN=1

                          EXPORTAS ||area_number.30||, ||.data||
                  zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.31||, DATA, ALIGN=0

                          EXPORTAS ||area_number.31||, ||.data||
                  net_buff_cnt
000000  00                DCB      0x00

                          AREA ||area_number.32||, DATA, ALIGN=1

                          EXPORTAS ||area_number.32||, ||.data||
                  ADWR
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.33||, DATA, ALIGN=1

                          EXPORTAS ||area_number.33||, ||.data||
                  period_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.34||, DATA, ALIGN=1

                          EXPORTAS ||area_number.34||, ||.data||
                  non_zero_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.35||, DATA, ALIGN=0

                          EXPORTAS ||area_number.35||, ||.data||
                  bRELE_OUT
000000  00                DCB      0x00

                          AREA ||area_number.36||, DATA, ALIGN=2

                          EXPORTAS ||area_number.36||, ||.data||
                  main_power_buffer_
                          DCD      0x00000000

                          AREA ||area_number.37||, DATA, ALIGN=1

                          EXPORTAS ||area_number.37||, ||.data||
                  main_power_buffer_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.38||, DATA, ALIGN=1

                          EXPORTAS ||area_number.38||, ||.data||
                  adc_buff_out_
                          DCDU     0x00000000
000004  0000              DCB      0x00,0x00

                          AREA ||area_number.39||, DATA, ALIGN=1

                          EXPORTAS ||area_number.39||, ||.data||
                  plazma_adc_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.40||, DATA, ALIGN=1

                          EXPORTAS ||area_number.40||, ||.data||
                  plazma_sk
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.41||, DATA, ALIGN=1

                          EXPORTAS ||area_number.41||, ||.data||
                  cntrl_stat_new
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.42||, DATA, ALIGN=1

                          EXPORTAS ||area_number.42||, ||.data||
                  Ibmax
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.43||, DATA, ALIGN=0

                          EXPORTAS ||area_number.43||, ||.data||
                  unh_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.44||, DATA, ALIGN=0

                          EXPORTAS ||area_number.44||, ||.data||
                  unh_cnt1
000000  00                DCB      0x00

                          AREA ||area_number.45||, DATA, ALIGN=0

                          EXPORTAS ||area_number.45||, ||.data||
                  b1Hz_unh
000000  00                DCB      0x00

                          AREA ||area_number.46||, DATA, ALIGN=0

                          EXPORTAS ||area_number.46||, ||.data||
                  ch_cnt0
000000  00                DCB      0x00

                          AREA ||area_number.47||, DATA, ALIGN=0

                          EXPORTAS ||area_number.47||, ||.data||
                  b1Hz_ch
000000  00                DCB      0x00

                          AREA ||area_number.48||, DATA, ALIGN=0

                          EXPORTAS ||area_number.48||, ||.data||
                  i
000000  00                DCB      0x00

                          AREA ||area_number.49||, DATA, ALIGN=0

                          EXPORTAS ||area_number.49||, ||.data||
                  iiii
000000  00                DCB      0x00

                          AREA ||area_number.50||, DATA, ALIGN=1

                          EXPORTAS ||area_number.50||, ||.data||
                  IZMAX_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.51||, DATA, ALIGN=1

                          EXPORTAS ||area_number.51||, ||.data||
                  kb_cnt_1lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.52||, DATA, ALIGN=1

                          EXPORTAS ||area_number.52||, ||.data||
                  kb_cnt_2lev
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.53||, DATA, ALIGN=0

                          EXPORTAS ||area_number.53||, ||.data||
                  kb_full_ver
000000  00                DCB      0x00

                          AREA ||area_number.54||, DATA, ALIGN=0

                          EXPORTAS ||area_number.54||, ||.data||
                  kb_start
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.55||, DATA, ALIGN=0

                          EXPORTAS ||area_number.55||, ||.data||
                  num_of_wrks_bps
000000  00                DCB      0x00

                          AREA ||area_number.56||, DATA, ALIGN=0

                          EXPORTAS ||area_number.56||, ||.data||
                  bps_all_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.57||, DATA, ALIGN=0

                          EXPORTAS ||area_number.57||, ||.data||
                  bps_mask_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.58||, DATA, ALIGN=0

                          EXPORTAS ||area_number.58||, ||.data||
                  bps_mask_on_off_cnt
000000  00                DCB      0x00

                          AREA ||area_number.59||, DATA, ALIGN=0

                          EXPORTAS ||area_number.59||, ||.data||
                  bps_hndl_2sec_cnt
000000  00                DCB      0x00

                          AREA ||area_number.60||, DATA, ALIGN=1

                          EXPORTAS ||area_number.60||, ||.data||
                  bps_on_mask
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.61||, DATA, ALIGN=1

                          EXPORTAS ||area_number.61||, ||.data||
                  bps_off_mask
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.62||, DATA, ALIGN=0

                          EXPORTAS ||area_number.62||, ||.data||
                  num_necc_up
000000  00                DCB      0x00

                          AREA ||area_number.63||, DATA, ALIGN=0

                          EXPORTAS ||area_number.63||, ||.data||
                  num_necc_down
000000  00                DCB      0x00

                          AREA ||area_number.64||, DATA, ALIGN=0

                          EXPORTAS ||area_number.64||, ||.data||
                  spc_stat
000000  00                DCB      0x00

                          AREA ||area_number.65||, DATA, ALIGN=0

                          EXPORTAS ||area_number.65||, ||.data||
                  spc_bat
000000  00                DCB      0x00

                          AREA ||area_number.66||, DATA, ALIGN=0

                          EXPORTAS ||area_number.66||, ||.data||
                  spc_phase
000000  00                DCB      0x00

                          AREA ||area_number.67||, DATA, ALIGN=1

                          EXPORTAS ||area_number.67||, ||.data||
                  vz_cnt_s
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.68||, DATA, ALIGN=1

                          EXPORTAS ||area_number.68||, ||.data||
                  vz_cnt_s_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.69||, DATA, ALIGN=1

                          EXPORTAS ||area_number.69||, ||.data||
                  vz_cnt_h
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.70||, DATA, ALIGN=1

                          EXPORTAS ||area_number.70||, ||.data||
                  vz_cnt_h_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.71||, DATA, ALIGN=0

                          EXPORTAS ||area_number.71||, ||.data||
                  bAVZ
000000  00                DCB      0x00

                          AREA ||area_number.72||, DATA, ALIGN=0

                          EXPORTAS ||area_number.72||, ||.data||
                  ke_start_stat
000000  00                DCB      0x00

                          AREA ||area_number.73||, DATA, ALIGN=1

                          EXPORTAS ||area_number.73||, ||.data||
                  cnt_end_ke
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.74||, DATA, ALIGN=2

                          EXPORTAS ||area_number.74||, ||.data||
                  ke_date
                          %        8

                          AREA ||area_number.75||, DATA, ALIGN=1

                          EXPORTAS ||area_number.75||, ||.data||
                  __ee_vz_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.76||, DATA, ALIGN=1

                          EXPORTAS ||area_number.76||, ||.data||
                  __ee_spc_stat
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.77||, DATA, ALIGN=1

                          EXPORTAS ||area_number.77||, ||.data||
                  __ee_spc_bat
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.78||, DATA, ALIGN=1

                          EXPORTAS ||area_number.78||, ||.data||
                  __ee_spc_phase
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.79||, DATA, ALIGN=1

                          EXPORTAS ||area_number.79||, ||.data||
                  cntrl_stat_blok_cnt
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.80||, DATA, ALIGN=1

                          EXPORTAS ||area_number.80||, ||.data||
                  cntrl_stat_blok_cnt_
000000  0000              DCB      0x00,0x00

                          AREA ||area_number.81||, DATA, ALIGN=1

                          EXPORTAS ||area_number.81||, ||.data||
                  cntrl_stat_blok_cnt_plus
                          DCDU     0x00000000

                          AREA ||area_number.82||, DATA, ALIGN=1

                          EXPORTAS ||area_number.82||, ||.data||
                  cntrl_stat_blok_cnt_minus
                          DCDU     0x00000000

                          AREA ||area_number.83||, DATA, ALIGN=0

                          EXPORTAS ||area_number.83||, ||.data||
                  plazma_inv
                          DCDU     0x00000000

                          AREA ||area_number.84||, DATA, ALIGN=0

                          EXPORTAS ||area_number.84||, ||.data||
                  plazma_bat
000000  00                DCB      0x00
